
R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> 
> 
> 
> # --------------------------------------
> # 5-aim1-enteroQPCR-470cce-regs-body.R
> # ben arnold (benarnold@berkeley.edu)
> #
> # description:
> # estimate the association between water
> # quality indicator concentrations and
> # the risk of Diarrhea among swimmers
> # for the 13 beaches study
> #
> # Analyses are conducted for EPA QPCR 1611
> # Among Swimmers with Body Immmersion
> #
> # The exposure categories are <=470 and >470 CCE/100ml
> #
> # version 4 (12 aug 2015)
> # cleaned up code by cutting extra lines
> #
> # version 3 (29 jul 2015)
> # added RERI calculations / output.
> #
> # version 2 (10 apr 2015)
> # confirm 10-day follow-up
> #
> # version 1 (5 apr 2015)
> #
> # --------------------------------------
> 
> # --------------------------------------
> # preamble
> # --------------------------------------
> 
> rm(list=ls())
> library(sandwich)
> library(lmtest)
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

> 
> # source the base functions
> source("~/dropbox/13beaches/src/aim1/0-aim1-base-functions.R")
> 
> # --------------------------------------
> # load the and pre-preprocess the 
> # analysis dataset
> # (refer to the base functions script
> # for details on the pre-processing)
> # --------------------------------------
> 
> ad <- preprocess.13beaches("~/dropbox/13beaches/data/final/13beaches-analysis.csv")

Successfully loaded the data
 Total sample size = 88083 

Dropping individuals with GI illness at enrollment
 N = 2025 

Final sample size = 86058 

Subsetting the data to relevant variables and completing final variable pre-processing> 
> # drop individuals with no water quality information
> table(ad$nowq)

    0     1 
84737  1321 
> ad <- subset(ad,nowq==0)
> dim(ad)
[1] 84737    50
> 
> # subset to non-missing exposure categories
> # to make the robust CI calcs work
> table(ad$bodycontact)

   No   Yes 
37496 47241 
> ad <- subset(ad,ad$bodycontact=="Yes")
> 	dim(ad)
[1] 47241    50
> ad <- subset(ad,is.na(ad$entero470)==FALSE)
> 	dim(ad)
[1] 45999    50
> 
> 
> # --------------------------------------
> # Calculate the actual Ns for each cell
> # and store them for plotting and tables
> # --------------------------------------
> 
> # --------------------------------------
> # Summarize 
> # the number of swimmers and number
> # of cumulative incident episodes by
> # Entero 1600 category
> # --------------------------------------
> calcNs <- function(outcome,exposurecat) {
+   n <- tapply(outcome,exposurecat,sum)
+   N <- tapply(outcome,exposurecat,function(x) length(x))
+   cbind(n,N)
+ }
> 
> # overall
> N.all <- calcNs(ad$diarrheaci10,ad$entero470)
> # age stratified
> N.age0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]"],ad$entero470[ad$agestrat=="(0, 4]"] )
> N.age5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]"],ad$entero470[ad$agestrat=="(4, 10]"] )
> N.age11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10"],ad$entero470[ad$agestrat==">10"] )
> # point source vs. non-point source stratified
> N.nps <- calcNs(ad$diarrheaci10[ad$pointsource=="No"], ad$entero470[ad$pointsource=="No"])
> N.ps  <- calcNs(ad$diarrheaci10[ad$pointsource=="Yes"],ad$entero470[ad$pointsource=="Yes"])
> # age and point source stratified
> N.nps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="No"],ad$entero470[ad$agestrat=="(0, 4]" & ad$pointsource=="No"] )
> N.nps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="No"],ad$entero470[ad$agestrat=="(4, 10]" & ad$pointsource=="No"] )
> N.nps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="No"],ad$entero470[ad$agestrat==">10" & ad$pointsource=="No"] )
> 
> N.ps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"],ad$entero470[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"] )
> N.ps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"],ad$entero470[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"] )
> N.ps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="Yes"],ad$entero470[ad$agestrat==">10" & ad$pointsource=="Yes"] )
> 
> 
> 
> # --------------------------------------
> # Calculate unadjusted 
> # Cumulative Incidence Rates
> # and robust 95% CIs using a saturated, 
> # unadjusted model
> # (just using the models to get the robust
> # SEs that account for HH clustering)
> # --------------------------------------
> 
> 
> #### Overall Estimates (pooled over beach type)
> 
> # All Ages
> all.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad)
> 	allci.VC <- cl(ad,fm=all.cifit,cluster=ad$hhid)
> 	allci <- coeftest(all.cifit, allci.VC)
> 	allci

z test of coefficients:

             Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.160243   0.026369 -119.8476 < 2.2e-16 ***
entero470    0.563380   0.117250    4.8049 1.548e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 0 - 4
> age0to4.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$agestrat=="(0, 4]",])
> 	age0to4ci.VC <- cl(ad[ad$agestrat=="(0, 4]",],fm=age0to4.cifit,cluster=ad$hhid[ad$agestrat=="(0, 4]"])
> 	age0to4ci <- coeftest(age0to4.cifit, age0to4ci.VC)
> 	age0to4ci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -2.705608   0.066053 -40.9614   <2e-16 ***
entero470    0.196009   0.330624   0.5928   0.5533    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 5 - 10
> age5to10.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$agestrat=="(4, 10]",])
> 	age5to10ci.VC <- cl(ad[ad$agestrat=="(4, 10]",],fm=age5to10.cifit,cluster=ad$hhid[ad$agestrat=="(4, 10]"])
> 	age5to10ci <- coeftest(age5to10.cifit, age5to10ci.VC)
> 	age5to10ci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.297176   0.062212 -52.9994  < 2e-16 ***
entero470    0.610403   0.237078   2.5747  0.01003 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages >10
> age11plus.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$agestrat==">10",])
> 	age11plusci.VC <- cl(ad[ad$agestrat==">10",],fm=age11plus.cifit,cluster=ad$hhid[ad$agestrat==">10"])
> 	age11plusci <- coeftest(age11plus.cifit, age11plusci.VC)
> 	age11plusci

z test of coefficients:

            Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.18790    0.02933 -108.6892 < 2.2e-16 ***
entero470    0.57188    0.13193    4.3347  1.46e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> #### Stratified Estimates by non-point source and point source beach conditions
> 
> # Non-point source - All Ages
> nps.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="No",])
> 	npsci.VC <- cl(ad[ad$pointsource=="No",],fm=nps.cifit,cluster=ad$hhid[ad$pointsource=="No"])
> 	npsci <- coeftest(nps.cifit, npsci.VC)
> 	npsci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.185873   0.043751 -72.8175   <2e-16 ***
entero470    0.267021   0.253636   1.0528   0.2924    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 0 - 4
> nps0to4.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",])
> 	nps0to4ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],fm=nps0to4.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(0, 4]"])
> 	nps0to4ci <- coeftest(nps0to4.cifit, nps0to4ci.VC)
> 	nps0to4ci

z test of coefficients:

            Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -2.82125    0.11137 -25.3326   <2e-16 ***
entero470   -0.89233    0.99946  -0.8928    0.372    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 5 - 10
> nps5to10.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",])
> 	nps5to10ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],fm=nps5to10.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(4, 10]"])
> 	nps5to10ci <- coeftest(nps5to10.cifit, nps5to10ci.VC)
> 	nps5to10ci

z test of coefficients:

             Estimate Std. Error z value  Pr(>|z|)    
(Intercept)  -3.36814    0.10139 -33.218 < 2.2e-16 ***
entero470   -13.93444    0.17982 -77.490 < 2.2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages >10
> nps11plus.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat==">10",])
> 	nps11plusci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat==">10",],fm=nps11plus.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat==">10"])
> 	nps11plusci <- coeftest(nps11plus.cifit, nps11plusci.VC)
> 	nps11plusci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.183639   0.047866 -66.5116   <2e-16 ***
entero470    0.356325   0.249782   1.4265   0.1537    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # Point source	- All Ages
> ps.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="Yes",])
> 	psci.VC <- cl(ad[ad$pointsource=="Yes",],fm=ps.cifit,cluster=ad$hhid[ad$pointsource=="Yes"])
> 	psci <- coeftest(ps.cifit, psci.VC)
> 	psci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.144682   0.033034 -95.1945 < 2.2e-16 ***
entero470    0.679448   0.131942   5.1496 2.611e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 0 - 4
> ps0to4.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",])
> 	ps0to4ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],fm=ps0to4.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]"])
> 	ps0to4ci <- coeftest(ps0to4.cifit, ps0to4ci.VC)
> 	ps0to4ci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -2.633583   0.081983 -32.1234   <2e-16 ***
entero470    0.424088   0.343571   1.2344   0.2171    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 5 - 10
> ps5to10.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",])
> 	ps5to10ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],fm=ps5to10.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]"])
> 	ps5to10ci <- coeftest(ps5to10.cifit, ps5to10ci.VC)
> 	ps5to10ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.246619   0.078612 -41.2995 < 2.2e-16 ***
entero470    0.848724   0.238131   3.5641 0.0003651 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages >10
> ps11plus.cifit <- glm(diarrheaci10~entero470,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat==">10",])
> 	ps11plusci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat==">10",],fm=ps11plus.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat==">10"])
> 	ps11plusci <- coeftest(ps11plus.cifit, ps11plusci.VC)
> 	ps11plusci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.190412   0.037114 -85.9614 < 2.2e-16 ***
entero470    0.675352   0.155642   4.3391  1.43e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # function to get Estimates and CIs from a linear combination of regression coefficients
> lccalc <- function(lc,x,vcv) {
+ 	# lc : linear combination of coefficients
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# vcv : variance-covariance matrix of coefficients for robust SEs
+ 	est <- exp(t(lc)%*%x[,1])
+ 	se  <- sqrt( t(lc)%*%vcv%*%lc )
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> getCI <- function(fit,vcv) {
+ 	# fit : an object returned from coeftest w/ 2 parameters corresponding to <=470/>470 CCE cumulative incidence
+ 	# vcv : variance-covariance matrix for coefficients in the fit object
+ 	lc1 <- lc2 <- rep(0,nrow(fit))
+ 	lc1[c(1)  ] <- 1
+ 	lc2[c(1,2)] <- 1
+ 	lcs <- list(lc1,lc2)
+ 	res <- t(sapply(lcs,lccalc,x=fit,vcv=vcv))
+ 	colnames(res) <- c("CI","CIlb","CIub")
+ 	rownames(res) <- c("Entero<=470cce","Entero>470cce")
+ 	return(res)
+ }
> 
> 
> ci.all    <- getCI(allci,allci.VC)
> ci.0to4   <- getCI(age0to4ci,age0to4ci.VC)
> ci.5to10  <- getCI(age5to10ci,age5to10ci.VC)
> ci.11plus <- getCI(age11plusci,age11plusci.VC)
> 
> ci.nps       <- getCI(npsci,npsci.VC)
> ci.nps0to4   <- getCI(nps0to4ci,nps0to4ci.VC)
> ci.nps5to10  <- getCI(nps5to10ci,nps5to10ci.VC)
> ci.nps11plus <- getCI(nps11plusci,nps11plusci.VC)
> 
> ci.ps       <- getCI(psci,psci.VC)
> ci.ps0to4   <- getCI(ps0to4ci,ps0to4ci.VC)
> ci.ps5to10  <- getCI(ps5to10ci,ps5to10ci.VC)
> ci.ps11plus <- getCI(ps11plusci,nps11plusci.VC)
> 
> 
> 
> # --------------------------------------
> # esimate risk of Diarrhea associated
> # with exposure to EPA 1600 above/below 470 CCE/100ml
> # Body Immersion
> # All ages
> # --------------------------------------
> 
> 
> 
> # tests of interaction by environmental conditions for Avalon and Doheny
> av.h.noint <-glm(diarrheaci10~ entero470+groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> av.h <-glm(diarrheaci10~ entero470*groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> 	lrtest(av.h.noint,av.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero470 + groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero470 * groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df Chisq Pr(>Chisq)
1  20 -776.56                    
2  21 -775.72  1 1.673     0.1959
> 
> dh.h.noint <-glm(diarrheaci10~ entero470+berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> dh.h <-glm(diarrheaci10~ entero470*berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> 	lrtest(dh.h.noint,dh.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero470 + berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero470 * berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  19 -545.04                     
2  20 -545.03  1 0.0232     0.8789
> 
> 
> # --------------------------------------
> # Freshwater beaches
> 
> # Huntington
> hufit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Huntington",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8116  -0.4836  -0.4443  -0.3211   2.2497  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.95209    0.60027  -4.918 8.75e-07 ***
entero470           0.43514    0.40955   1.062   0.2880    
agecat5-14         -0.01328    0.38358  -0.035   0.9724    
agecat15-24        -1.12609    0.66774  -1.686   0.0917 .  
agecat25-34        -0.15895    0.47270  -0.336   0.7367    
agecat35-44         0.38774    0.42055   0.922   0.3565    
agecat45-54        -0.26189    0.56081  -0.467   0.6405    
agecat55-64        -0.70233    1.05598  -0.665   0.5060    
agecat65-74       -15.32288 1303.56858  -0.012   0.9906    
agecat75+         -15.16960 3467.85856  -0.004   0.9965    
agecatMissing       0.95303    0.78366   1.216   0.2239    
female              0.16958    0.23392   0.725   0.4685    
racewhiteYes        0.40827    0.47129   0.866   0.3863    
racewhiteMissing  -14.43279 3467.85859  -0.004   0.9967    
gichronYes        -15.14882  930.38386  -0.016   0.9870    
anim_anyYes         0.24124    0.34671   0.696   0.4865    
gicontactbaseYes    0.12643    0.72008   0.176   0.8606    
rawfood             0.36898    0.36493   1.011   0.3120    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 340.98  on 740  degrees of freedom
Residual deviance: 321.75  on 723  degrees of freedom
AIC: 505.75

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.952087   0.640747  -4.6073  4.08e-06 ***
entero470          0.435144   0.398182   1.0928   0.27447    
agecat5-14        -0.013284   0.371323  -0.0358   0.97146    
agecat15-24       -1.126092   0.670223  -1.6802   0.09292 .  
agecat25-34       -0.158954   0.491929  -0.3231   0.74660    
agecat35-44        0.387736   0.410186   0.9453   0.34452    
agecat45-54       -0.261886   0.573064  -0.4570   0.64768    
agecat55-64       -0.702333   1.055713  -0.6653   0.50588    
agecat65-74      -15.322879   0.615740 -24.8853 < 2.2e-16 ***
agecat75+        -15.169599   1.073242 -14.1344 < 2.2e-16 ***
agecatMissing      0.953029   0.825141   1.1550   0.24809    
female             0.169582   0.216935   0.7817   0.43438    
racewhiteYes       0.408274   0.568027   0.7188   0.47229    
racewhiteMissing -14.432789   1.231288 -11.7217 < 2.2e-16 ***
gichronYes       -15.148824   0.521221 -29.0641 < 2.2e-16 ***
anim_anyYes        0.241245   0.448832   0.5375   0.59093    
gicontactbaseYes   0.126430   0.668271   0.1892   0.84994    
rawfood            0.368977   0.453069   0.8144   0.41542    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Silver
> sifit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Silver",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7099  -0.3179  -0.2857  -0.2541   2.4775  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.26248    0.28102 -11.609  < 2e-16 ***
entero470                    NA         NA      NA       NA    
agecat5-14             -0.57440    0.21547  -2.666  0.00768 ** 
agecat15-24            -0.71255    0.24568  -2.900  0.00373 ** 
agecat25-34            -0.35448    0.25930  -1.367  0.17161    
agecat35-44            -0.05091    0.22497  -0.226  0.82096    
agecat45-54            -0.36072    0.28604  -1.261  0.20729    
agecat55-64            -0.38719    0.41895  -0.924  0.35538    
agecat65-74           -14.46130  542.40811  -0.027  0.97873    
agecat75+             -14.81792 1964.05630  -0.008  0.99398    
agecatMissing          -0.78905    0.44501  -1.773  0.07621 .  
female                  0.16611    0.12989   1.279  0.20095    
racewhiteYes            0.09633    0.20875   0.461  0.64446    
racewhiteMissing        0.26330    1.02337   0.257  0.79696    
gichronYes              0.57269    0.32888   1.741  0.08163 .  
gichronMissing        -14.12054 1083.18998  -0.013  0.98960    
anim_anyYes             0.37579    0.18418   2.040  0.04132 *  
gicontactbaseYes        0.18966    0.26844   0.707  0.47985    
gicontactbaseMissing    1.03391    1.01127   1.022  0.30660    
rawfood                 0.14178    0.17250   0.822  0.41112    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1520.8  on 5553  degrees of freedom
Residual deviance: 1487.0  on 5535  degrees of freedom
AIC: 2011

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.262481   0.302364 -10.7899 < 2.2e-16 ***
agecat5-14            -0.574403   0.222124  -2.5860  0.009711 ** 
agecat15-24           -0.712552   0.250591  -2.8435  0.004462 ** 
agecat25-34           -0.354478   0.273659  -1.2953  0.195207    
agecat35-44           -0.050912   0.227550  -0.2237  0.822959    
agecat45-54           -0.360719   0.287057  -1.2566  0.208896    
agecat55-64           -0.387191   0.418983  -0.9241  0.355424    
agecat65-74          -14.461299   0.270446 -53.4721 < 2.2e-16 ***
agecat75+            -14.817918   0.688571 -21.5198 < 2.2e-16 ***
agecatMissing         -0.789047   0.559954  -1.4091  0.158797    
female                 0.166105   0.129946   1.2783  0.201157    
racewhiteYes           0.096333   0.247048   0.3899  0.696583    
racewhiteMissing       0.263304   0.843485   0.3122  0.754918    
gichronYes             0.572688   0.325087   1.7616  0.078129 .  
gichronMissing       -14.120540   0.571005 -24.7293 < 2.2e-16 ***
anim_anyYes            0.375788   0.211407   1.7776  0.075477 .  
gicontactbaseYes       0.189663   0.266671   0.7112  0.476945    
gicontactbaseMissing   1.033907   0.718912   1.4382  0.150390    
rawfood                0.141777   0.175357   0.8085  0.418801    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Washington Park
> wpfit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Washington Park",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8329  -0.3604  -0.3087  -0.2506   2.5619  

Coefficients: (1 not defined because of singularities)
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.0480     0.3617  -8.428  < 2e-16 ***
entero470                   NA         NA      NA       NA    
agecat5-14             -0.5225     0.3110  -1.680  0.09289 .  
agecat15-24            -1.2958     0.4848  -2.673  0.00752 ** 
agecat25-34             0.2174     0.3289   0.661  0.50854    
agecat35-44            -0.2224     0.3401  -0.654  0.51327    
agecat45-54            -0.3090     0.3899  -0.792  0.42811    
agecat55-64             0.5460     0.4020   1.358  0.17440    
agecat65-74            -0.2808     1.0350  -0.271  0.78614    
agecat75+             -14.4739  1413.1035  -0.010  0.99183    
agecatMissing          -1.7555     1.0337  -1.698  0.08947 .  
female                  0.1100     0.1804   0.609  0.54226    
racewhiteYes            0.1128     0.2484   0.454  0.64977    
racewhiteMissing      -11.8405  1349.4964  -0.009  0.99300    
gichronYes              0.5046     0.4624   1.091  0.27518    
gichronMissing        -13.0715  3467.8586  -0.004  0.99699    
anim_anyYes             0.3132     0.2575   1.216  0.22391    
gicontactbaseYes        0.7312     0.2899   2.522  0.01165 *  
gicontactbaseMissing  -13.7197  1059.2606  -0.013  0.98967    
rawfood                -0.2159     0.2817  -0.766  0.44349    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 733.22  on 2311  degrees of freedom
Residual deviance: 693.05  on 2293  degrees of freedom
AIC: 983.05

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -3.04798    0.36339  -8.3877  < 2e-16 ***
agecat5-14            -0.52252    0.30632  -1.7058  0.08805 .  
agecat15-24           -1.29585    0.47400  -2.7338  0.00626 ** 
agecat25-34            0.21743    0.30670   0.7089  0.47837    
agecat35-44           -0.22237    0.33285  -0.6681  0.50408    
agecat45-54           -0.30900    0.37256  -0.8294  0.40687    
agecat55-64            0.54599    0.37089   1.4721  0.14100    
agecat65-74           -0.28081    1.02111  -0.2750  0.78332    
agecat75+            -14.47390    0.58062 -24.9285  < 2e-16 ***
agecatMissing         -1.75548    1.00052  -1.7546  0.07933 .  
female                 0.10996    0.16622   0.6615  0.50826    
racewhiteYes           0.11279    0.26170   0.4310  0.66648    
racewhiteMissing     -11.84045    0.89466 -13.2346  < 2e-16 ***
gichronYes             0.50457    0.51496   0.9798  0.32717    
gichronMissing       -13.07155    1.10433 -11.8366  < 2e-16 ***
anim_anyYes            0.31318    0.26590   1.1778  0.23887    
gicontactbaseYes       0.73116    0.29991   2.4380  0.01477 *  
gicontactbaseMissing -13.71965    0.72132 -19.0201  < 2e-16 ***
rawfood               -0.21589    0.27010  -0.7993  0.42411    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # West
> wefit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="West",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9906  -0.4239  -0.3358  -0.2621   2.4549  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.29599    0.38848  -8.484  < 2e-16 ***
entero470               0.28859    0.21259   1.358  0.17461    
agecat5-14             -0.62738    0.33248  -1.887  0.05916 .  
agecat15-24            -0.80481    0.33168  -2.426  0.01525 *  
agecat25-34            -0.06914    0.33034  -0.209  0.83421    
agecat35-44            -0.21089    0.34731  -0.607  0.54371    
agecat45-54            -1.39505    0.53417  -2.612  0.00901 ** 
agecat55-64           -14.94670  597.42883  -0.025  0.98004    
agecat65-74            -0.02975    1.04155  -0.029  0.97721    
agecat75+             -15.32313 2446.95696  -0.006  0.99500    
agecatMissing         -14.59664 1651.30751  -0.009  0.99295    
female                  0.10584    0.18249   0.580  0.56192    
racewhiteYes            0.33329    0.24373   1.367  0.17148    
racewhiteMissing        0.69241    0.74789   0.926  0.35454    
gichronYes              1.07366    0.47077   2.281  0.02257 *  
gichronMissing        -15.26898 3467.85855  -0.004  0.99649    
anim_anyYes             0.78610    0.26171   3.004  0.00267 ** 
gicontactbaseYes        1.35873    0.33947   4.002 6.27e-05 ***
gicontactbaseMissing    1.50135    0.59975   2.503  0.01230 *  
rawfood                 0.66453    0.23861   2.785  0.00535 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 645.05  on 1649  degrees of freedom
Residual deviance: 583.73  on 1630  degrees of freedom
AIC: 873.73

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.295993   0.404775  -8.1428 3.863e-16 ***
entero470              0.288595   0.247525   1.1659 0.2436464    
agecat5-14            -0.627381   0.340458  -1.8428 0.0653650 .  
agecat15-24           -0.804807   0.334662  -2.4048 0.0161798 *  
agecat25-34           -0.069141   0.316501  -0.2185 0.8270749    
agecat35-44           -0.210894   0.331682  -0.6358 0.5248862    
agecat45-54           -1.395055   0.519881  -2.6834 0.0072875 ** 
agecat55-64          -14.946704   0.393392 -37.9944 < 2.2e-16 ***
agecat65-74           -0.029750   0.876679  -0.0339 0.9729288    
agecat75+            -15.323131   0.775940 -19.7478 < 2.2e-16 ***
agecatMissing        -14.596637   0.644082 -22.6627 < 2.2e-16 ***
female                 0.105842   0.166320   0.6364 0.5245297    
racewhiteYes           0.333288   0.245700   1.3565 0.1749460    
racewhiteMissing       0.692412   0.818468   0.8460 0.3975610    
gichronYes             1.073665   0.340716   3.1512 0.0016260 ** 
gichronMissing       -15.268975   1.073695 -14.2210 < 2.2e-16 ***
anim_anyYes            0.786102   0.265940   2.9559 0.0031172 ** 
gicontactbaseYes       1.358734   0.346721   3.9188 8.899e-05 ***
gicontactbaseMissing   1.501347   0.409239   3.6686 0.0002438 ***
rawfood                0.664533   0.266316   2.4953 0.0125858 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # --------------------------------------
> # Marine beaches
> 
> # Avalon
> avfit <- mpreg(diarrheaci10~entero470 +groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Avalon",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9992  -0.3528  -0.2908  -0.2561   2.3231  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   -2.17662    0.25155  -8.653  < 2e-16 ***
entero470                      0.50275    0.26669   1.885  0.05941 .  
groundwaterAbove median flow  -0.25413    0.14367  -1.769  0.07693 .  
agecat5-14                    -1.08463    0.23611  -4.594 4.35e-06 ***
agecat15-24                   -1.21481    0.30473  -3.986 6.71e-05 ***
agecat25-34                   -0.77983    0.28449  -2.741  0.00612 ** 
agecat35-44                   -0.43591    0.24498  -1.779  0.07518 .  
agecat45-54                   -0.79220    0.27219  -2.911  0.00361 ** 
agecat55-64                   -1.22905    0.38938  -3.156  0.00160 ** 
agecat65-74                   -1.06659    0.73513  -1.451  0.14681    
agecat75+                    -14.12374  573.73606  -0.025  0.98036    
agecatMissing                -14.07452  764.97587  -0.018  0.98532    
female                        -0.06217    0.14008  -0.444  0.65717    
racewhiteYes                   0.03466    0.16694   0.208  0.83554    
racewhiteMissing              -0.72340    0.72344  -1.000  0.31733    
gichronYes                     0.81243    0.33106   2.454  0.01413 *  
anim_anyYes                    0.12570    0.16107   0.780  0.43514    
gicontactbaseYes               0.62108    0.22283   2.787  0.00532 ** 
gicontactbaseMissing          -0.33169    1.00509  -0.330  0.74139    
rawfood                        0.32400    0.16606   1.951  0.05104 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1194.7  on 3742  degrees of freedom
Residual deviance: 1141.1  on 3723  degrees of freedom
AIC: 1593.1

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                               Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)                   -2.176617   0.267287  -8.1434 3.845e-16 ***
entero470                      0.502748   0.295771   1.6998  0.089171 .  
groundwaterAbove median flow  -0.254127   0.156237  -1.6266  0.103833    
agecat5-14                    -1.084626   0.238209  -4.5533 5.282e-06 ***
agecat15-24                   -1.214808   0.303493  -4.0028 6.261e-05 ***
agecat25-34                   -0.779832   0.268969  -2.8993  0.003740 ** 
agecat35-44                   -0.435905   0.242280  -1.7992  0.071990 .  
agecat45-54                   -0.792203   0.276484  -2.8653  0.004166 ** 
agecat55-64                   -1.229047   0.375060  -3.2769  0.001049 ** 
agecat65-74                   -1.066590   0.719398  -1.4826  0.138177    
agecat75+                    -14.123742   0.348558 -40.5205 < 2.2e-16 ***
agecatMissing                -14.074523   0.467208 -30.1247 < 2.2e-16 ***
female                        -0.062171   0.133658  -0.4652  0.641822    
racewhiteYes                   0.034658   0.185228   0.1871  0.851574    
racewhiteMissing              -0.723401   0.677246  -1.0682  0.285452    
gichronYes                     0.812429   0.324104   2.5067  0.012187 *  
anim_anyYes                    0.125703   0.177534   0.7080  0.478915    
gicontactbaseYes               0.621079   0.238305   2.6062  0.009154 ** 
gicontactbaseMissing          -0.331694   0.996961  -0.3327  0.739357    
rawfood                        0.324001   0.165008   1.9635  0.049583 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Boqueron
> bofit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Boqueron",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1644  -0.2482  -0.2235  -0.2059   2.5027  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.16344    0.17692 -17.880  < 2e-16 ***
entero470                    NA         NA      NA       NA    
agecat5-14             -0.95211    0.21102  -4.512 6.43e-06 ***
agecat15-24            -0.66627    0.20006  -3.330 0.000868 ***
agecat25-34            -0.52678    0.19673  -2.678 0.007414 ** 
agecat35-44            -0.77023    0.21237  -3.627 0.000287 ***
agecat45-54            -0.75823    0.23181  -3.271 0.001072 ** 
agecat55-64            -0.61457    0.28480  -2.158 0.030938 *  
agecat65-74            -0.95120    0.47525  -2.001 0.045343 *  
agecat75+             -13.37797  321.23614  -0.042 0.966781    
agecatMissing          -0.72156    0.52458  -1.375 0.168978    
female                  0.06756    0.10792   0.626 0.531275    
racewhiteYes            0.82688    0.58167   1.422 0.155151    
racewhiteMissing        2.33860    0.71994   3.248 0.001161 ** 
gichronYes              0.53441    0.20330   2.629 0.008574 ** 
gichronMissing        -12.44848 2103.36254  -0.006 0.995278    
anim_anyYes             0.21016    0.10955   1.918 0.055064 .  
gicontactbaseYes        0.94758    0.17537   5.403 6.54e-08 ***
gicontactbaseMissing  -12.66941 1204.77312  -0.011 0.991610    
rawfood                 0.31851    0.13914   2.289 0.022072 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2487.4  on 11878  degrees of freedom
Residual deviance: 2402.4  on 11860  degrees of freedom
AIC: 3148.4

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.163437   0.185180 -17.0831 < 2.2e-16 ***
agecat5-14            -0.952113   0.207684  -4.5844 4.552e-06 ***
agecat15-24           -0.666267   0.206727  -3.2229 0.0012689 ** 
agecat25-34           -0.526778   0.188029  -2.8016 0.0050854 ** 
agecat35-44           -0.770235   0.210440  -3.6601 0.0002521 ***
agecat45-54           -0.758231   0.235697  -3.2170 0.0012955 ** 
agecat55-64           -0.614566   0.282748  -2.1736 0.0297389 *  
agecat65-74           -0.951199   0.470422  -2.0220 0.0431749 *  
agecat75+            -13.377974   0.232820 -57.4605 < 2.2e-16 ***
agecatMissing         -0.721560   0.518054  -1.3928 0.1636718    
female                 0.067562   0.101737   0.6641 0.5066367    
racewhiteYes           0.826884   0.707753   1.1683 0.2426769    
racewhiteMissing       2.338603   0.604465   3.8689 0.0001093 ***
gichronYes             0.534407   0.203199   2.6300 0.0085393 ** 
gichronMissing       -12.448480   1.020161 -12.2025 < 2.2e-16 ***
anim_anyYes            0.210158   0.122222   1.7195 0.0855285 .  
gicontactbaseYes       0.947576   0.185077   5.1199 3.057e-07 ***
gicontactbaseMissing -12.669408   0.612171 -20.6959 < 2.2e-16 ***
rawfood                0.318506   0.142677   2.2324 0.0255915 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Doheny
> dhfit <- mpreg(diarrheaci10~entero470 +berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Doheny",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9967  -0.3153  -0.2732  -0.2456   2.5704  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.74042    0.29430  -9.312  < 2e-16 ***
entero470              1.72154    0.53746   3.203  0.00136 ** 
bermOpen              -0.21271    0.20983  -1.014  0.31072    
agecat5-14            -0.72999    0.27995  -2.608  0.00912 ** 
agecat15-24           -0.52396    0.35205  -1.488  0.13668    
agecat25-34           -0.47125    0.35877  -1.314  0.18901    
agecat35-44           -0.35473    0.31838  -1.114  0.26520    
agecat45-54           -0.38436    0.35825  -1.073  0.28332    
agecat55-64           -1.64307    0.75645  -2.172  0.02985 *  
agecat65-74           -0.21297    1.03711  -0.205  0.83730    
agecatMissing        -12.76243  399.83984  -0.032  0.97454    
female                -0.02422    0.17732  -0.137  0.89137    
racewhiteYes           0.09378    0.19419   0.483  0.62913    
racewhiteMissing      -0.12998    0.72765  -0.179  0.85823    
gichronYes             0.90922    0.42898   2.120  0.03405 *  
anim_anyYes           -0.13215    0.22098  -0.598  0.54984    
gicontactbaseYes       0.31406    0.36805   0.853  0.39349    
gicontactbaseMissing   0.71943    0.58872   1.222  0.22170    
rawfood                0.44033    0.20332   2.166  0.03033 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 848.56  on 3078  degrees of freedom
Residual deviance: 818.08  on 3060  degrees of freedom
AIC: 1128.1

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.740420   0.303194  -9.0385 < 2.2e-16 ***
entero470              1.721544   0.566444   3.0392  0.002372 ** 
bermOpen              -0.212709   0.250163  -0.8503  0.395170    
agecat5-14            -0.729994   0.276207  -2.6429  0.008219 ** 
agecat15-24           -0.523956   0.346755  -1.5110  0.130781    
agecat25-34           -0.471251   0.342468  -1.3760  0.168809    
agecat35-44           -0.354733   0.311366  -1.1393  0.254586    
agecat45-54           -0.384358   0.340102  -1.1301  0.258424    
agecat55-64           -1.643074   0.765287  -2.1470  0.031793 *  
agecat65-74           -0.212969   1.023415  -0.2081  0.835154    
agecatMissing        -12.762431   0.515523 -24.7563 < 2.2e-16 ***
female                -0.024217   0.180658  -0.1340  0.893364    
racewhiteYes           0.093784   0.212448   0.4414  0.658892    
racewhiteMissing      -0.129976   0.701142  -0.1854  0.852933    
gichronYes             0.909215   0.414075   2.1958  0.028108 *  
anim_anyYes           -0.132147   0.236030  -0.5599  0.575565    
gicontactbaseYes       0.314058   0.360733   0.8706  0.383967    
gicontactbaseMissing   0.719430   0.523086   1.3754  0.169021    
rawfood                0.440334   0.214206   2.0557  0.039815 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Edgewater
> edfit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Edgewater",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7714  -0.3658  -0.3041  -0.2503   2.4170  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.96707    0.54069  -5.488 4.08e-08 ***
entero470           0.62653    0.31513   1.988   0.0468 *  
agecat5-14         -0.93357    0.60913  -1.533   0.1254    
agecat15-24        -0.23431    0.54823  -0.427   0.6691    
agecat25-34        -0.29723    0.56415  -0.527   0.5983    
agecat35-44        -0.65146    0.64036  -1.017   0.3090    
agecat45-54         0.26282    0.61836   0.425   0.6708    
agecat55-64       -15.71769 1542.97104  -0.010   0.9919    
agecat65-74         1.43776    1.13432   1.267   0.2050    
agecat75+         -15.77255 5717.53216  -0.003   0.9978    
agecatMissing     -15.76410 1300.04261  -0.012   0.9903    
female             -0.07125    0.31177  -0.229   0.8192    
racewhiteYes        0.25701    0.37263   0.690   0.4904    
gichronYes          0.93777    0.74898   1.252   0.2105    
gichronMissing    -16.34178 5717.53217  -0.003   0.9977    
anim_anyYes         0.18002    0.37291   0.483   0.6293    
gicontactbaseYes    0.86646    0.54397   1.593   0.1112    
rawfood            -0.23823    0.43377  -0.549   0.5829    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 242.47  on 720  degrees of freedom
Residual deviance: 222.96  on 703  degrees of freedom
AIC: 344.96

Number of Fisher Scoring iterations: 16



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.967069   0.553719  -5.3584 8.394e-08 ***
entero470          0.626528   0.325777   1.9232   0.05446 .  
agecat5-14        -0.933570   0.602335  -1.5499   0.12116    
agecat15-24       -0.234313   0.537031  -0.4363   0.66261    
agecat25-34       -0.297225   0.573390  -0.5184   0.60420    
agecat35-44       -0.651457   0.629458  -1.0349   0.30069    
agecat45-54        0.262824   0.622570   0.4222   0.67291    
agecat55-64      -15.717689   0.540163 -29.0981 < 2.2e-16 ***
agecat65-74        1.437756   1.000727   1.4367   0.15080    
agecat75+        -15.772546   1.101380 -14.3207 < 2.2e-16 ***
agecatMissing    -15.764101   0.610843 -25.8071 < 2.2e-16 ***
female            -0.071251   0.304620  -0.2339   0.81506    
racewhiteYes       0.257013   0.387121   0.6639   0.50675    
gichronYes         0.937774   0.594341   1.5778   0.11460    
gichronMissing   -16.341780   1.198642 -13.6336 < 2.2e-16 ***
anim_anyYes        0.180018   0.384364   0.4684   0.63953    
gicontactbaseYes   0.866459   0.512569   1.6904   0.09095 .  
rawfood           -0.238233   0.432510  -0.5508   0.58176    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Fairhope
> fafit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Fairhope",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9190  -0.3626  -0.3189  -0.2905   2.2322  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.5527     0.3973  -6.425 1.32e-10 ***
entero470              -0.3196     1.0257  -0.312   0.7553    
agecat5-14             -0.5875     0.3725  -1.577   0.1147    
agecat15-24            -0.6133     0.5307  -1.156   0.2478    
agecat25-34            -0.4719     0.4741  -0.995   0.3196    
agecat35-44            -0.5060     0.5842  -0.866   0.3864    
agecat45-54            -0.5228     0.6492  -0.805   0.4206    
agecat55-64            -0.1893     1.0512  -0.180   0.8571    
agecat65-74             0.2564     1.0409   0.246   0.8054    
agecat75+             -12.9111   902.0943  -0.014   0.9886    
female                  0.2681     0.2872   0.934   0.3504    
racewhiteYes           -0.2585     0.3404  -0.760   0.4475    
gichronYes              0.5912     1.0270   0.576   0.5648    
anim_anyYes             0.1515     0.3493   0.434   0.6644    
gicontactbaseYes        1.3371     0.4579   2.920   0.0035 ** 
gicontactbaseMissing  -12.3020  1275.7543  -0.010   0.9923    
rawfood                 0.1924     0.3839   0.501   0.6163    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 281.80  on 807  degrees of freedom
Residual deviance: 269.64  on 791  degrees of freedom
AIC: 405.64

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.55268    0.49925  -5.1130 3.171e-07 ***
entero470             -0.31965    0.98059  -0.3260   0.74445    
agecat5-14            -0.58753    0.37391  -1.5713   0.11611    
agecat15-24           -0.61332    0.52278  -1.1732   0.24071    
agecat25-34           -0.47189    0.46250  -1.0203   0.30759    
agecat35-44           -0.50603    0.53190  -0.9514   0.34142    
agecat45-54           -0.52280    0.64268  -0.8135   0.41595    
agecat55-64           -0.18934    1.09180  -0.1734   0.86232    
agecat65-74            0.25641    0.97450   0.2631   0.79246    
agecat75+            -12.91106    0.78776 -16.3896 < 2.2e-16 ***
female                 0.26815    0.28692   0.9346   0.35001    
racewhiteYes          -0.25854    0.32970  -0.7842   0.43294    
gichronYes             0.59118    0.99114   0.5965   0.55087    
anim_anyYes            0.15154    0.36692   0.4130   0.67960    
gicontactbaseYes       1.33712    0.58419   2.2888   0.02209 *  
gicontactbaseMissing -12.30203    1.52854  -8.0482 8.399e-16 ***
rawfood                0.19237    0.44269   0.4345   0.66390    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Goddard
> gdfit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Goddard",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6318  -0.3235  -0.2623  -0.2168   2.6988  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.81272    0.42608  -6.601 4.07e-11 ***
entero470           0.26119    0.72741   0.359   0.7195    
agecat5-14         -0.85539    0.47331  -1.807   0.0707 .  
agecat15-24        -0.90894    0.60779  -1.495   0.1348    
agecat25-34        -0.35083    0.48579  -0.722   0.4702    
agecat35-44        -0.42497    0.49305  -0.862   0.3887    
agecat45-54        -2.11743    1.06190  -1.994   0.0462 *  
agecat55-64        -1.60947    1.06380  -1.513   0.1303    
agecat65-74        -0.36169    1.07577  -0.336   0.7367    
agecat75+         -16.74490 5435.26453  -0.003   0.9975    
agecatMissing     -16.85156 2894.36980  -0.006   0.9954    
female              0.20216    0.31865   0.634   0.5258    
racewhiteYes        0.17814    0.35229   0.506   0.6131    
racewhiteMissing    0.34067 7257.85392   0.000   1.0000    
gichronYes          0.93347    0.75279   1.240   0.2150    
anim_anyYes        -0.08219    0.35072  -0.234   0.8147    
gicontactbaseYes  -16.08128 1257.49007  -0.013   0.9898    
rawfood             0.39463    0.36014   1.096   0.2732    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 270.47  on 1050  degrees of freedom
Residual deviance: 252.05  on 1033  degrees of freedom
AIC: 372.05

Number of Fisher Scoring iterations: 17



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.812719   0.481214  -5.8450 5.064e-09 ***
entero470          0.261187   0.651962   0.4006   0.68870    
agecat5-14        -0.855388   0.457295  -1.8705   0.06141 .  
agecat15-24       -0.908945   0.589926  -1.5408   0.12337    
agecat25-34       -0.350832   0.417559  -0.8402   0.40080    
agecat35-44       -0.424973   0.464796  -0.9143   0.36055    
agecat45-54       -2.117426   1.076036  -1.9678   0.04909 *  
agecat55-64       -1.609467   1.076351  -1.4953   0.13484    
agecat65-74       -0.361694   1.075728  -0.3362   0.73670    
agecat75+        -16.744899   0.746410 -22.4339 < 2.2e-16 ***
agecatMissing    -16.851561   0.594650 -28.3386 < 2.2e-16 ***
female             0.202164   0.289418   0.6985   0.48485    
racewhiteYes       0.178140   0.394908   0.4511   0.65192    
racewhiteMissing   0.340672   1.179376   0.2889   0.77269    
gichronYes         0.933471   0.697790   1.3378   0.18098    
anim_anyYes       -0.082195   0.407126  -0.2019   0.84000    
gicontactbaseYes -16.081283   0.302993 -53.0747 < 2.2e-16 ***
rawfood            0.394634   0.397483   0.9928   0.32079    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Malibu
> mafit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Malibu",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6977  -0.3411  -0.2989  -0.2816   2.5682  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.79209    0.29388  -9.501  < 2e-16 ***
entero470         -14.34124  885.88251  -0.016  0.98708    
agecat5-14         -0.45838    0.31529  -1.454  0.14599    
agecat15-24        -0.41478    0.35782  -1.159  0.24638    
agecat25-34        -0.35998    0.34974  -1.029  0.30334    
agecat35-44        -0.05221    0.33109  -0.158  0.87470    
agecat45-54        -0.52559    0.40410  -1.301  0.19338    
agecat55-64        -0.53881    0.56959  -0.946  0.34416    
agecat65-74       -14.69087  735.53118  -0.020  0.98406    
agecat75+         -14.85337 1642.93370  -0.009  0.99279    
female              0.03869    0.18285   0.212  0.83241    
racewhiteYes        0.10323    0.19382   0.533  0.59430    
racewhiteMissing   -1.03364    0.72437  -1.427  0.15360    
gichronYes          1.15695    0.42728   2.708  0.00678 ** 
anim_anyYes        -0.15417    0.23538  -0.655  0.51248    
gicontactbaseYes    0.10148    0.42126   0.241  0.80963    
rawfood             0.27438    0.21466   1.278  0.20117    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 740.43  on 2494  degrees of freedom
Residual deviance: 720.67  on 2478  degrees of freedom
AIC: 1000.7

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.792094   0.303949  -9.1861 < 2.2e-16 ***
entero470        -14.341240   0.358765 -39.9739 < 2.2e-16 ***
agecat5-14        -0.458380   0.319963  -1.4326  0.151971    
agecat15-24       -0.414782   0.355922  -1.1654  0.243868    
agecat25-34       -0.359982   0.345960  -1.0405  0.298094    
agecat35-44       -0.052212   0.311371  -0.1677  0.866832    
agecat45-54       -0.525590   0.399090  -1.3170  0.187848    
agecat55-64       -0.538811   0.551399  -0.9772  0.328484    
agecat65-74      -14.690873   0.400297 -36.6999 < 2.2e-16 ***
agecat75+        -14.853372   0.672244 -22.0952 < 2.2e-16 ***
female             0.038693   0.179304   0.2158  0.829148    
racewhiteYes       0.103234   0.209369   0.4931  0.621964    
racewhiteMissing  -1.033636   0.721811  -1.4320  0.152143    
gichronYes         1.156947   0.418261   2.7661  0.005673 ** 
anim_anyYes       -0.154168   0.233302  -0.6608  0.508736    
gicontactbaseYes   0.101481   0.430064   0.2360  0.813459    
rawfood            0.274378   0.223055   1.2301  0.218663    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Mission Bay
> mbfit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Mission Bay",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.83869  -0.29783  -0.23890  -0.00006   2.53417  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.65585    0.21629 -12.279  < 2e-16 ***
entero470               0.40672    1.01949   0.399 0.689934    
agecat5-14             -0.60858    0.23512  -2.588 0.009641 ** 
agecat15-24            -0.59659    0.35602  -1.676 0.093799 .  
agecat25-34            -0.33263    0.30310  -1.097 0.272462    
agecat35-44            -0.58147    0.34053  -1.708 0.087721 .  
agecat45-54            -0.03935    0.39173  -0.100 0.919988    
agecat55-64           -17.33951 2539.14782  -0.007 0.994551    
agecat65-74           -17.25503 4253.16212  -0.004 0.996763    
agecat75+             -17.47701 7723.23471  -0.002 0.998194    
agecatMissing          -1.54009    1.01762  -1.513 0.130172    
female                 -0.12714    0.17707  -0.718 0.472747    
racewhiteYes            0.71102    0.20860   3.409 0.000653 ***
racewhiteMissing      -17.03403  447.39474  -0.038 0.969629    
gichronYes              0.45611    0.59829   0.762 0.445844    
anim_anyYes             0.33000    0.20877   1.581 0.113940    
gicontactbaseYes        0.29028    0.51975   0.558 0.576506    
gicontactbaseMissing    0.37479    0.42292   0.886 0.375510    
rawfood                -0.62214    0.21166  -2.939 0.003290 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 892.84  on 4029  degrees of freedom
Residual deviance: 760.01  on 4011  degrees of freedom
AIC: 1058

Number of Fisher Scoring iterations: 18



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error   z value  Pr(>|z|)    
(Intercept)           -2.655853   0.244235  -10.8742 < 2.2e-16 ***
entero470              0.406719   1.038655    0.3916  0.695367    
agecat5-14            -0.608584   0.273469   -2.2254  0.026053 *  
agecat15-24           -0.596586   0.384394   -1.5520  0.120658    
agecat25-34           -0.332626   0.296102   -1.1233  0.261290    
agecat35-44           -0.581470   0.342627   -1.6971  0.089679 .  
agecat45-54           -0.039349   0.438992   -0.0896  0.928578    
agecat55-64          -17.339507   0.328988  -52.7056 < 2.2e-16 ***
agecat65-74          -17.255033   0.445804  -38.7054 < 2.2e-16 ***
agecat75+            -17.477006   0.557437  -31.3525 < 2.2e-16 ***
agecatMissing         -1.540088   0.982569   -1.5674  0.117019    
female                -0.127137   0.158685   -0.8012  0.423021    
racewhiteYes           0.711017   0.254849    2.7900  0.005272 ** 
racewhiteMissing     -17.034034   0.142067 -119.9012 < 2.2e-16 ***
gichronYes             0.456115   0.608005    0.7502  0.453145    
anim_anyYes            0.330002   0.247979    1.3308  0.183266    
gicontactbaseYes       0.290279   0.443700    0.6542  0.512968    
gicontactbaseMissing   0.374795   0.404354    0.9269  0.353980    
rawfood               -0.622140   0.210376   -2.9573  0.003104 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Warning message:
glm.fit: fitted rates numerically 0 occurred 
> 
> # Surfside
> sufit <- mpreg(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Surfside",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7675  -0.3161  -0.2760  -0.2373   2.5386  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)       -3.47532    0.35987  -9.657  < 2e-16 ***
entero470          0.10094    0.23098   0.437  0.66210    
agecat5-14        -0.75610    0.23850  -3.170  0.00152 ** 
agecat15-24       -0.70913    0.24237  -2.926  0.00344 ** 
agecat25-34       -0.17365    0.23380  -0.743  0.45764    
agecat35-44       -0.34305    0.23111  -1.484  0.13771    
agecat45-54       -0.47067    0.23584  -1.996  0.04596 *  
agecat55-64       -0.27402    0.26424  -1.037  0.29973    
agecat65-74      -14.59101  284.96871  -0.051  0.95916    
agecat75+         -0.58948    1.01935  -0.578  0.56307    
agecatMissing      0.33390    0.42306   0.789  0.42996    
female             0.08840    0.10978   0.805  0.42066    
racewhiteYes       0.54868    0.30884   1.777  0.07563 .  
racewhiteMissing -14.26381  838.31846  -0.017  0.98642    
gichronYes         1.03948    0.21221   4.898 9.67e-07 ***
anim_anyYes        0.02413    0.13583   0.178  0.85900    
gicontactbaseYes   0.62673    0.19544   3.207  0.00134 ** 
rawfood            0.35692    0.12040   2.964  0.00303 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2150.7  on 7935  degrees of freedom
Residual deviance: 2066.9  on 7918  degrees of freedom
AIC: 2786.9

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -3.475325   0.433960  -8.0084 1.162e-15 ***
entero470          0.100943   0.283631   0.3559  0.721920    
agecat5-14        -0.756097   0.257467  -2.9367  0.003318 ** 
agecat15-24       -0.709131   0.244021  -2.9060  0.003660 ** 
agecat25-34       -0.173653   0.225011  -0.7718  0.440261    
agecat35-44       -0.343053   0.235921  -1.4541  0.145917    
agecat45-54       -0.470668   0.234184  -2.0098  0.044450 *  
agecat55-64       -0.274015   0.262936  -1.0421  0.297347    
agecat65-74      -14.591011   0.223311 -65.3393 < 2.2e-16 ***
agecat75+         -0.589478   1.006828  -0.5855  0.558225    
agecatMissing      0.333903   0.636491   0.5246  0.599861    
female             0.088404   0.104420   0.8466  0.397208    
racewhiteYes       0.548682   0.374142   1.4665  0.142510    
racewhiteMissing -14.263811   0.890882 -16.0109 < 2.2e-16 ***
gichronYes         1.039480   0.193906   5.3607 8.288e-08 ***
anim_anyYes        0.024129   0.156151   0.1545  0.877196    
gicontactbaseYes   0.626727   0.222910   2.8116  0.004930 ** 
rawfood            0.356924   0.124702   2.8622  0.004207 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Pooled estimates
> # (can't use the mpreg fn because we 
> # need the actual glm returned object 
> # for the LR tests)
> 
> # all beaches
> all.fit <- glm(diarrheaci10~entero470 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	all.VC <- cl(ad,fm=all.fit,cluster=ad$hhid)
> 	overall.fit <- coeftest(all.fit, all.VC)
> 	summary(all.fit)

Call:
glm(formula = diarrheaci10 ~ entero470 + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach, family = poisson(link = "log"), 
    data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9174  -0.3156  -0.2721  -0.2350   2.8805  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.77521    0.10869 -25.533  < 2e-16 ***
entero470              0.32819    0.10990   2.986 0.002825 ** 
agecat5-14            -0.68987    0.07822  -8.819  < 2e-16 ***
agecat15-24           -0.69632    0.08866  -7.854 4.03e-15 ***
agecat25-34           -0.30785    0.08485  -3.628 0.000286 ***
agecat35-44           -0.32818    0.08360  -3.926 8.65e-05 ***
agecat45-54           -0.50824    0.09544  -5.325 1.01e-07 ***
agecat55-64           -0.51459    0.12723  -4.045 5.24e-05 ***
agecat65-74           -1.05352    0.28534  -3.692 0.000222 ***
agecat75+             -1.98381    1.00227  -1.979 0.047780 *  
agecatMissing         -0.53986    0.21053  -2.564 0.010340 *  
female                 0.05368    0.04507   1.191 0.233586    
racewhiteYes           0.21482    0.06867   3.128 0.001759 ** 
racewhiteMissing      -1.50271    0.28698  -5.236 1.64e-07 ***
gichronYes             0.72553    0.10337   7.019 2.24e-12 ***
gichronMissing        -9.89030  116.19686  -0.085 0.932169    
anim_anyYes            0.18099    0.05356   3.380 0.000726 ***
gicontactbaseYes       0.62502    0.08290   7.540 4.71e-14 ***
gicontactbaseMissing   0.44674    0.27158   1.645 0.099978 .  
rawfood                0.21050    0.05589   3.767 0.000166 ***
beachBoqueron         -0.50618    0.10647  -4.754 1.99e-06 ***
beachDoheny           -0.15909    0.11106  -1.432 0.152005    
beachEdgewater        -0.06790    0.17352  -0.391 0.695584    
beachFairhope          0.06448    0.15942   0.404 0.685886    
beachGoddard          -0.38841    0.17134  -2.267 0.023396 *  
beachHuntington        0.47923    0.13983   3.427 0.000610 ***
beachMalibu           -0.03980    0.11476  -0.347 0.728734    
beachMission Bay      -0.17411    0.12260  -1.420 0.155549    
beachSilver           -0.33484    0.10017  -3.343 0.000829 ***
beachSurfside         -0.39884    0.09348  -4.267 1.98e-05 ***
beachWashington Park  -0.10083    0.11769  -0.857 0.391618    
beachWest              0.23101    0.11983   1.928 0.053890 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12521  on 45998  degrees of freedom
Residual deviance: 12026  on 45967  degrees of freedom
AIC: 16080

Number of Fisher Scoring iterations: 11

> 	overall.fit

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -2.775210   0.121474 -22.8461 < 2.2e-16 ***
entero470             0.328186   0.125574   2.6135 0.0089624 ** 
agecat5-14           -0.689871   0.081050  -8.5117 < 2.2e-16 ***
agecat15-24          -0.696316   0.089802  -7.7539 8.910e-15 ***
agecat25-34          -0.307851   0.082756  -3.7200 0.0001992 ***
agecat35-44          -0.328182   0.083022  -3.9530 7.719e-05 ***
agecat45-54          -0.508238   0.096281  -5.2787 1.301e-07 ***
agecat55-64          -0.514586   0.126253  -4.0758 4.585e-05 ***
agecat65-74          -1.053518   0.282963  -3.7232 0.0001967 ***
agecat75+            -1.983806   1.000474  -1.9829 0.0473824 *  
agecatMissing        -0.539859   0.273935  -1.9708 0.0487516 *  
female                0.053681   0.042905   1.2512 0.2108795    
racewhiteYes          0.214824   0.079344   2.7075 0.0067791 ** 
racewhiteMissing     -1.502705   0.324463  -4.6314 3.633e-06 ***
gichronYes            0.725527   0.100662   7.2075 5.697e-13 ***
gichronMissing       -9.890297   0.345877 -28.5949 < 2.2e-16 ***
anim_anyYes           0.180993   0.059279   3.0532 0.0022639 ** 
gicontactbaseYes      0.625016   0.089473   6.9855 2.839e-12 ***
gicontactbaseMissing  0.446739   0.252440   1.7697 0.0767794 .  
rawfood               0.210500   0.059373   3.5454 0.0003920 ***
beachBoqueron        -0.506175   0.122917  -4.1180 3.821e-05 ***
beachDoheny          -0.159088   0.126189  -1.2607 0.2074124    
beachEdgewater       -0.067895   0.186996  -0.3631 0.7165420    
beachFairhope         0.064475   0.179036   0.3601 0.7187544    
beachGoddard         -0.388408   0.203604  -1.9077 0.0564345 .  
beachHuntington       0.479235   0.156669   3.0589 0.0022216 ** 
beachMalibu          -0.039800   0.125729  -0.3166 0.7515790    
beachMission Bay     -0.174114   0.155659  -1.1186 0.2633285    
beachSilver          -0.334843   0.109421  -3.0601 0.0022124 ** 
beachSurfside        -0.398841   0.105366  -3.7853 0.0001535 ***
beachWashington Park -0.100825   0.134348  -0.7505 0.4529662    
beachWest             0.231006   0.136029   1.6982 0.0894687 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Interaction model with fresh v. marine beaches
> mf.ref <- glm(diarrheaci10~entero470 +marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> mf.fit <- glm(diarrheaci10~entero470*marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	mf.VC <- cl(ad,fm=mf.fit,cluster=ad$hhid)
> 	mf.body <- coeftest(mf.fit, mf.VC) 
> 	summary(mf.fit)

Call:
glm(formula = diarrheaci10 ~ entero470 * marine + agecat + female + 
    racewhite + gichron + anim_any + gicontactbase + rawfood + 
    beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9175  -0.3163  -0.2722  -0.2350   2.8808  

Coefficients: (1 not defined because of singularities)
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.53118    0.13407 -18.880  < 2e-16 ***
entero470              0.27728    0.18567   1.493 0.135328    
marineYes             -0.24660    0.12782  -1.929 0.053700 .  
agecat5-14            -0.68969    0.07822  -8.817  < 2e-16 ***
agecat15-24           -0.69675    0.08867  -7.858 3.91e-15 ***
agecat25-34           -0.30805    0.08486  -3.630 0.000283 ***
agecat35-44           -0.32812    0.08360  -3.925 8.68e-05 ***
agecat45-54           -0.50804    0.09544  -5.323 1.02e-07 ***
agecat55-64           -0.51519    0.12724  -4.049 5.14e-05 ***
agecat65-74           -1.05358    0.28534  -3.692 0.000222 ***
agecat75+             -1.98387    1.00227  -1.979 0.047773 *  
agecatMissing         -0.54024    0.21054  -2.566 0.010287 *  
female                 0.05358    0.04507   1.189 0.234446    
racewhiteYes           0.21555    0.06870   3.137 0.001705 ** 
racewhiteMissing      -1.50324    0.28698  -5.238 1.62e-07 ***
gichronYes             0.72527    0.10337   7.016 2.28e-12 ***
gichronMissing        -9.88983  116.20243  -0.085 0.932175    
anim_anyYes            0.18112    0.05356   3.382 0.000721 ***
gicontactbaseYes       0.62505    0.08290   7.540 4.70e-14 ***
gicontactbaseMissing   0.44581    0.27159   1.642 0.100692    
rawfood                0.21066    0.05589   3.769 0.000164 ***
beachBoqueron         -0.50355    0.10677  -4.716 2.40e-06 ***
beachDoheny           -0.15730    0.11119  -1.415 0.157142    
beachEdgewater        -0.07672    0.17548  -0.437 0.661957    
beachFairhope          0.06546    0.15945   0.411 0.681384    
beachGoddard          -0.38756    0.17136  -2.262 0.023719 *  
beachHuntington        0.23827    0.15176   1.570 0.116407    
beachMalibu           -0.03790    0.11491  -0.330 0.741555    
beachMission Bay      -0.17182    0.12279  -1.399 0.161720    
beachSilver           -0.57953    0.12126  -4.779 1.76e-06 ***
beachSurfside         -0.39898    0.09348  -4.268 1.97e-05 ***
beachWashington Park  -0.34548    0.13606  -2.539 0.011109 *  
beachWest                   NA         NA      NA       NA    
entero470:marineYes    0.07885    0.23011   0.343 0.731851    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12521  on 45998  degrees of freedom
Residual deviance: 12026  on 45966  degrees of freedom
AIC: 16082

Number of Fisher Scoring iterations: 11

> 	lrtest(mf.ref,mf.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero470 + marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero470 * marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8008.1                     
2  33 -8008.0  1 0.1178     0.7314
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	mf.reri <- reri(b1=mf.body[2,1],b2=mf.body[3,1],b3=mf.body[nrow(mf.body),1],vcv=mf.VC[c(2,3,nrow(mf.VC)),c(2,3,nrow(mf.VC))])

RERI (95% CI) = 0.015 (-0.604,0.633); Pr > |z|= 0.963
> 	
> 
> # Interaction model with point v. non-point source beaches
> ps.ref <- glm(diarrheaci10~entero470 +pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> ps.fit <- glm(diarrheaci10~entero470*pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	ps.VC <- cl(ad,fm=ps.fit,cluster=ad$hhid)
> 	ps.body <- coeftest(ps.fit, ps.VC) 
> 	summary(ps.fit)

Call:
glm(formula = diarrheaci10 ~ entero470 * pointsource + agecat + 
    female + racewhite + gichron + anim_any + gicontactbase + 
    rawfood + beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9183  -0.3144  -0.2721  -0.2350   2.8801  

Coefficients: (1 not defined because of singularities)
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)               -3.16743    0.11102 -28.531  < 2e-16 ***
entero470                  0.23095    0.20619   1.120 0.262672    
pointsourceYes             0.38940    0.09488   4.104 4.06e-05 ***
agecat5-14                -0.69070    0.07824  -8.828  < 2e-16 ***
agecat15-24               -0.69643    0.08866  -7.855 3.98e-15 ***
agecat25-34               -0.30767    0.08485  -3.626 0.000288 ***
agecat35-44               -0.32865    0.08361  -3.931 8.46e-05 ***
agecat45-54               -0.50884    0.09545  -5.331 9.76e-08 ***
agecat55-64               -0.51401    0.12723  -4.040 5.35e-05 ***
agecat65-74               -1.05304    0.28535  -3.690 0.000224 ***
agecat75+                 -1.98223    1.00227  -1.978 0.047958 *  
agecatMissing             -0.53956    0.21054  -2.563 0.010383 *  
female                     0.05388    0.04507   1.196 0.231875    
racewhiteYes               0.21445    0.06868   3.122 0.001794 ** 
racewhiteMissing          -1.50167    0.28698  -5.233 1.67e-07 ***
gichronYes                 0.72601    0.10337   7.023 2.17e-12 ***
gichronMissing            -9.88784  116.33508  -0.085 0.932266    
anim_anyYes                0.18131    0.05356   3.385 0.000711 ***
gicontactbaseYes           0.62566    0.08291   7.547 4.47e-14 ***
gicontactbaseMissing       0.44803    0.27160   1.650 0.099025 .  
rawfood                    0.21103    0.05589   3.776 0.000160 ***
beachBoqueron             -0.50360    0.10659  -4.725 2.30e-06 ***
beachDoheny                0.23426    0.10776   2.174 0.029716 *  
beachEdgewater            -0.08131    0.17523  -0.464 0.642622    
beachFairhope              0.06587    0.15944   0.413 0.679493    
beachGoddard              -0.38748    0.17135  -2.261 0.023739 *  
beachHuntington            0.47905    0.13984   3.426 0.000613 ***
beachMalibu                0.35328    0.11143   3.170 0.001523 ** 
beachMission Bay           0.21862    0.12211   1.790 0.073394 .  
beachSilver               -0.33194    0.10032  -3.309 0.000937 ***
beachSurfside                   NA         NA      NA       NA    
beachWashington Park      -0.09793    0.11782  -0.831 0.405889    
beachWest                  0.22255    0.12084   1.842 0.065513 .  
entero470:pointsourceYes   0.13855    0.24421   0.567 0.570487    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12521  on 45998  degrees of freedom
Residual deviance: 12026  on 45966  degrees of freedom
AIC: 16082

Number of Fisher Scoring iterations: 11

> 	lrtest(ps.ref,ps.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero470 + pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero470 * pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8008.1                     
2  33 -8007.9  1 0.3278      0.567
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	ps.reri <- reri(b1=ps.body[2,1],b2=ps.body[3,1],b3=ps.body[nrow(ps.body),1],vcv=ps.VC[c(2,3,nrow(ps.VC)),c(2,3,nrow(ps.VC))])

RERI (95% CI) = 0.400 (-0.462,1.263); Pr > |z|= 0.363
> 
> # --------------------------------------
> # Age-stratified estimates and LR tests of
> # interaction
> 
> # reduced models for LR tests of indicator x age interactions
> agestrat.ref <- glm(diarrheaci10~entero470 +agestrat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 
> # Pooled estimate (Age 0-4, 5-10, >10), Body Immersion
> agestrat.fit <- glm(diarrheaci10~ entero470*agestrat +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	# commented out robust SE calcs b/c not used
> 	# agestrat.VC <- cl(ad,fm=agestrat.fit,cluster=ad$hhid)
> 	# agestrat.body <- coeftest(agestrat.fit, agestrat.VC) 
> 	lrtest(agestrat.ref,agestrat.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero470 + agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero470 * agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)  
1  26 -8034.7                       
2  29 -8030.6  3 8.1914    0.04222 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> # --------------------------------------
> # Stratified Models 
> # based on tests of interaction (above)
> # stratify the results by non-point and
> # point source conditions
> # --------------------------------------
> 
> # Pooled Non-point source and point-source
> nps <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7668  -0.3020  -0.2799  -0.2719   3.1769  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.440590   0.125127 -27.497  < 2e-16 ***
entero470             0.252780   0.206182   1.226  0.22020    
female                0.005306   0.074517   0.071  0.94324    
racewhiteYes          0.316804   0.109609   2.890  0.00385 ** 
racewhiteMissing     -2.603241   0.506734  -5.137 2.79e-07 ***
gichronYes            1.035743   0.163626   6.330 2.45e-10 ***
anim_anyYes           0.051213   0.091590   0.559  0.57606    
gicontactbaseYes      0.488272   0.151651   3.220  0.00128 ** 
gicontactbaseMissing  0.407618   0.340552   1.197  0.23133    
rawfood               0.157064   0.083273   1.886  0.05928 .  
beachMalibu           0.162103   0.124895   1.298  0.19432    
beachMission Bay      0.137253   0.139331   0.985  0.32458    
beachSurfside        -0.172447   0.116034  -1.486  0.13723    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4646.0  on 17539  degrees of freedom
Residual deviance: 4496.5  on 17527  degrees of freedom
AIC: 5984.5

Number of Fisher Scoring iterations: 7



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.4405899  0.1475262 -23.3219 < 2.2e-16 ***
entero470             0.2527797  0.2571572   0.9830  0.325619    
female                0.0053058  0.0712842   0.0744  0.940667    
racewhiteYes          0.3168044  0.1313156   2.4125  0.015842 *  
racewhiteMissing     -2.6032412  0.5180081  -5.0255 5.022e-07 ***
gichronYes            1.0357427  0.1533734   6.7531 1.447e-11 ***
anim_anyYes           0.0512128  0.1007398   0.5084  0.611196    
gicontactbaseYes      0.4882717  0.1648453   2.9620  0.003056 ** 
gicontactbaseMissing  0.4076179  0.3262030   1.2496  0.211452    
rawfood               0.1570639  0.0914117   1.7182  0.085760 .  
beachMalibu           0.1621029  0.1399984   1.1579  0.246908    
beachMission Bay      0.1372529  0.1801477   0.7619  0.446125    
beachSurfside        -0.1724467  0.1306177  -1.3202  0.186755    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> ps <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7727  -0.3185  -0.2801  -0.2367   2.3756  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.29588    0.10442 -31.562  < 2e-16 ***
entero470              0.36255    0.13026   2.783 0.005380 ** 
female                 0.07938    0.05657   1.403 0.160563    
racewhiteYes           0.16327    0.08751   1.866 0.062089 .  
racewhiteMissing       0.34955    0.34277   1.020 0.307832    
gichronYes             0.59402    0.13156   4.515 6.33e-06 ***
gichronMissing       -11.31584  202.55228  -0.056 0.955448    
anim_anyYes            0.22422    0.06632   3.381 0.000722 ***
gicontactbaseYes       0.71011    0.09905   7.170 7.53e-13 ***
gicontactbaseMissing   0.42096    0.44990   0.936 0.349441    
rawfood                0.25711    0.07302   3.521 0.000430 ***
beachBoqueron         -0.50343    0.11588  -4.345 1.40e-05 ***
beachEdgewater        -0.04637    0.17584  -0.264 0.791991    
beachFairhope          0.11588    0.16058   0.722 0.470516    
beachGoddard          -0.34664    0.17248  -2.010 0.044460 *  
beachHuntington        0.52524    0.14199   3.699 0.000216 ***
beachSilver           -0.31366    0.10262  -3.056 0.002241 ** 
beachWashington Park  -0.07765    0.11997  -0.647 0.517436    
beachWest              0.22281    0.12181   1.829 0.067384 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 7872.7  on 28458  degrees of freedom
Residual deviance: 7605.1  on 28440  degrees of freedom
AIC: 10171

Number of Fisher Scoring iterations: 12



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.295884   0.120396 -27.3753 < 2.2e-16 ***
entero470              0.362551   0.143544   2.5257 0.0115462 *  
female                 0.079385   0.053769   1.4764 0.1398333    
racewhiteYes           0.163268   0.098948   1.6500 0.0989347 .  
racewhiteMissing       0.349553   0.362830   0.9634 0.3353426    
gichronYes             0.594017   0.130082   4.5665 4.960e-06 ***
gichronMissing       -11.315842   0.348899 -32.4330 < 2.2e-16 ***
anim_anyYes            0.224216   0.073427   3.0536 0.0022612 ** 
gicontactbaseYes       0.710113   0.106050   6.6960 2.142e-11 ***
gicontactbaseMissing   0.420963   0.407846   1.0322 0.3019968    
rawfood                0.257111   0.077202   3.3304 0.0008673 ***
beachBoqueron         -0.503427   0.134541  -3.7418 0.0001827 ***
beachEdgewater        -0.046374   0.189933  -0.2442 0.8071056    
beachFairhope          0.115879   0.181858   0.6372 0.5239994    
beachGoddard          -0.346641   0.206514  -1.6785 0.0932427 .  
beachHuntington        0.525244   0.159408   3.2950 0.0009843 ***
beachSilver           -0.313657   0.112694  -2.7833 0.0053816 ** 
beachWashington Park  -0.077655   0.136668  -0.5682 0.5698975    
beachWest              0.222813   0.138358   1.6104 0.1073101    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Age-stratified results
> age0to4   <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6848  -0.3816  -0.3596  -0.3123   2.6801  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.33550    0.24052  -9.710  < 2e-16 ***
entero470            -0.05988    0.34574  -0.173  0.86250    
female               -0.09862    0.12562  -0.785  0.43244    
racewhiteYes          0.17204    0.17264   0.996  0.31901    
racewhiteMissing     -1.78122    0.72763  -2.448  0.01437 *  
gichronYes            0.31815    0.71448   0.445  0.65611    
anim_anyYes           0.27755    0.14675   1.891  0.05858 .  
gicontactbaseYes      0.35633    0.27626   1.290  0.19710    
gicontactbaseMissing  0.71294    0.59516   1.198  0.23096    
rawfood              -0.60876    0.28049  -2.170  0.02998 *  
beachBoqueron        -0.66565    0.28651  -2.323  0.02016 *  
beachDoheny          -0.46438    0.30356  -1.530  0.12607    
beachEdgewater       -0.29905    0.49911  -0.599  0.54906    
beachFairhope        -0.22682    0.34303  -0.661  0.50847    
beachGoddard         -0.47593    0.38885  -1.224  0.22098    
beachHuntington      -0.23844    0.39280  -0.607  0.54383    
beachMalibu          -0.45947    0.32340  -1.421  0.15539    
beachMission Bay     -0.30254    0.29392  -1.029  0.30333    
beachSilver          -0.73394    0.26904  -2.728  0.00637 ** 
beachSurfside        -0.82347    0.27810  -2.961  0.00307 ** 
beachWashington Park -0.57513    0.33048  -1.740  0.08181 .  
beachWest            -0.09812    0.34346  -0.286  0.77513    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1381.7  on 3803  degrees of freedom
Residual deviance: 1338.9  on 3782  degrees of freedom
AIC: 1894.9

Number of Fisher Scoring iterations: 6



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error z value  Pr(>|z|)    
(Intercept)          -2.335496   0.239400 -9.7556 < 2.2e-16 ***
entero470            -0.059878   0.339755 -0.1762  0.860107    
female               -0.098616   0.121445 -0.8120  0.416779    
racewhiteYes          0.172036   0.178098  0.9660  0.334063    
racewhiteMissing     -1.781218   0.766114 -2.3250  0.020072 *  
gichronYes            0.318149   0.657916  0.4836  0.628691    
anim_anyYes           0.277545   0.155200  1.7883  0.073726 .  
gicontactbaseYes      0.356328   0.280216  1.2716  0.203509    
gicontactbaseMissing  0.712941   0.586168  1.2163  0.223880    
rawfood              -0.608760   0.273237 -2.2280  0.025884 *  
beachBoqueron        -0.665652   0.300310 -2.2165  0.026654 *  
beachDoheny          -0.464377   0.299039 -1.5529  0.120448    
beachEdgewater       -0.299052   0.498001 -0.6005  0.548170    
beachFairhope        -0.226821   0.340370 -0.6664  0.505159    
beachGoddard         -0.475928   0.416419 -1.1429  0.253077    
beachHuntington      -0.238440   0.411138 -0.5800  0.561948    
beachMalibu          -0.459470   0.332523 -1.3818  0.167042    
beachMission Bay     -0.302542   0.324037 -0.9337  0.350476    
beachSilver          -0.733943   0.288908 -2.5404  0.011072 *  
beachSurfside        -0.823471   0.292785 -2.8125  0.004915 ** 
beachWashington Park -0.575132   0.328070 -1.7531  0.079589 .  
beachWest            -0.098118   0.347385 -0.2824  0.777600    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age5to10  <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7193  -0.3059  -0.2674  -0.2100   2.9596  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.35253    0.20970 -15.988  < 2e-16 ***
entero470              0.37874    0.26026   1.455  0.14559    
female                -0.07804    0.11183  -0.698  0.48528    
racewhiteYes           0.37828    0.15383   2.459  0.01393 *  
racewhiteMissing      -1.64971    0.59550  -2.770  0.00560 ** 
gichronYes             0.91384    0.45297   2.017  0.04365 *  
gichronMissing        -9.77710  254.72553  -0.038  0.96938    
anim_anyYes            0.08767    0.13816   0.635  0.52572    
gicontactbaseYes       0.39340    0.22745   1.730  0.08370 .  
gicontactbaseMissing   0.02285    0.71451   0.032  0.97449    
rawfood               -0.22285    0.18823  -1.184  0.23644    
beachBoqueron         -0.61296    0.28493  -2.151  0.03146 *  
beachDoheny           -0.27823    0.24485  -1.136  0.25581    
beachEdgewater        -0.16104    0.48836  -0.330  0.74159    
beachFairhope         -0.22195    0.37673  -0.589  0.55577    
beachGoddard          -0.23159    0.39461  -0.587  0.55728    
beachHuntington        0.70838    0.28385   2.496  0.01257 *  
beachMalibu            0.29050    0.25301   1.148  0.25090    
beachMission Bay       0.15789    0.25161   0.628  0.53031    
beachSilver           -0.15947    0.22894  -0.697  0.48607    
beachSurfside         -0.70536    0.26227  -2.689  0.00716 ** 
beachWashington Park  -0.01637    0.27009  -0.061  0.95166    
beachWest              0.19508    0.31342   0.622  0.53366    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2112.4  on 8497  degrees of freedom
Residual deviance: 2031.1  on 8475  degrees of freedom
AIC: 2723.1

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.352530   0.228232 -14.6891 < 2.2e-16 ***
entero470             0.378744   0.241178   1.5704  0.116324    
female               -0.078042   0.109762  -0.7110  0.477079    
racewhiteYes          0.378275   0.176227   2.1465  0.031832 *  
racewhiteMissing     -1.649712   0.621625  -2.6539  0.007957 ** 
gichronYes            0.913843   0.420923   2.1710  0.029928 *  
gichronMissing       -9.777096   0.699032 -13.9866 < 2.2e-16 ***
anim_anyYes           0.087668   0.142345   0.6159  0.537972    
gicontactbaseYes      0.393403   0.229877   1.7114  0.087013 .  
gicontactbaseMissing  0.022847   0.696363   0.0328  0.973827    
rawfood              -0.222853   0.200690  -1.1104  0.266812    
beachBoqueron        -0.612959   0.303206  -2.0216  0.043218 *  
beachDoheny          -0.278234   0.265145  -1.0494  0.294010    
beachEdgewater       -0.161039   0.480452  -0.3352  0.737487    
beachFairhope        -0.221945   0.403921  -0.5495  0.582678    
beachGoddard         -0.231589   0.422803  -0.5477  0.583865    
beachHuntington       0.708384   0.299502   2.3652  0.018020 *  
beachMalibu           0.290497   0.252954   1.1484  0.250796    
beachMission Bay      0.157893   0.302755   0.5215  0.602004    
beachSilver          -0.159468   0.228826  -0.6969  0.485867    
beachSurfside        -0.705356   0.274528  -2.5693  0.010189 *  
beachWashington Park -0.016374   0.279907  -0.0585  0.953353    
beachWest             0.195081   0.302855   0.6441  0.519485    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age11plus <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8201  -0.3105  -0.2692  -0.2375   2.8668  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.40295    0.11516 -29.551  < 2e-16 ***
entero470              0.30905    0.13273   2.328 0.019890 *  
female                 0.14017    0.05428   2.582 0.009819 ** 
racewhiteYes           0.16618    0.08584   1.936 0.052887 .  
racewhiteMissing      -2.03609    0.51008  -3.992 6.56e-05 ***
gichronYes             0.77227    0.10736   7.193 6.33e-13 ***
gichronMissing       -10.05336  149.17749  -0.067 0.946270    
anim_anyYes            0.17442    0.06392   2.729 0.006361 ** 
gicontactbaseYes       0.69545    0.09556   7.278 3.40e-13 ***
gicontactbaseMissing   0.50394    0.33863   1.488 0.136708    
rawfood                0.37026    0.06101   6.069 1.29e-09 ***
beachBoqueron         -0.47637    0.12803  -3.721 0.000199 ***
beachDoheny           -0.05480    0.13677  -0.401 0.688677    
beachEdgewater         0.06341    0.20034   0.317 0.751594    
beachFairhope          0.22376    0.20728   1.079 0.280371    
beachGoddard          -0.40309    0.21935  -1.838 0.066105 .  
beachHuntington        0.52894    0.18074   2.927 0.003427 ** 
beachMalibu           -0.03444    0.14046  -0.245 0.806290    
beachMission Bay      -0.23149    0.16391  -1.412 0.157858    
beachSilver           -0.28773    0.12329  -2.334 0.019602 *  
beachSurfside         -0.30562    0.11009  -2.776 0.005501 ** 
beachWashington Park   0.01554    0.14304   0.109 0.913497    
beachWest              0.31764    0.14018   2.266 0.023455 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 8808.0  on 32985  degrees of freedom
Residual deviance: 8477.4  on 32963  degrees of freedom
AIC: 11305

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.402947   0.125466 -27.1224 < 2.2e-16 ***
entero470              0.309048   0.140312   2.2026 0.0276242 *  
female                 0.140165   0.051030   2.7467 0.0060199 ** 
racewhiteYes           0.166180   0.089948   1.8475 0.0646737 .  
racewhiteMissing      -2.036087   0.525483  -3.8747 0.0001068 ***
gichronYes             0.772273   0.103624   7.4526 9.150e-14 ***
gichronMissing       -10.053364   0.392246 -25.6302 < 2.2e-16 ***
anim_anyYes            0.174421   0.066626   2.6179 0.0088468 ** 
gicontactbaseYes       0.695452   0.096142   7.2336 4.705e-13 ***
gicontactbaseMissing   0.503938   0.310024   1.6255 0.1040601    
rawfood                0.370264   0.063107   5.8672 4.432e-09 ***
beachBoqueron         -0.476365   0.140413  -3.3926 0.0006923 ***
beachDoheny           -0.054795   0.145696  -0.3761 0.7068485    
beachEdgewater         0.063415   0.207466   0.3057 0.7598619    
beachFairhope          0.223759   0.205925   1.0866 0.2772121    
beachGoddard          -0.403095   0.234687  -1.7176 0.0858720 .  
beachHuntington        0.528943   0.178771   2.9588 0.0030886 ** 
beachMalibu           -0.034444   0.147509  -0.2335 0.8153693    
beachMission Bay      -0.231495   0.184112  -1.2574 0.2086247    
beachSilver           -0.287733   0.128246  -2.2436 0.0248582 *  
beachSurfside         -0.305617   0.117921  -2.5917 0.0095497 ** 
beachWashington Park   0.015538   0.152972   0.1016 0.9190927    
beachWest              0.317639   0.150255   2.1140 0.0345146 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source estimates by age group
> nps0to4 <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6005  -0.3812  -0.3614  -0.2812   2.6430  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.690788   0.319113  -8.432   <2e-16 ***
entero470             -0.880230   1.016653  -0.866   0.3866    
female                 0.002988   0.211596   0.014   0.9887    
racewhiteYes           0.068648   0.280264   0.245   0.8065    
racewhiteMissing      -1.790505   0.730114  -2.452   0.0142 *  
gichronYes           -12.681123 637.148711  -0.020   0.9841    
anim_anyYes            0.070399   0.262865   0.268   0.7888    
gicontactbaseYes      -0.564302   0.715777  -0.788   0.4305    
gicontactbaseMissing   0.889547   0.605709   1.469   0.1419    
rawfood               -0.625066   0.405962  -1.540   0.1236    
beachMalibu           -0.007939   0.351917  -0.023   0.9820    
beachMission Bay       0.084974   0.340677   0.249   0.8030    
beachSurfside         -0.180109   0.339762  -0.530   0.5960    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 510.68  on 1535  degrees of freedom
Residual deviance: 492.84  on 1523  degrees of freedom
AIC: 698.84

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.6907880   0.3553867  -7.5714 3.691e-14 ***
entero470             -0.8802304   1.0145946  -0.8676   0.38563    
female                 0.0029880   0.2122216   0.0141   0.98877    
racewhiteYes           0.0686482   0.3233578   0.2123   0.83187    
racewhiteMissing      -1.7905053   0.7681088  -2.3311   0.01975 *  
gichronYes           -12.6811227   0.5287324 -23.9840 < 2.2e-16 ***
anim_anyYes            0.0703991   0.2619309   0.2688   0.78811    
gicontactbaseYes      -0.5643017   0.7084300  -0.7966   0.42571    
gicontactbaseMissing   0.8895467   0.5852549   1.5199   0.12853    
rawfood               -0.6250657   0.3909677  -1.5988   0.10987    
beachMalibu           -0.0079389   0.3601564  -0.0220   0.98241    
beachMission Bay       0.0849736   0.4046142   0.2100   0.83366    
beachSurfside         -0.1801089   0.3164100  -0.5692   0.56920    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps5to10 <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7267  -0.2970  -0.2488  -0.2124   3.0463  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.4919     0.2666 -13.099  < 2e-16 ***
entero470            -14.7535   661.6304  -0.022  0.98221    
female                -0.3541     0.1859  -1.905  0.05677 .  
racewhiteYes           0.3706     0.2336   1.587  0.11262    
racewhiteMissing      -2.7224     1.0124  -2.689  0.00717 ** 
gichronYes             1.5659     0.7170   2.184  0.02896 *  
anim_anyYes            0.1668     0.2206   0.756  0.44956    
gicontactbaseYes      -0.1344     0.5113  -0.263  0.79265    
gicontactbaseMissing   0.3595     0.7197   0.500  0.61735    
rawfood               -0.4560     0.2833  -1.610  0.10743    
beachMalibu            0.5780     0.2676   2.160  0.03079 *  
beachMission Bay       0.5159     0.2827   1.825  0.06802 .  
beachSurfside         -0.3866     0.2957  -1.307  0.19114    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 826.60  on 3610  degrees of freedom
Residual deviance: 780.61  on 3598  degrees of freedom
AIC: 1050.6

Number of Fisher Scoring iterations: 16



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.49195    0.29981 -11.6470 < 2.2e-16 ***
entero470            -14.75349    0.21875 -67.4438 < 2.2e-16 ***
female                -0.35410    0.17739  -1.9962  0.045910 *  
racewhiteYes           0.37061    0.28185   1.3149  0.188541    
racewhiteMissing      -2.72243    1.02646  -2.6523  0.007996 ** 
gichronYes             1.56586    0.55445   2.8242  0.004740 ** 
anim_anyYes            0.16683    0.23329   0.7151  0.474545    
gicontactbaseYes      -0.13442    0.50595  -0.2657  0.790492    
gicontactbaseMissing   0.35954    0.69771   0.5153  0.606328    
rawfood               -0.45604    0.29889  -1.5258  0.127062    
beachMalibu            0.57796    0.28067   2.0592  0.039475 *  
beachMission Bay       0.51588    0.34977   1.4749  0.140238    
beachSurfside         -0.38659    0.32455  -1.1912  0.233587    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps11plus <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8628  -0.3095  -0.2774  -0.2563   3.3109  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.59613    0.16154 -22.262  < 2e-16 ***
entero470             0.28049    0.23086   1.215 0.224382    
female                0.11137    0.08961   1.243 0.213895    
racewhiteYes          0.41403    0.14158   2.924 0.003451 ** 
racewhiteMissing     -3.24699    1.00707  -3.224 0.001263 ** 
gichronYes            1.01724    0.16980   5.991 2.09e-09 ***
anim_anyYes           0.03458    0.10982   0.315 0.752853    
gicontactbaseYes      0.66703    0.16400   4.067 4.76e-05 ***
gicontactbaseMissing  0.16881    0.50866   0.332 0.739986    
rawfood               0.33002    0.09342   3.533 0.000411 ***
beachMalibu           0.03356    0.15449   0.217 0.828023    
beachMission Bay      0.01104    0.18539   0.060 0.952517    
beachSurfside        -0.22153    0.14021  -1.580 0.114125    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3241.6  on 12187  degrees of freedom
Residual deviance: 3110.8  on 12175  degrees of freedom
AIC: 4158.8

Number of Fisher Scoring iterations: 8



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.596131   0.175559 -20.4839 < 2.2e-16 ***
entero470             0.280491   0.255602   1.0974  0.272477    
female                0.111373   0.084902   1.3118  0.189590    
racewhiteYes          0.414031   0.148995   2.7788  0.005456 ** 
racewhiteMissing     -3.246985   1.017798  -3.1902  0.001422 ** 
gichronYes            1.017239   0.157854   6.4442 1.162e-10 ***
anim_anyYes           0.034581   0.115014   0.3007  0.763670    
gicontactbaseYes      0.667033   0.169624   3.9324 8.409e-05 ***
gicontactbaseMissing  0.168810   0.488360   0.3457  0.729594    
rawfood               0.330021   0.098309   3.3570  0.000788 ***
beachMalibu           0.033560   0.160339   0.2093  0.834208    
beachMission Bay      0.011039   0.207237   0.0533  0.957517    
beachSurfside        -0.221528   0.144925  -1.5286  0.126372    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point-source estimates by age group
> ps0to4 <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8039  -0.4093  -0.3586  -0.3081   2.1492  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.3944     0.2678  -8.940  < 2e-16 ***
entero470              0.1526     0.3770   0.405  0.68569    
female                -0.1574     0.1564  -1.006  0.31423    
racewhiteYes           0.2262     0.2231   1.014  0.31068    
racewhiteMissing     -12.5655   507.8346  -0.025  0.98026    
gichronYes             0.4756     0.7219   0.659  0.51001    
anim_anyYes            0.3852     0.1813   2.124  0.03363 *  
gicontactbaseYes       0.6533     0.3033   2.154  0.03123 *  
gicontactbaseMissing -13.0825   735.7722  -0.018  0.98581    
rawfood               -0.6088     0.3895  -1.563  0.11808    
beachBoqueron         -0.6537     0.3108  -2.103  0.03546 *  
beachEdgewater        -0.4085     0.5046  -0.810  0.41822    
beachFairhope         -0.2896     0.3462  -0.837  0.40280    
beachGoddard          -0.5181     0.3915  -1.323  0.18578    
beachHuntington       -0.3146     0.3971  -0.792  0.42826    
beachSilver           -0.8038     0.2741  -2.932  0.00336 ** 
beachWashington Park  -0.6493     0.3353  -1.937  0.05280 .  
beachWest             -0.1905     0.3517  -0.542  0.58808    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 868.07  on 2267  degrees of freedom
Residual deviance: 837.20  on 2250  degrees of freedom
AIC: 1205.2

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.39437    0.25608  -9.3502 < 2.2e-16 ***
entero470              0.15255    0.37110   0.4111  0.681011    
female                -0.15740    0.14865  -1.0588  0.289674    
racewhiteYes           0.22617    0.21510   1.0515  0.293037    
racewhiteMissing     -12.56554    0.55961 -22.4541 < 2.2e-16 ***
gichronYes             0.47563    0.67257   0.7072  0.479449    
anim_anyYes            0.38515    0.19939   1.9317  0.053400 .  
gicontactbaseYes       0.65326    0.30661   2.1306  0.033125 *  
gicontactbaseMissing -13.08249    0.76892 -17.0140 < 2.2e-16 ***
rawfood               -0.60878    0.38679  -1.5739  0.115499    
beachBoqueron         -0.65369    0.32352  -2.0206  0.043325 *  
beachEdgewater        -0.40851    0.51479  -0.7936  0.427454    
beachFairhope         -0.28961    0.34083  -0.8497  0.395492    
beachGoddard          -0.51806    0.42344  -1.2235  0.221158    
beachHuntington       -0.31461    0.42178  -0.7459  0.455724    
beachSilver           -0.80380    0.30052  -2.6747  0.007479 ** 
beachWashington Park  -0.64931    0.33560  -1.9348  0.053017 .  
beachWest             -0.19048    0.35518  -0.5363  0.591762    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps5to10 <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6381  -0.3060  -0.2822  -0.2012   2.4745  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.53914    0.24374 -14.520  < 2e-16 ***
entero470              0.61322    0.27192   2.255  0.02412 *  
female                 0.09081    0.14162   0.641  0.52137    
racewhiteYes           0.42383    0.20717   2.046  0.04077 *  
racewhiteMissing       0.75175    0.73599   1.021  0.30706    
gichronYes             0.66343    0.58409   1.136  0.25603    
gichronMissing       -12.41662  734.51360  -0.017  0.98651    
anim_anyYes            0.05353    0.17688   0.303  0.76217    
gicontactbaseYes       0.55388    0.25597   2.164  0.03047 *  
gicontactbaseMissing -12.22128  367.84616  -0.033  0.97350    
rawfood               -0.02753    0.24850  -0.111  0.91179    
beachBoqueron         -0.50485    0.31084  -1.624  0.10434    
beachEdgewater        -0.19928    0.49465  -0.403  0.68704    
beachFairhope         -0.16554    0.38183  -0.434  0.66462    
beachGoddard          -0.18687    0.39996  -0.467  0.64035    
beachHuntington        0.76598    0.29310   2.613  0.00896 ** 
beachSilver           -0.10806    0.23939  -0.451  0.65170    
beachWashington Park   0.06123    0.27966   0.219  0.82669    
beachWest              0.15934    0.32165   0.495  0.62032    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1282.8  on 4886  degrees of freedom
Residual deviance: 1227.5  on 4868  degrees of freedom
AIC: 1667.5

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -3.539142   0.275989 -12.8235  < 2e-16 ***
entero470              0.613223   0.257351   2.3828  0.01718 *  
female                 0.090812   0.139730   0.6499  0.51575    
racewhiteYes           0.423833   0.226272   1.8731  0.06105 .  
racewhiteMissing       0.751747   0.639786   1.1750  0.24000    
gichronYes             0.663431   0.558666   1.1875  0.23502    
gichronMissing       -12.416619   0.651636 -19.0545  < 2e-16 ***
anim_anyYes            0.053528   0.174099   0.3075  0.75849    
gicontactbaseYes       0.553882   0.256603   2.1585  0.03089 *  
gicontactbaseMissing -12.221282   0.405945 -30.1058  < 2e-16 ***
rawfood               -0.027528   0.254764  -0.1081  0.91395    
beachBoqueron         -0.504850   0.332077  -1.5203  0.12844    
beachEdgewater        -0.199283   0.484613  -0.4112  0.68091    
beachFairhope         -0.165540   0.408454  -0.4053  0.68527    
beachGoddard          -0.186866   0.422408  -0.4424  0.65821    
beachHuntington        0.765984   0.308522   2.4827  0.01304 *  
beachSilver           -0.108064   0.237325  -0.4553  0.64886    
beachWashington Park   0.061231   0.286400   0.2138  0.83071    
beachWest              0.159342   0.310248   0.5136  0.60753    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps11plus <- mpreg(diarrheaci10~entero470 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7880  -0.3106  -0.2626  -0.2245   2.4278  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.342322   0.127993 -26.113  < 2e-16 ***
entero470              0.331913   0.162754   2.039  0.04142 *  
female                 0.161851   0.068327   2.369  0.01785 *  
racewhiteYes           0.023840   0.107014   0.223  0.82371    
racewhiteMissing      -0.338722   0.586651  -0.577  0.56368    
gichronYes             0.626903   0.138524   4.526 6.02e-06 ***
gichronMissing       -11.144545 250.653932  -0.044  0.96454    
anim_anyYes            0.246891   0.078767   3.134  0.00172 ** 
gicontactbaseYes       0.723759   0.117715   6.148 7.83e-10 ***
gicontactbaseMissing   0.869706   0.451234   1.927  0.05393 .  
rawfood                0.397635   0.080372   4.947 7.52e-07 ***
beachBoqueron         -0.585191   0.138522  -4.225 2.39e-05 ***
beachEdgewater         0.028191   0.203939   0.138  0.89006    
beachFairhope          0.187146   0.208868   0.896  0.37025    
beachGoddard          -0.436019   0.220500  -1.977  0.04800 *  
beachHuntington        0.523254   0.183253   2.855  0.00430 ** 
beachSilver           -0.295931   0.126405  -2.341  0.01922 *  
beachWashington Park  -0.004094   0.145710  -0.028  0.97759    
beachWest              0.286684   0.143465   1.998  0.04569 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5566.3  on 20797  degrees of freedom
Residual deviance: 5347.1  on 20779  degrees of freedom
AIC: 7145.1

Number of Fisher Scoring iterations: 12



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.3423217   0.1381019 -24.2019 < 2.2e-16 ***
entero470              0.3319128   0.1683458   1.9716  0.048654 *  
female                 0.1618507   0.0640134   2.5284  0.011459 *  
racewhiteYes           0.0238397   0.1103474   0.2160  0.828955    
racewhiteMissing      -0.3387218   0.5893122  -0.5748  0.565444    
gichronYes             0.6269027   0.1363312   4.5984 4.258e-06 ***
gichronMissing       -11.1445446   0.3808220 -29.2644 < 2.2e-16 ***
anim_anyYes            0.2468908   0.0816480   3.0238  0.002496 ** 
gicontactbaseYes       0.7237589   0.1164059   6.2175 5.050e-10 ***
gicontactbaseMissing   0.8697060   0.3733223   2.3296  0.019825 *  
rawfood                0.3976348   0.0820597   4.8457 1.262e-06 ***
beachBoqueron         -0.5851914   0.1497464  -3.9079 9.311e-05 ***
beachEdgewater         0.0281906   0.2102686   0.1341  0.893348    
beachFairhope          0.1871456   0.2074291   0.9022  0.366943    
beachGoddard          -0.4360194   0.2368303  -1.8411  0.065612 .  
beachHuntington        0.5232541   0.1807422   2.8950  0.003791 ** 
beachSilver           -0.2959311   0.1308074  -2.2623  0.023676 *  
beachWashington Park  -0.0040939   0.1553880  -0.0263  0.978981    
beachWest              0.2866835   0.1533531   1.8694  0.061562 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Estimate adjusted CIRs
> # From the overall pooled model and
> # From stratified models
> # --------------------------------------
> 
> # function to get CIR Estimates and CIs from simple stratified models
> getCIR <- function(x) {
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# NOTE: assumes exposure of interest is the first covariate and there are no interactions
+ 	est <- exp(x[2,1])
+ 	se  <- x[2,2]	
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> 
> 
> # bind all of the CIRs together, organized by
> # non-point source vs. point source and then age, then overall
> 
> cir.all <- rbind(getCIR(nps$fit),getCIR(ps$fit),getCIR(overall.fit) )
> 
> cir.age0to4 <- rbind(getCIR(nps0to4$fit),getCIR(ps0to4$fit),getCIR(age0to4$fit) )
> 
> cir.age5to10 <- rbind(getCIR(nps5to10$fit),getCIR(ps5to10$fit),getCIR(age5to10$fit) )
> 
> cir.age11plus <- rbind(getCIR(nps11plus$fit),getCIR(ps11plus$fit),getCIR(age11plus$fit) )
> 
> 	
> colnames(cir.all) <- colnames(cir.age11plus) <- colnames(cir.age5to10) <- colnames(cir.age0to4) <- c("CIR","CIRlb","CIRub")
> rownames(cir.all) <- rownames(cir.age11plus) <- rownames(cir.age5to10) <- rownames(cir.age0to4) <-  c("Non-point source","Point source","Overall")
> 
> # --------------------------------------
> # Number of persons at risk and cases
> # by strata
> # Print results to the log
> # --------------------------------------
> N.all
     n     N
0 1893 44630
1  102  1369
> N.age0to4
    n    N
0 246 3681
1  10  123
> N.age5to10
    n    N
0 304 8219
1  19  279
> N.age11plus
     n     N
0 1322 32042
1   69   944
> N.nps
    n     N
0 706 17077
1  25   463
> N.ps
     n     N
0 1187 27553
1   77   906
> N.nps0to4
   n    N
0 89 1495
1  1   41
> N.nps5to10
    n    N
0 122 3541
1   0   70
> N.nps11plus
    n     N
0 491 11850
1  20   338
> N.ps0to4
    n    N
0 157 2186
1   9   82
> N.ps5to10
    n    N
0 182 4678
1  19  209
> N.ps11plus
    n     N
0 831 20192
1  49   606
> 
> # --------------------------------------
> # Cumulative Incidence Estimates
> # Print results to the log
> # --------------------------------------
> ci.all
                       CI       CIlb       CIub
Entero<=470cce 0.04241542 0.04027895 0.04466521
Entero>470cce  0.07450694 0.05955955 0.09320561
> ci.0to4
                       CI       CIlb       CIub
Entero<=470cce 0.06682967 0.05871434 0.07606667
Entero>470cce  0.08130081 0.04308591 0.15341030
> ci.5to10
                       CI       CIlb       CIub
Entero<=470cce 0.03698747 0.03274154 0.04178401
Entero>470cce  0.06810036 0.04349275 0.10663062
> ci.11plus
                       CI       CIlb       CIub
Entero<=470cce 0.04125835 0.03895339 0.04369970
Entero>470cce  0.07309322 0.05680475 0.09405233
> 
> ci.nps
                       CI       CIlb       CIub
Entero<=470cce 0.04134216 0.03794470 0.04504381
Entero>470cce  0.05399568 0.03309061 0.08810758
> ci.nps0to4
                       CI        CIlb      CIub
Entero<=470cce 0.05953177 0.047857527 0.0740538
Entero>470cce  0.02439024 0.003481409 0.1708745
> ci.nps5to10
                         CI         CIlb         CIub
Entero<=470cce 3.445354e-02 2.824395e-02 4.202836e-02
Entero>470cce  3.059023e-08 2.286486e-08 4.092579e-08
> ci.nps11plus
                      CI       CIlb       CIub
Entero<=470cce 0.0414346 0.03772410 0.04551006
Entero>470cce  0.0591716 0.03659604 0.09567369
> 
> ci.ps
                       CI       CIlb       CIub
Entero<=470cce 0.04308061 0.04037964 0.04596224
Entero>470cce  0.08498896 0.06616522 0.10916798
> ci.ps0to4
                       CI       CIlb       CIub
Entero<=470cce 0.07182068 0.06115950 0.08434028
Entero>470cce  0.10975610 0.05707204 0.21107360
> ci.ps5to10
                       CI       CIlb      CIub
Entero<=470cce 0.03890552 0.03334999 0.0453865
Entero>470cce  0.09090909 0.05851535 0.1412358
> ci.ps11plus
                       CI       CIlb       CIub
Entero<=470cce 0.04115491 0.03746946 0.04520287
Entero>470cce  0.08085809 0.05000855 0.13073826
> 
> 
> # --------------------------------------
> # Cumulative Incidence Ratios
> # Print results to the log
> # --------------------------------------
> cir.all
                      CIR     CIRlb    CIRub
Non-point source 1.287600 0.7778291 2.131461
Point source     1.436990 1.0845935 1.903884
Overall          1.388447 1.0855218 1.775906
> cir.age0to4
                       CIR      CIRlb    CIRub
Non-point source 0.4146873 0.05676497 3.029432
Point source     1.1648064 0.56281193 2.410706
Overall          0.9418797 0.48393872 1.833160
> cir.age5to10
                          CIR        CIRlb        CIRub
Non-point source 3.914194e-07 2.549393e-07 6.009632e-07
Point source     1.846373e+00 1.114955e+00 3.057605e+00
Overall          1.460449e+00 9.103150e-01 2.343047e+00
> cir.age11plus
                      CIR     CIRlb    CIRub
Non-point source 1.323780 0.8021268 2.184685
Point source     1.393631 1.0019571 1.938415
Overall          1.362128 1.0346231 1.793302
> 
> 
> 
> # --------------------------------------
> # save the objects
> # --------------------------------------
> 
> save(
+ 	overall.fit,all.VC,age0to4,age5to10,age11plus,
+ 	nps,nps0to4,nps5to10,nps11plus,
+ 	ps,ps0to4,ps5to10,ps11plus,
+ 	
+ 	hufit,sifit,wpfit,wefit,avfit,bofit,dhfit,edfit,fafit,gdfit,mafit,mbfit,sufit,
+ 	
+ 	N.all,N.age0to4,N.age5to10,N.age11plus,
+ 	N.nps,N.nps0to4,N.nps5to10,N.nps11plus,
+ 	N.ps,N.ps0to4,N.ps5to10,N.ps11plus,
+ 	
+ 	ci.all,ci.0to4,ci.5to10,ci.11plus,
+ 	ci.nps,ci.nps0to4,ci.nps5to10,ci.nps11plus,
+ 	ci.ps,ci.ps0to4,ci.ps5to10,ci.ps11plus,
+ 	
+ 	cir.all,cir.age0to4,cir.age5to10,cir.age11plus,
+ 	
+ 	ps.reri, mf.reri,
+ 
+ 	file="~/dropbox/13beaches/aim1-results/rawoutput/aim1-enteroQPCR-470cce-regs-body.Rdata"
+ 	)
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> proc.time()
   user  system elapsed 
104.486   7.350 113.177 
