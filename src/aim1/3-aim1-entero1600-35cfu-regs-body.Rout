
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> 
> 
> 
> # --------------------------------------
> # 5-aim1-entero1600-35cfu-regs-body.R
> # ben arnold (benarnold@berkeley.edu)
> #
> # description:
> # estimate the association between water
> # quality indicator concentrations and
> # the risk of Diarrhea among swimmers
> # for the 13 beaches study
> #
> # Analyses are conducted for EPA 1600
> # Among Swimmers with Body Immmersion
> #
> # The exposure categories are <=35 and >35 CFU/100ml
> #
> # version 6 (12 aug 2015)
> # cleaned up code by cutting extra lines
> #
> # version 5 (29 jul 2015)
> # added RERI calculations / output.
> #
> # version 4 (10 apr 2015)
> # confirm 10-day follow-up
> #
> # version 3 (8 apr 2015)
> # corrected a small typo (omission of agecat in ps/nps pooled regressions)
> #
> # version 2 (20 mar 2015)
> # calculate CIRs from stratified models 
> # rather than from linear combinations out of 3-way interaction models
> # (after confirming identical results to 3 decimals, it's just cleaner)
> # added saturated models to calculate robust
> # 95% CIs for the cumulative incidence of diarrhea
> #
> # version 1 (18 mar 2015)
> #
> # --------------------------------------
> 
> # --------------------------------------
> # preamble
> # --------------------------------------
> 
> rm(list=ls())
> library(sandwich)
> library(lmtest)
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

> 
> # source the base functions
> source("~/dropbox/13beaches/src/aim1/0-aim1-base-functions.R")
> 
> # --------------------------------------
> # load the and pre-preprocess the 
> # analysis dataset
> # (refer to the base functions script
> # for details on the pre-processing)
> # --------------------------------------
> 
> ad <- preprocess.13beaches("~/dropbox/13beaches/data/final/13beaches-analysis.csv")

Successfully loaded the data
 Total sample size = 88083 

Dropping individuals with GI illness at enrollment
 N = 2025 

Final sample size = 86058 

Subsetting the data to relevant variables and completing final variable pre-processing> 
> # drop individuals with no water quality information
> table(ad$nowq)

    0     1 
84737  1321 
> ad <- subset(ad,nowq==0)
> dim(ad)
[1] 84737    50
> 
> # subset to non-missing exposure categories
> # to make the robust CI calcs work
> table(ad$bodycontact)

   No   Yes 
37496 47241 
> ad <- subset(ad,ad$bodycontact=="Yes")
> 	dim(ad)
[1] 47241    50
> ad <- subset(ad,is.na(ad$entero35)==FALSE)
> 	dim(ad)
[1] 47241    50
> 
> 
> # --------------------------------------
> # Calculate the actual Ns for each cell
> # and store them for plotting and tables
> # --------------------------------------
> 
> # --------------------------------------
> # Summarize 
> # the number of swimmers and number
> # of cumulative incident episodes by
> # Entero 1600 category
> # --------------------------------------
> calcNs <- function(outcome,exposurecat) {
+   n <- tapply(outcome,exposurecat,sum)
+   N <- tapply(outcome,exposurecat,function(x) length(x))
+   cbind(n,N)
+ }
> 
> # overall
> N.all <- calcNs(ad$diarrheaci10,ad$entero35)
> # age stratified
> N.age0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]"],ad$entero35[ad$agestrat=="(0, 4]"] )
> N.age5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]"],ad$entero35[ad$agestrat=="(4, 10]"] )
> N.age11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10"],ad$entero35[ad$agestrat==">10"] )
> # point source vs. non-point source stratified
> N.nps <- calcNs(ad$diarrheaci10[ad$pointsource=="No"], ad$entero35[ad$pointsource=="No"])
> N.ps  <- calcNs(ad$diarrheaci10[ad$pointsource=="Yes"],ad$entero35[ad$pointsource=="Yes"])
> # age and point source stratified
> N.nps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="No"],ad$entero35[ad$agestrat=="(0, 4]" & ad$pointsource=="No"] )
> N.nps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="No"],ad$entero35[ad$agestrat=="(4, 10]" & ad$pointsource=="No"] )
> N.nps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="No"],ad$entero35[ad$agestrat==">10" & ad$pointsource=="No"] )
> 
> N.ps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"] )
> N.ps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"] )
> N.ps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat==">10" & ad$pointsource=="Yes"] )
> 
> 
> 
> # --------------------------------------
> # Calculate unadjusted 
> # Cumulative Incidence Rates
> # and robust 95% CIs using a saturated, 
> # unadjusted model
> # (just using the models to get the robust
> # SEs that account for HH clustering)
> # --------------------------------------
> 
> 
> #### Overall Estimates (pooled over beach type)
> 
> # All Ages
> all.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad)
> 	allci.VC <- cl(ad,fm=all.cifit,cluster=ad$hhid)
> 	allci <- coeftest(all.cifit, allci.VC)
> 	allci

z test of coefficients:

             Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.188289   0.027922 -114.1875 < 2.2e-16 ***
entero35     0.313871   0.066644    4.7097 2.481e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 0 - 4
> age0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat=="(0, 4]",])
> 	age0to4ci.VC <- cl(ad[ad$agestrat=="(0, 4]",],fm=age0to4.cifit,cluster=ad$hhid[ad$agestrat=="(0, 4]"])
> 	age0to4ci <- coeftest(age0to4.cifit, age0to4ci.VC)
> 	age0to4ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -2.768994   0.071706 -38.6161 < 2.2e-16 ***
entero35     0.443858   0.151520   2.9294  0.003396 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 5 - 10
> age5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat=="(4, 10]",])
> 	age5to10ci.VC <- cl(ad[ad$agestrat=="(4, 10]",],fm=age5to10.cifit,cluster=ad$hhid[ad$agestrat=="(4, 10]"])
> 	age5to10ci <- coeftest(age5to10.cifit, age5to10ci.VC)
> 	age5to10ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.357798   0.067392 -49.8247 < 2.2e-16 ***
entero35     0.419611   0.137517   3.0513  0.002278 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages >10
> age11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat==">10",])
> 	age11plusci.VC <- cl(ad[ad$agestrat==">10",],fm=age11plus.cifit,cluster=ad$hhid[ad$agestrat==">10"])
> 	age11plusci <- coeftest(age11plus.cifit, age11plusci.VC)
> 	age11plusci

z test of coefficients:

             Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.207870   0.030717 -104.4325 < 2.2e-16 ***
entero35     0.277889   0.079206    3.5084 0.0004508 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> #### Stratified Estimates by non-point source and point source beach conditions
> 
> # Non-point source - All Ages
> nps.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No",])
> 	npsci.VC <- cl(ad[ad$pointsource=="No",],fm=nps.cifit,cluster=ad$hhid[ad$pointsource=="No"])
> 	npsci <- coeftest(nps.cifit, npsci.VC)
> 	npsci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.172389   0.042572 -74.5190   <2e-16 ***
entero35    -0.272626   0.197607  -1.3796   0.1677    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 0 - 4
> nps0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",])
> 	nps0to4ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],fm=nps0to4.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(0, 4]"])
> 	nps0to4ci <- coeftest(nps0to4.cifit, nps0to4ci.VC)
> 	nps0to4ci

z test of coefficients:

            Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -2.80824    0.10821 -25.9522   <2e-16 ***
entero35     0.10019    0.38343   0.2613   0.7939    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 5 - 10
> nps5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",])
> 	nps5to10ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],fm=nps5to10.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(4, 10]"])
> 	nps5to10ci <- coeftest(nps5to10.cifit, nps5to10ci.VC)
> 	nps5to10ci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.346550   0.096964 -34.5134  < 2e-16 ***
entero35    -1.142086   0.580271  -1.9682  0.04905 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages >10
> nps11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat==">10",])
> 	nps11plusci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat==">10",],fm=nps11plus.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat==">10"])
> 	nps11plusci <- coeftest(nps11plus.cifit, nps11plusci.VC)
> 	nps11plusci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.179353   0.046655 -68.1461   <2e-16 ***
entero35    -0.139780   0.239883  -0.5827   0.5601    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # Point source	- All Ages
> ps.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes",])
> 	psci.VC <- cl(ad[ad$pointsource=="Yes",],fm=ps.cifit,cluster=ad$hhid[ad$pointsource=="Yes"])
> 	psci <- coeftest(ps.cifit, psci.VC)
> 	psci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.200558   0.036979 -86.5513 < 2.2e-16 ***
entero35     0.408331   0.073474   5.5575 2.737e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 0 - 4
> ps0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",])
> 	ps0to4ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],fm=ps0to4.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]"])
> 	ps0to4ci <- coeftest(ps0to4.cifit, ps0to4ci.VC)
> 	ps0to4ci

z test of coefficients:

             Estimate Std. Error z value  Pr(>|z|)    
(Intercept) -2.736381   0.095766 -28.574 < 2.2e-16 ***
entero35     0.478793   0.172039   2.783  0.005385 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 5 - 10
> ps5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",])
> 	ps5to10ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],fm=ps5to10.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]"])
> 	ps5to10ci <- coeftest(ps5to10.cifit, ps5to10ci.VC)
> 	ps5to10ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.369180   0.093552 -36.0141 < 2.2e-16 ***
entero35     0.596591   0.153569   3.8848 0.0001024 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages >10
> ps11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat==">10",])
> 	ps11plusci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat==">10",],fm=ps11plus.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat==">10"])
> 	ps11plusci <- coeftest(ps11plus.cifit, ps11plusci.VC)
> 	ps11plusci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.228469   0.040799 -79.1319 < 2.2e-16 ***
entero35     0.356083   0.086838   4.1005 4.122e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # function to get Estimates and CIs from a linear combination of regression coefficients
> lccalc <- function(lc,x,vcv) {
+ 	# lc : linear combination of coefficients
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# vcv : variance-covariance matrix of coefficients for robust SEs
+ 	est <- exp(t(lc)%*%x[,1])
+ 	se  <- sqrt( t(lc)%*%vcv%*%lc )
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> getCI <- function(fit,vcv) {
+ 	# fit : an object returned from coeftest w/ 2 parameters corresponding to <=35/>35 CFU cumulative incidence
+ 	# vcv : variance-covariance matrix for coefficients in the fit object
+ 	lc1 <- lc2 <- rep(0,nrow(fit))
+ 	lc1[c(1)  ] <- 1
+ 	lc2[c(1,2)] <- 1
+ 	lcs <- list(lc1,lc2)
+ 	res <- t(sapply(lcs,lccalc,x=fit,vcv=vcv))
+ 	colnames(res) <- c("CI","CIlb","CIub")
+ 	rownames(res) <- c("Entero<=35cfu","Entero>35cfu")
+ 	return(res)
+ }
> 
> 
> ci.all    <- getCI(allci,allci.VC)
> ci.0to4   <- getCI(age0to4ci,age0to4ci.VC)
> ci.5to10  <- getCI(age5to10ci,age5to10ci.VC)
> ci.11plus <- getCI(age11plusci,age11plusci.VC)
> 
> ci.nps       <- getCI(npsci,npsci.VC)
> ci.nps0to4   <- getCI(nps0to4ci,nps0to4ci.VC)
> ci.nps5to10  <- getCI(nps5to10ci,nps5to10ci.VC)
> ci.nps11plus <- getCI(nps11plusci,nps11plusci.VC)
> 
> ci.ps       <- getCI(psci,psci.VC)
> ci.ps0to4   <- getCI(ps0to4ci,ps0to4ci.VC)
> ci.ps5to10  <- getCI(ps5to10ci,ps5to10ci.VC)
> ci.ps11plus <- getCI(ps11plusci,nps11plusci.VC)
> 
> 
> 
> # --------------------------------------
> # esimate risk of Diarrhea associated
> # with exposure to EPA 1600 above/below 35 CFU/100ml
> # Body Immersion
> # All ages
> # --------------------------------------
> 
> 
> 
> # tests of interaction by environmental conditions for Avalon and Doheny
> av.h.noint <-glm(diarrheaci10~ entero35+groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> av.h <-glm(diarrheaci10~ entero35*groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> 	lrtest(av.h.noint,av.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero35 * groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df Chisq Pr(>Chisq)  
1  20 -777.01                      
2  21 -774.54  1 4.944    0.02618 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> dh.h.noint <-glm(diarrheaci10~ entero35+berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> dh.h <-glm(diarrheaci10~ entero35*berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> 	lrtest(dh.h.noint,dh.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero35 * berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df  Chisq Pr(>Chisq)  
1  19 -723.27                       
2  20 -721.87  1 2.7967    0.09446 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> # --------------------------------------
> # Freshwater beaches
> 
> # Huntington
> hufit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Huntington",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8225  -0.4824  -0.4424  -0.3165   2.2641  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)      -2.995e+00  6.010e-01  -4.984 6.24e-07 ***
entero35          1.915e-01  2.544e-01   0.753   0.4516    
agecat5-14        6.269e-03  3.827e-01   0.016   0.9869    
agecat15-24      -1.124e+00  6.677e-01  -1.684   0.0922 .  
agecat25-34      -1.670e-01  4.726e-01  -0.353   0.7238    
agecat35-44       3.721e-01  4.202e-01   0.885   0.3759    
agecat45-54      -2.840e-01  5.606e-01  -0.507   0.6124    
agecat55-64      -7.817e-01  1.057e+00  -0.739   0.4598    
agecat65-74      -1.535e+01  1.301e+03  -0.012   0.9906    
agecat75+        -1.515e+01  3.468e+03  -0.004   0.9965    
agecatMissing     8.816e-01  7.861e-01   1.121   0.2621    
female            1.684e-01  2.342e-01   0.719   0.4719    
racewhiteYes      4.174e-01  4.705e-01   0.887   0.3751    
racewhiteMissing -1.439e+01  3.468e+03  -0.004   0.9967    
gichronYes       -1.517e+01  9.299e+02  -0.016   0.9870    
anim_anyYes       2.523e-01  3.458e-01   0.730   0.4656    
gicontactbaseYes  1.446e-01  7.220e-01   0.200   0.8413    
rawfood           4.091e-01  3.615e-01   1.132   0.2577    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 340.98  on 740  degrees of freedom
Residual deviance: 322.22  on 723  degrees of freedom
AIC: 506.22

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                    Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.9952760   0.6385812  -4.6905 2.725e-06 ***
entero35           0.1915343   0.2883168   0.6643   0.50649    
agecat5-14         0.0062686   0.3722546   0.0168   0.98656    
agecat15-24       -1.1243661   0.6723721  -1.6722   0.09448 .  
agecat25-34       -0.1670200   0.4889526  -0.3416   0.73266    
agecat35-44        0.3720959   0.4069550   0.9143   0.36054    
agecat45-54       -0.2840287   0.5704661  -0.4979   0.61856    
agecat55-64       -0.7816672   1.0685549  -0.7315   0.46446    
agecat65-74      -15.3508075   0.6177833 -24.8482 < 2.2e-16 ***
agecat75+        -15.1454048   1.0771118 -14.0611 < 2.2e-16 ***
agecatMissing      0.8815881   0.8785539   1.0035   0.31564    
female             0.1684414   0.2177656   0.7735   0.43923    
racewhiteYes       0.4173534   0.5704819   0.7316   0.46442    
racewhiteMissing -14.3925900   1.2180921 -11.8157 < 2.2e-16 ***
gichronYes       -15.1695709   0.5209419 -29.1195 < 2.2e-16 ***
anim_anyYes        0.2523009   0.4455815   0.5662   0.57124    
gicontactbaseYes   0.1445831   0.6709879   0.2155   0.82939    
rawfood            0.4091165   0.4621125   0.8853   0.37599    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Silver
> sifit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Silver",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7081  -0.3184  -0.2778  -0.2558   2.5046  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.32250    0.28741 -11.560  < 2e-16 ***
entero35                0.13667    0.13036   1.048  0.29443    
agecat5-14             -0.57427    0.21546  -2.665  0.00769 ** 
agecat15-24            -0.71103    0.24567  -2.894  0.00380 ** 
agecat25-34            -0.34823    0.25930  -1.343  0.17927    
agecat35-44            -0.04906    0.22494  -0.218  0.82735    
agecat45-54            -0.35907    0.28604  -1.255  0.20936    
agecat55-64            -0.39101    0.41890  -0.933  0.35060    
agecat65-74           -14.45946  542.51235  -0.027  0.97874    
agecat75+             -14.85577 1955.27567  -0.008  0.99394    
agecatMissing          -0.79765    0.44510  -1.792  0.07312 .  
female                  0.16511    0.12990   1.271  0.20372    
racewhiteYes            0.09714    0.20875   0.465  0.64170    
racewhiteMissing        0.26864    1.02334   0.263  0.79292    
gichronYes              0.56442    0.32905   1.715  0.08629 .  
gichronMissing        -14.06593 1082.89691  -0.013  0.98964    
anim_anyYes             0.37954    0.18426   2.060  0.03942 *  
gicontactbaseYes        0.20327    0.26872   0.756  0.44939    
gicontactbaseMissing    1.09203    1.01284   1.078  0.28095    
rawfood                 0.13630    0.17254   0.790  0.42954    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1520.8  on 5553  degrees of freedom
Residual deviance: 1485.9  on 5534  degrees of freedom
AIC: 2011.9

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.322504   0.306647 -10.8349 < 2.2e-16 ***
entero35               0.136673   0.141668   0.9647  0.334675    
agecat5-14            -0.574269   0.222018  -2.5866  0.009693 ** 
agecat15-24           -0.711027   0.250449  -2.8390  0.004525 ** 
agecat25-34           -0.348234   0.273514  -1.2732  0.202952    
agecat35-44           -0.049060   0.227411  -0.2157  0.829195    
agecat45-54           -0.359073   0.286902  -1.2516  0.210733    
agecat55-64           -0.391014   0.418872  -0.9335  0.350565    
agecat65-74          -14.459460   0.269264 -53.7000 < 2.2e-16 ***
agecat75+            -14.855770   0.693097 -21.4339 < 2.2e-16 ***
agecatMissing         -0.797647   0.560511  -1.4231  0.154716    
female                 0.165107   0.129983   1.2702  0.204009    
racewhiteYes           0.097137   0.247162   0.3930  0.694312    
racewhiteMissing       0.268644   0.857343   0.3133  0.754019    
gichronYes             0.564420   0.325356   1.7348  0.082781 .  
gichronMissing       -14.065934   0.578740 -24.3044 < 2.2e-16 ***
anim_anyYes            0.379537   0.210732   1.8010  0.071697 .  
gicontactbaseYes       0.203267   0.267093   0.7610  0.446636    
gicontactbaseMissing   1.092031   0.723250   1.5099  0.131071    
rawfood                0.136304   0.176495   0.7723  0.439949    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Washington Park
> wpfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Washington Park",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8909  -0.3528  -0.3026  -0.2517   2.6015  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.1299     0.3679  -8.507  < 2e-16 ***
entero35                0.2434     0.1882   1.293  0.19599    
agecat5-14             -0.5285     0.3110  -1.699  0.08929 .  
agecat15-24            -1.2913     0.4849  -2.663  0.00775 ** 
agecat25-34             0.2224     0.3289   0.676  0.49886    
agecat35-44            -0.2040     0.3405  -0.599  0.54911    
agecat45-54            -0.2808     0.3906  -0.719  0.47227    
agecat55-64             0.5578     0.4018   1.388  0.16505    
agecat65-74            -0.2970     1.0349  -0.287  0.77415    
agecat75+             -14.5569  1408.6727  -0.010  0.99176    
agecatMissing          -1.7724     1.0338  -1.714  0.08645 .  
female                  0.1042     0.1805   0.577  0.56377    
racewhiteYes            0.1094     0.2484   0.441  0.65952    
racewhiteMissing      -11.8345  1350.9720  -0.009  0.99301    
gichronYes              0.4908     0.4629   1.060  0.28904    
gichronMissing        -12.9908  3467.8586  -0.004  0.99701    
anim_anyYes             0.3175     0.2576   1.232  0.21780    
gicontactbaseYes        0.7181     0.2904   2.473  0.01340 *  
gicontactbaseMissing  -13.6801  1058.3628  -0.013  0.98969    
rawfood                -0.2022     0.2816  -0.718  0.47266    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 733.22  on 2311  degrees of freedom
Residual deviance: 691.42  on 2292  degrees of freedom
AIC: 983.42

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.12993    0.36424  -8.5930 < 2.2e-16 ***
entero35               0.24337    0.21631   1.1251  0.260549    
agecat5-14            -0.52848    0.30726  -1.7200  0.085434 .  
agecat15-24           -1.29126    0.47330  -2.7282  0.006368 ** 
agecat25-34            0.22240    0.30590   0.7270  0.467211    
agecat35-44           -0.20397    0.33069  -0.6168  0.537380    
agecat45-54           -0.28076    0.36799  -0.7630  0.445487    
agecat55-64            0.55779    0.36915   1.5110  0.130788    
agecat65-74           -0.29696    1.01416  -0.2928  0.769662    
agecat75+            -14.55688    0.58389 -24.9310 < 2.2e-16 ***
agecatMissing         -1.77240    1.00736  -1.7594  0.078502 .  
female                 0.10421    0.16718   0.6233  0.533061    
racewhiteYes           0.10943    0.26114   0.4191  0.675169    
racewhiteMissing     -11.83447    0.88275 -13.4064 < 2.2e-16 ***
gichronYes             0.49076    0.52290   0.9385  0.347970    
gichronMissing       -12.99083    1.10387 -11.7684 < 2.2e-16 ***
anim_anyYes            0.31746    0.26624   1.1924  0.233103    
gicontactbaseYes       0.71807    0.29791   2.4104  0.015935 *  
gicontactbaseMissing -13.68006    0.70425 -19.4251 < 2.2e-16 ***
rawfood               -0.20223    0.26763  -0.7556  0.449869    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # West
> wefit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="West",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9902  -0.4235  -0.3336  -0.2615   2.4568  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.31108    0.38855  -8.522  < 2e-16 ***
entero35                0.36414    0.21493   1.694  0.09022 .  
agecat5-14             -0.62114    0.33247  -1.868  0.06173 .  
agecat15-24            -0.79684    0.33165  -2.403  0.01628 *  
agecat25-34            -0.06450    0.33021  -0.195  0.84514    
agecat35-44            -0.21125    0.34719  -0.608  0.54289    
agecat45-54            -1.38325    0.53376  -2.591  0.00956 ** 
agecat55-64           -14.92987  597.85892  -0.025  0.98008    
agecat65-74            -0.03303    1.04129  -0.032  0.97470    
agecat75+             -15.33975 2443.85429  -0.006  0.99499    
agecatMissing         -14.58372 1652.85582  -0.009  0.99296    
female                  0.10837    0.18255   0.594  0.55276    
racewhiteYes            0.31858    0.24412   1.305  0.19189    
racewhiteMissing        0.69371    0.74750   0.928  0.35339    
gichronYes              1.06589    0.47082   2.264  0.02358 *  
gichronMissing        -15.26546 3467.85855  -0.004  0.99649    
anim_anyYes             0.79204    0.26180   3.025  0.00248 ** 
gicontactbaseYes        1.37926    0.33978   4.059 4.92e-05 ***
gicontactbaseMissing    1.52014    0.59989   2.534  0.01128 *  
rawfood                 0.67612    0.23889   2.830  0.00465 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 645.05  on 1649  degrees of freedom
Residual deviance: 582.78  on 1630  degrees of freedom
AIC: 872.78

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.311082   0.404170  -8.1923 2.563e-16 ***
entero35               0.364137   0.247008   1.4742  0.140430    
agecat5-14            -0.621142   0.339358  -1.8303  0.067198 .  
agecat15-24           -0.796837   0.334095  -2.3851  0.017076 *  
agecat25-34           -0.064499   0.315637  -0.2043  0.838083    
agecat35-44           -0.211251   0.331767  -0.6367  0.524291    
agecat45-54           -1.383246   0.516392  -2.6787  0.007391 ** 
agecat55-64          -14.929871   0.392973 -37.9921 < 2.2e-16 ***
agecat65-74           -0.033029   0.880278  -0.0375  0.970069    
agecat75+            -15.339752   0.778837 -19.6957 < 2.2e-16 ***
agecatMissing        -14.583716   0.642858 -22.6858 < 2.2e-16 ***
female                 0.108368   0.166176   0.6521  0.514318    
racewhiteYes           0.318581   0.244954   1.3006  0.193404    
racewhiteMissing       0.693710   0.817739   0.8483  0.396256    
gichronYes             1.065891   0.339468   3.1399  0.001690 ** 
gichronMissing       -15.265464   1.072438 -14.2344 < 2.2e-16 ***
anim_anyYes            0.792036   0.265938   2.9783  0.002899 ** 
gicontactbaseYes       1.379256   0.342807   4.0234 5.736e-05 ***
gicontactbaseMissing   1.520137   0.409834   3.7092  0.000208 ***
rawfood                0.676119   0.266094   2.5409  0.011057 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # --------------------------------------
> # Marine beaches
> 
> # Avalon
> avfit <- mpreg(diarrheaci10~entero35 +groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Avalon",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0590  -0.3563  -0.2945  -0.2582   2.3222  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   -2.26815    0.26324  -8.616  < 2e-16 ***
entero35                       0.21647    0.14451   1.498  0.13416    
groundwaterAbove median flow  -0.17979    0.14326  -1.255  0.20947    
agecat5-14                    -1.07237    0.23605  -4.543 5.55e-06 ***
agecat15-24                   -1.19096    0.30515  -3.903 9.51e-05 ***
agecat25-34                   -0.75533    0.28531  -2.647  0.00811 ** 
agecat35-44                   -0.43016    0.24530  -1.754  0.07950 .  
agecat45-54                   -0.76809    0.27227  -2.821  0.00479 ** 
agecat55-64                   -1.21180    0.38942  -3.112  0.00186 ** 
agecat65-74                   -1.07771    0.73512  -1.466  0.14264    
agecat75+                    -14.10753  576.14169  -0.024  0.98046    
agecatMissing                -14.04117  769.03638  -0.018  0.98543    
female                        -0.06032    0.14007  -0.431  0.66675    
racewhiteYes                   0.02842    0.16699   0.170  0.86484    
racewhiteMissing              -0.67721    0.72290  -0.937  0.34887    
gichronYes                     0.81844    0.33100   2.473  0.01341 *  
anim_anyYes                    0.11681    0.16102   0.725  0.46818    
gicontactbaseYes               0.62592    0.22283   2.809  0.00497 ** 
gicontactbaseMissing          -0.36207    1.00478  -0.360  0.71859    
rawfood                        0.31376    0.16572   1.893  0.05832 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1194.7  on 3742  degrees of freedom
Residual deviance: 1142.0  on 3723  degrees of freedom
AIC: 1594

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                               Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)                   -2.268146   0.289530  -7.8339 4.730e-15 ***
entero35                       0.216470   0.160252   1.3508  0.176756    
groundwaterAbove median flow  -0.179792   0.162016  -1.1097  0.267121    
agecat5-14                    -1.072372   0.239329  -4.4807 7.438e-06 ***
agecat15-24                   -1.190956   0.303798  -3.9202 8.847e-05 ***
agecat25-34                   -0.755332   0.267692  -2.8216  0.004778 ** 
agecat35-44                   -0.430159   0.241655  -1.7801  0.075068 .  
agecat45-54                   -0.768091   0.276600  -2.7769  0.005488 ** 
agecat55-64                   -1.211802   0.374508  -3.2357  0.001213 ** 
agecat65-74                   -1.077707   0.719023  -1.4988  0.133913    
agecat75+                    -14.107530   0.345001 -40.8913 < 2.2e-16 ***
agecatMissing                -14.041168   0.462122 -30.3841 < 2.2e-16 ***
female                        -0.060316   0.133516  -0.4517  0.651450    
racewhiteYes                   0.028424   0.184286   0.1542  0.877421    
racewhiteMissing              -0.677208   0.675166  -1.0030  0.315849    
gichronYes                     0.818443   0.321493   2.5458  0.010904 *  
anim_anyYes                    0.116807   0.177666   0.6575  0.510890    
gicontactbaseYes               0.625924   0.240630   2.6012  0.009290 ** 
gicontactbaseMissing          -0.362067   0.987732  -0.3666  0.713944    
rawfood                        0.313756   0.163818   1.9153  0.055458 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Boqueron
> bofit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Boqueron",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1644  -0.2482  -0.2235  -0.2059   2.5027  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.16344    0.17692 -17.880  < 2e-16 ***
entero35                     NA         NA      NA       NA    
agecat5-14             -0.95211    0.21102  -4.512 6.43e-06 ***
agecat15-24            -0.66627    0.20006  -3.330 0.000868 ***
agecat25-34            -0.52678    0.19673  -2.678 0.007414 ** 
agecat35-44            -0.77023    0.21237  -3.627 0.000287 ***
agecat45-54            -0.75823    0.23181  -3.271 0.001072 ** 
agecat55-64            -0.61457    0.28480  -2.158 0.030938 *  
agecat65-74            -0.95120    0.47525  -2.001 0.045343 *  
agecat75+             -13.37797  321.23614  -0.042 0.966781    
agecatMissing          -0.72156    0.52458  -1.375 0.168978    
female                  0.06756    0.10792   0.626 0.531275    
racewhiteYes            0.82688    0.58167   1.422 0.155151    
racewhiteMissing        2.33860    0.71994   3.248 0.001161 ** 
gichronYes              0.53441    0.20330   2.629 0.008574 ** 
gichronMissing        -12.44848 2103.36254  -0.006 0.995278    
anim_anyYes             0.21016    0.10955   1.918 0.055064 .  
gicontactbaseYes        0.94758    0.17537   5.403 6.54e-08 ***
gicontactbaseMissing  -12.66941 1204.77312  -0.011 0.991610    
rawfood                 0.31851    0.13914   2.289 0.022072 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2487.4  on 11878  degrees of freedom
Residual deviance: 2402.4  on 11860  degrees of freedom
AIC: 3148.4

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.163437   0.185180 -17.0831 < 2.2e-16 ***
agecat5-14            -0.952113   0.207684  -4.5844 4.552e-06 ***
agecat15-24           -0.666267   0.206727  -3.2229 0.0012689 ** 
agecat25-34           -0.526778   0.188029  -2.8016 0.0050854 ** 
agecat35-44           -0.770235   0.210440  -3.6601 0.0002521 ***
agecat45-54           -0.758231   0.235697  -3.2170 0.0012955 ** 
agecat55-64           -0.614566   0.282748  -2.1736 0.0297389 *  
agecat65-74           -0.951199   0.470422  -2.0220 0.0431749 *  
agecat75+            -13.377974   0.232820 -57.4605 < 2.2e-16 ***
agecatMissing         -0.721560   0.518054  -1.3928 0.1636718    
female                 0.067562   0.101737   0.6641 0.5066367    
racewhiteYes           0.826884   0.707753   1.1683 0.2426769    
racewhiteMissing       2.338603   0.604465   3.8689 0.0001093 ***
gichronYes             0.534407   0.203199   2.6300 0.0085393 ** 
gichronMissing       -12.448480   1.020161 -12.2025 < 2.2e-16 ***
anim_anyYes            0.210158   0.122222   1.7195 0.0855285 .  
gicontactbaseYes       0.947576   0.185077   5.1199 3.057e-07 ***
gicontactbaseMissing -12.669408   0.612171 -20.6959 < 2.2e-16 ***
rawfood                0.318506   0.142677   2.2324 0.0255915 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Doheny
> dhfit <- mpreg(diarrheaci10~entero35 +berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Doheny",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7461  -0.3221  -0.2641  -0.2383   2.6214  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.70577    0.24124 -11.216  < 2e-16 ***
entero35               0.29432    0.35744   0.823 0.410266    
bermOpen              -0.14328    0.20496  -0.699 0.484518    
agecat5-14            -0.89510    0.23061  -3.881 0.000104 ***
agecat15-24           -0.82918    0.31482  -2.634 0.008442 ** 
agecat25-34           -0.43411    0.29429  -1.475 0.140187    
agecat35-44           -0.43193    0.26446  -1.633 0.102414    
agecat45-54           -0.49820    0.29914  -1.665 0.095827 .  
agecat55-64           -1.90999    0.73552  -2.597 0.009410 ** 
agecat65-74           -0.28268    1.02060  -0.277 0.781802    
agecatMissing        -13.87502  557.72002  -0.025 0.980152    
female                -0.02391    0.15418  -0.155 0.876748    
racewhiteYes           0.20301    0.17124   1.186 0.235803    
racewhiteMissing       0.06295    0.59644   0.106 0.915947    
gichronYes             0.95391    0.39297   2.427 0.015205 *  
anim_anyYes           -0.14297    0.19512  -0.733 0.463716    
gicontactbaseYes       0.50991    0.30205   1.688 0.091375 .  
gicontactbaseMissing   0.78292    0.45682   1.714 0.086552 .  
rawfood                0.21583    0.18883   1.143 0.253066    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1125.4  on 4149  degrees of freedom
Residual deviance: 1088.5  on 4131  degrees of freedom
AIC: 1484.5

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.705771   0.236662 -11.4331 < 2.2e-16 ***
entero35               0.294325   0.379795   0.7750  0.438365    
bermOpen              -0.143279   0.240631  -0.5954  0.551557    
agecat5-14            -0.895100   0.224214  -3.9922 6.547e-05 ***
agecat15-24           -0.829180   0.306361  -2.7065  0.006799 ** 
agecat25-34           -0.434107   0.277614  -1.5637  0.117886    
agecat35-44           -0.431929   0.251858  -1.7150  0.086350 .  
agecat45-54           -0.498203   0.284215  -1.7529  0.079617 .  
agecat55-64           -1.909985   0.723924  -2.6384  0.008330 ** 
agecat65-74           -0.282677   0.978720  -0.2888  0.772717    
agecatMissing        -13.875016   0.379152 -36.5949 < 2.2e-16 ***
female                -0.023913   0.158693  -0.1507  0.880224    
racewhiteYes           0.203015   0.186719   1.0873  0.276917    
racewhiteMissing       0.062948   0.572975   0.1099  0.912519    
gichronYes             0.953914   0.370765   2.5728  0.010087 *  
anim_anyYes           -0.142974   0.208752  -0.6849  0.493406    
gicontactbaseYes       0.509912   0.304214   1.6762  0.093707 .  
gicontactbaseMissing   0.782925   0.387015   2.0230  0.043075 *  
rawfood                0.215825   0.199109   1.0840  0.278385    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Edgewater
> edfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Edgewater",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7752  -0.3736  -0.3094  -0.2571   2.3384  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.78287    0.52182  -5.333 9.66e-08 ***
entero35            0.72624    0.42794   1.697   0.0897 .  
agecat5-14         -0.92666    0.60859  -1.523   0.1278    
agecat15-24        -0.25656    0.54800  -0.468   0.6397    
agecat25-34        -0.34871    0.56270  -0.620   0.5354    
agecat35-44        -0.71417    0.64046  -1.115   0.2648    
agecat45-54         0.24995    0.61920   0.404   0.6865    
agecat55-64       -15.72771 1576.95495  -0.010   0.9920    
agecat65-74         1.39080    1.12972   1.231   0.2183    
agecat75+         -15.98573 5717.53216  -0.003   0.9978    
agecatMissing     -15.81014 1295.50547  -0.012   0.9903    
female             -0.08897    0.31199  -0.285   0.7755    
racewhiteYes        0.29991    0.37689   0.796   0.4262    
gichronYes          0.97558    0.74849   1.303   0.1924    
gichronMissing    -16.37072 5717.53217  -0.003   0.9977    
anim_anyYes         0.16610    0.37238   0.446   0.6556    
gicontactbaseYes    0.73370    0.54002   1.359   0.1743    
rawfood            -0.25047    0.43313  -0.578   0.5631    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 242.47  on 720  degrees of freedom
Residual deviance: 224.34  on 703  degrees of freedom
AIC: 346.34

Number of Fisher Scoring iterations: 16



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                  Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.78287    0.51717  -5.3809  7.41e-08 ***
entero35           0.72623    0.41598   1.7458   0.08084 .  
agecat5-14        -0.92666    0.59985  -1.5448   0.12239    
agecat15-24       -0.25656    0.53853  -0.4764   0.63378    
agecat25-34       -0.34871    0.56488  -0.6173   0.53702    
agecat35-44       -0.71417    0.63142  -1.1311   0.25803    
agecat45-54        0.24995    0.59146   0.4226   0.67259    
agecat55-64      -15.72771    0.53270 -29.5244 < 2.2e-16 ***
agecat65-74        1.39080    0.92540   1.5029   0.13286    
agecat75+        -15.98573    1.08305 -14.7599 < 2.2e-16 ***
agecatMissing    -15.81014    0.60220 -26.2538 < 2.2e-16 ***
female            -0.08897    0.30824  -0.2886   0.77286    
racewhiteYes       0.29991    0.38852   0.7719   0.44015    
gichronYes         0.97558    0.61360   1.5899   0.11185    
gichronMissing   -16.37072    1.19924 -13.6509 < 2.2e-16 ***
anim_anyYes        0.16610    0.38260   0.4341   0.66418    
gicontactbaseYes   0.73370    0.52042   1.4098   0.15859    
rawfood           -0.25047    0.42447  -0.5901   0.55514    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Fairhope
> fafit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Fairhope",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9813  -0.3575  -0.3215  -0.2936   2.1376  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.6708     0.4185  -6.383 1.74e-10 ***
entero35                0.2195     0.2949   0.744  0.45676    
agecat5-14             -0.5749     0.3733  -1.540  0.12348    
agecat15-24            -0.6238     0.5310  -1.175  0.24009    
agecat25-34            -0.4529     0.4747  -0.954  0.34000    
agecat35-44            -0.4867     0.5849  -0.832  0.40539    
agecat45-54            -0.5134     0.6484  -0.792  0.42852    
agecat55-64            -0.2167     1.0522  -0.206  0.83685    
agecat65-74             0.3218     1.0439   0.308  0.75791    
agecat75+             -12.8354   902.0943  -0.014  0.98865    
female                  0.2832     0.2876   0.984  0.32487    
racewhiteYes           -0.2435     0.3417  -0.712  0.47622    
gichronYes              0.6374     1.0273   0.620  0.53496    
anim_anyYes             0.1639     0.3483   0.471  0.63798    
gicontactbaseYes        1.3357     0.4583   2.914  0.00356 ** 
gicontactbaseMissing  -12.1716  1275.7543  -0.010  0.99239    
rawfood                 0.1811     0.3847   0.471  0.63775    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 281.8  on 807  degrees of freedom
Residual deviance: 269.2  on 791  degrees of freedom
AIC: 405.2

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.67081    0.47279  -5.6491 1.613e-08 ***
entero35               0.21949    0.34626   0.6339   0.52616    
agecat5-14            -0.57494    0.37554  -1.5310   0.12577    
agecat15-24           -0.62382    0.52373  -1.1911   0.23361    
agecat25-34           -0.45290    0.45514  -0.9951   0.31969    
agecat35-44           -0.48667    0.52993  -0.9184   0.35843    
agecat45-54           -0.51336    0.64221  -0.7994   0.42407    
agecat55-64           -0.21667    1.11808  -0.1938   0.84634    
agecat65-74            0.32176    0.95911   0.3355   0.73726    
agecat75+            -12.83538    0.79699 -16.1049 < 2.2e-16 ***
female                 0.28317    0.28699   0.9867   0.32380    
racewhiteYes          -0.24346    0.33431  -0.7282   0.46647    
gichronYes             0.63737    0.97356   0.6547   0.51267    
anim_anyYes            0.16390    0.36142   0.4535   0.65019    
gicontactbaseYes       1.33574    0.59145   2.2584   0.02392 *  
gicontactbaseMissing -12.17164    1.56203  -7.7922 6.586e-15 ***
rawfood                0.18114    0.45261   0.4002   0.68900    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Goddard
> gdfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Goddard",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6316  -0.3231  -0.2572  -0.2178   2.6918  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.80169    0.42465  -6.598 4.18e-11 ***
entero35          -15.57235 4287.71940  -0.004   0.9971    
agecat5-14         -0.85574    0.47324  -1.808   0.0706 .  
agecat15-24        -0.90211    0.60714  -1.486   0.1373    
agecat25-34        -0.35031    0.48560  -0.721   0.4707    
agecat35-44        -0.42100    0.49259  -0.855   0.3927    
agecat45-54        -2.10613    1.06163  -1.984   0.0473 *  
agecat55-64        -1.59474    1.06344  -1.500   0.1337    
agecat65-74        -0.29443    1.07299  -0.274   0.7838    
agecat75+         -16.75499 5435.23253  -0.003   0.9975    
agecatMissing     -16.70007 2844.73571  -0.006   0.9953    
female              0.19936    0.31837   0.626   0.5312    
racewhiteYes        0.17961    0.35283   0.509   0.6107    
racewhiteMissing    0.18154 7238.21886   0.000   1.0000    
gichronYes          0.91415    0.75170   1.216   0.2239    
anim_anyYes        -0.08405    0.35140  -0.239   0.8110    
gicontactbaseYes  -16.09509 1257.48999  -0.013   0.9898    
rawfood             0.40149    0.36016   1.115   0.2650    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 270.47  on 1050  degrees of freedom
Residual deviance: 251.95  on 1033  degrees of freedom
AIC: 371.95

Number of Fisher Scoring iterations: 17



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.801689   0.480163  -5.8349 5.383e-09 ***
entero35         -15.572351   1.086129 -14.3375 < 2.2e-16 ***
agecat5-14        -0.855744   0.457982  -1.8685   0.06169 .  
agecat15-24       -0.902106   0.587525  -1.5354   0.12468    
agecat25-34       -0.350308   0.416662  -0.8407   0.40049    
agecat35-44       -0.421001   0.466179  -0.9031   0.36648    
agecat45-54       -2.106131   1.076628  -1.9562   0.05044 .  
agecat55-64       -1.594738   1.075975  -1.4821   0.13831    
agecat65-74       -0.294432   1.067783  -0.2757   0.78275    
agecat75+        -16.754987   0.745061 -22.4881 < 2.2e-16 ***
agecatMissing    -16.700068   0.625930 -26.6804 < 2.2e-16 ***
female             0.199357   0.289056   0.6897   0.49039    
racewhiteYes       0.179615   0.396129   0.4534   0.65024    
racewhiteMissing   0.181544   1.176307   0.1543   0.87735    
gichronYes         0.914154   0.695975   1.3135   0.18902    
anim_anyYes       -0.084052   0.409199  -0.2054   0.83726    
gicontactbaseYes -16.095094   0.298497 -53.9205 < 2.2e-16 ***
rawfood            0.401488   0.397709   1.0095   0.31273    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Warning message:
glm.fit: fitted rates numerically 0 occurred 
> 
> # Malibu
> mafit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Malibu",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6956  -0.3410  -0.2986  -0.2818   2.5685  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.77975    0.29394  -9.457  < 2e-16 ***
entero35          -14.31121  688.80419  -0.021  0.98342    
agecat5-14         -0.47024    0.31529  -1.491  0.13584    
agecat15-24        -0.42590    0.35777  -1.190  0.23388    
agecat25-34        -0.37091    0.34970  -1.061  0.28884    
agecat35-44        -0.06453    0.33115  -0.195  0.84550    
agecat45-54        -0.53674    0.40409  -1.328  0.18409    
agecat55-64        -0.55038    0.56960  -0.966  0.33392    
agecat65-74       -14.70227  735.70107  -0.020  0.98406    
agecat75+         -14.86920 1642.22326  -0.009  0.99278    
female              0.03592    0.18290   0.196  0.84428    
racewhiteYes        0.10362    0.19386   0.534  0.59300    
racewhiteMissing   -1.03485    0.72437  -1.429  0.15311    
gichronYes          1.15622    0.42731   2.706  0.00681 ** 
anim_anyYes        -0.14576    0.23548  -0.619  0.53591    
gicontactbaseYes    0.10014    0.42125   0.238  0.81210    
rawfood             0.26905    0.21468   1.253  0.21011    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 741.11  on 2501  degrees of freedom
Residual deviance: 720.37  on 2485  degrees of freedom
AIC: 1000.4

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.779751   0.303990  -9.1442 < 2.2e-16 ***
entero35         -14.311210   0.289019 -49.5166 < 2.2e-16 ***
agecat5-14        -0.470245   0.319529  -1.4717  0.141107    
agecat15-24       -0.425899   0.355853  -1.1968  0.231369    
agecat25-34       -0.370914   0.345806  -1.0726  0.283448    
agecat35-44       -0.064527   0.311320  -0.2073  0.835799    
agecat45-54       -0.536744   0.399192  -1.3446  0.178762    
agecat55-64       -0.550378   0.551483  -0.9980  0.318282    
agecat65-74      -14.702272   0.400090 -36.7475 < 2.2e-16 ***
agecat75+        -14.869199   0.673788 -22.0681 < 2.2e-16 ***
female             0.035924   0.179394   0.2002  0.841285    
racewhiteYes       0.103618   0.209514   0.4946  0.620909    
racewhiteMissing  -1.034852   0.721892  -1.4335  0.151707    
gichronYes         1.156217   0.418322   2.7639  0.005711 ** 
anim_anyYes       -0.145762   0.233621  -0.6239  0.532677    
gicontactbaseYes   0.100138   0.430173   0.2328  0.815927    
rawfood            0.269052   0.223235   1.2052  0.228110    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Mission Bay
> mbfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Mission Bay",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.75621  -0.27976  -0.23025  -0.00006   2.52071  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.65933    0.21876 -12.156  < 2e-16 ***
entero35               -0.33712    0.29371  -1.148  0.25104    
agecat5-14             -0.63391    0.23336  -2.716  0.00660 ** 
agecat15-24            -0.61961    0.35605  -1.740  0.08182 .  
agecat25-34            -0.29670    0.29876  -0.993  0.32066    
agecat35-44            -0.58144    0.34094  -1.705  0.08812 .  
agecat45-54            -0.06302    0.39197  -0.161  0.87227    
agecat55-64           -17.30053 2476.68775  -0.007  0.99443    
agecat65-74           -17.29094 4189.72172  -0.004  0.99671    
agecat75+             -17.34076 7680.10589  -0.002  0.99820    
agecatMissing          -1.50206    1.01769  -1.476  0.13996    
female                 -0.08666    0.17463  -0.496  0.61973    
racewhiteYes            0.71143    0.20502   3.470  0.00052 ***
racewhiteMissing      -16.97583  441.42784  -0.038  0.96932    
gichronYes              0.67207    0.52120   1.289  0.19723    
anim_anyYes             0.32052    0.20488   1.564  0.11771    
gicontactbaseYes        0.26290    0.51215   0.513  0.60772    
gicontactbaseMissing    0.36545    0.42327   0.863  0.38792    
rawfood                -0.59076    0.20662  -2.859  0.00425 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 917.98  on 4193  degrees of freedom
Residual deviance: 781.98  on 4175  degrees of freedom
AIC: 1086

Number of Fisher Scoring iterations: 18



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error   z value  Pr(>|z|)    
(Intercept)           -2.659330   0.250409  -10.6200 < 2.2e-16 ***
entero35              -0.337122   0.330170   -1.0211  0.307227    
agecat5-14            -0.633914   0.269885   -2.3488  0.018832 *  
agecat15-24           -0.619607   0.381329   -1.6249  0.104192    
agecat25-34           -0.296696   0.292216   -1.0153  0.309948    
agecat35-44           -0.581438   0.344858   -1.6860  0.091792 .  
agecat45-54           -0.063020   0.440599   -0.1430  0.886265    
agecat55-64          -17.300532   0.328225  -52.7093 < 2.2e-16 ***
agecat65-74          -17.290937   0.457215  -37.8179 < 2.2e-16 ***
agecat75+            -17.340756   0.573440  -30.2399 < 2.2e-16 ***
agecatMissing         -1.502061   0.980649   -1.5317  0.125596    
female                -0.086656   0.158158   -0.5479  0.583755    
racewhiteYes           0.711431   0.246589    2.8851  0.003913 ** 
racewhiteMissing     -16.975828   0.141138 -120.2781 < 2.2e-16 ***
gichronYes             0.672070   0.546353    1.2301  0.218659    
anim_anyYes            0.320519   0.243571    1.3159  0.188204    
gicontactbaseYes       0.262903   0.425049    0.6185  0.536231    
gicontactbaseMissing   0.365448   0.401434    0.9104  0.362635    
rawfood               -0.590762   0.206942   -2.8547  0.004307 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Warning message:
glm.fit: fitted rates numerically 0 occurred 
> 
> # Surfside
> sufit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Surfside",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7651  -0.3140  -0.2756  -0.2371   2.5377  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)       -3.46743    0.35898  -9.659  < 2e-16 ***
entero35           0.21406    0.32180   0.665  0.50593    
agecat5-14        -0.76135    0.23835  -3.194  0.00140 ** 
agecat15-24       -0.71368    0.24225  -2.946  0.00322 ** 
agecat25-34       -0.17599    0.23371  -0.753  0.45144    
agecat35-44       -0.34926    0.23092  -1.512  0.13042    
agecat45-54       -0.47307    0.23570  -2.007  0.04474 *  
agecat55-64       -0.27667    0.26422  -1.047  0.29504    
agecat65-74      -14.59582  284.97296  -0.051  0.95915    
agecat75+         -0.58020    1.01929  -0.569  0.56921    
agecatMissing      0.32819    0.42312   0.776  0.43795    
female             0.08813    0.10977   0.803  0.42204    
racewhiteYes       0.54559    0.30883   1.767  0.07728 .  
racewhiteMissing -14.21623  839.12948  -0.017  0.98648    
gichronYes         1.03841    0.21225   4.892 9.96e-07 ***
anim_anyYes        0.02382    0.13586   0.175  0.86084    
gicontactbaseYes   0.62549    0.19549   3.200  0.00138 ** 
rawfood            0.35474    0.12051   2.944  0.00324 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2150.7  on 7935  degrees of freedom
Residual deviance: 2066.6  on 7918  degrees of freedom
AIC: 2786.6

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -3.467430   0.430959  -8.0458 8.565e-16 ***
entero35           0.214060   0.311524   0.6871  0.491997    
agecat5-14        -0.761349   0.257371  -2.9582  0.003095 ** 
agecat15-24       -0.713684   0.243318  -2.9331  0.003356 ** 
agecat25-34       -0.175987   0.223828  -0.7863  0.431717    
agecat35-44       -0.349256   0.234320  -1.4905  0.136091    
agecat45-54       -0.473073   0.233585  -2.0253  0.042840 *  
agecat55-64       -0.276667   0.262395  -1.0544  0.291703    
agecat65-74      -14.595819   0.222426 -65.6210 < 2.2e-16 ***
agecat75+         -0.580204   1.006007  -0.5767  0.564115    
agecatMissing      0.328194   0.641574   0.5115  0.608970    
female             0.088134   0.104268   0.8453  0.397963    
racewhiteYes       0.545593   0.374060   1.4586  0.144683    
racewhiteMissing -14.216226   0.843836 -16.8471 < 2.2e-16 ***
gichronYes         1.038407   0.193130   5.3767 7.586e-08 ***
anim_anyYes        0.023817   0.156279   0.1524  0.878872    
gicontactbaseYes   0.625493   0.222981   2.8051  0.005029 ** 
rawfood            0.354740   0.123971   2.8615  0.004217 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Pooled estimates
> # (can't use the mpreg fn because we 
> # need the actual glm returned object 
> # for the LR tests)
> 
> # all beaches
> all.fit <- glm(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	all.VC <- cl(ad,fm=all.fit,cluster=ad$hhid)
> 	overall.fit <- coeftest(all.fit, all.VC)
> 	summary(all.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach, family = poisson(link = "log"), 
    data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9863  -0.3146  -0.2718  -0.2335   2.8645  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.81985    0.11068 -25.478  < 2e-16 ***
entero35               0.18421    0.06648   2.771 0.005588 ** 
agecat5-14            -0.70863    0.07683  -9.223  < 2e-16 ***
agecat15-24           -0.72153    0.08770  -8.227  < 2e-16 ***
agecat25-34           -0.31438    0.08358  -3.762 0.000169 ***
agecat35-44           -0.33984    0.08229  -4.130 3.63e-05 ***
agecat45-54           -0.51574    0.09399  -5.487 4.09e-08 ***
agecat55-64           -0.55131    0.12656  -4.356 1.32e-05 ***
agecat65-74           -1.07643    0.28508  -3.776 0.000159 ***
agecat75+             -2.00003    1.00219  -1.996 0.045971 *  
agecatMissing         -0.56920    0.21021  -2.708 0.006774 ** 
female                 0.05548    0.04457   1.245 0.213263    
racewhiteYes           0.23012    0.06743   3.413 0.000643 ***
racewhiteMissing      -1.43709    0.27701  -5.188 2.13e-07 ***
gichronYes             0.73433    0.10240   7.171 7.42e-13 ***
gichronMissing        -9.86164  115.14716  -0.086 0.931750    
anim_anyYes            0.17245    0.05287   3.262 0.001106 ** 
gicontactbaseYes       0.63438    0.08189   7.747 9.44e-15 ***
gicontactbaseMissing   0.49521    0.25410   1.949 0.051309 .  
rawfood                0.19486    0.05546   3.514 0.000442 ***
beachBoqueron         -0.44295    0.10891  -4.067 4.76e-05 ***
beachDoheny           -0.13526    0.10528  -1.285 0.198878    
beachEdgewater         0.08442    0.17097   0.494 0.621451    
beachFairhope          0.06464    0.15932   0.406 0.684955    
beachGoddard          -0.32177    0.17324  -1.857 0.063268 .  
beachHuntington        0.50015    0.13987   3.576 0.000349 ***
beachMalibu            0.00869    0.11742   0.074 0.941006    
beachMission Bay      -0.16423    0.12249  -1.341 0.180018    
beachSilver           -0.35827    0.09977  -3.591 0.000329 ***
beachSurfside         -0.32993    0.09653  -3.418 0.000631 ***
beachWashington Park  -0.10677    0.11742  -0.909 0.363169    
beachWest              0.32445    0.11818   2.745 0.006043 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12825  on 47240  degrees of freedom
Residual deviance: 12317  on 47209  degrees of freedom
AIC: 16463

Number of Fisher Scoring iterations: 11

> 	overall.fit

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -2.8198468  0.1225700 -23.0060 < 2.2e-16 ***
entero35              0.1842094  0.0735206   2.5055 0.0122262 *  
agecat5-14           -0.7086298  0.0793389  -8.9317 < 2.2e-16 ***
agecat15-24          -0.7215307  0.0885205  -8.1510 3.609e-16 ***
agecat25-34          -0.3143797  0.0811828  -3.8725 0.0001077 ***
agecat35-44          -0.3398370  0.0813667  -4.1766 2.959e-05 ***
agecat45-54          -0.5157387  0.0945287  -5.4559 4.873e-08 ***
agecat55-64          -0.5513092  0.1254455  -4.3948 1.109e-05 ***
agecat65-74          -1.0764315  0.2823610  -3.8123 0.0001377 ***
agecat75+            -2.0000316  1.0001791  -1.9997 0.0455355 *  
agecatMissing        -0.5691990  0.2758281  -2.0636 0.0390556 *  
female                0.0554787  0.0424947   1.3055 0.1917082    
racewhiteYes          0.2301220  0.0777972   2.9580 0.0030967 ** 
racewhiteMissing     -1.4370942  0.3126406  -4.5966 4.294e-06 ***
gichronYes            0.7343311  0.0998191   7.3566 1.886e-13 ***
gichronMissing       -9.8616407  0.3611268 -27.3080 < 2.2e-16 ***
anim_anyYes           0.1724456  0.0582013   2.9629 0.0030474 ** 
gicontactbaseYes      0.6343750  0.0882609   7.1875 6.599e-13 ***
gicontactbaseMissing  0.4952069  0.2332477   2.1231 0.0337460 *  
rawfood               0.1948548  0.0588425   3.3115 0.0009281 ***
beachBoqueron        -0.4429513  0.1254330  -3.5314 0.0004134 ***
beachDoheny          -0.1352592  0.1175931  -1.1502 0.2500488    
beachEdgewater        0.0844228  0.1844718   0.4576 0.6472067    
beachFairhope         0.0646370  0.1788937   0.3613 0.7178637    
beachGoddard         -0.3217660  0.2057446  -1.5639 0.1178387    
beachHuntington       0.5001539  0.1569757   3.1862 0.0014416 ** 
beachMalibu           0.0086897  0.1286598   0.0675 0.9461516    
beachMission Bay     -0.1642269  0.1542658  -1.0646 0.2870703    
beachSilver          -0.3582721  0.1091167  -3.2834 0.0010257 ** 
beachSurfside        -0.3299349  0.1085468  -3.0396 0.0023692 ** 
beachWashington Park -0.1067714  0.1341225  -0.7961 0.4259891    
beachWest             0.3244503  0.1332178   2.4355 0.0148717 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Interaction model with fresh v. marine beaches
> mf.ref <- glm(diarrheaci10~entero35 +marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> mf.fit <- glm(diarrheaci10~entero35*marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	mf.VC <- cl(ad,fm=mf.fit,cluster=ad$hhid)
> 	mf.body <- coeftest(mf.fit, mf.VC) 
> 	summary(mf.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 * marine + agecat + female + 
    racewhite + gichron + anim_any + gicontactbase + rawfood + 
    beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9909  -0.3146  -0.2722  -0.2335   2.8644  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.498442   0.125801 -19.860  < 2e-16 ***
entero35               0.198771   0.089314   2.226 0.026046 *  
marineYes             -0.313930   0.125767  -2.496 0.012556 *  
agecat5-14            -0.708618   0.076829  -9.223  < 2e-16 ***
agecat15-24           -0.721415   0.087699  -8.226  < 2e-16 ***
agecat25-34           -0.314497   0.083578  -3.763 0.000168 ***
agecat35-44           -0.339764   0.082286  -4.129 3.64e-05 ***
agecat45-54           -0.515777   0.093992  -5.487 4.08e-08 ***
agecat55-64           -0.551151   0.126560  -4.355 1.33e-05 ***
agecat65-74           -1.076238   0.285075  -3.775 0.000160 ***
agecat75+             -2.000804   1.002196  -1.996 0.045888 *  
agecatMissing         -0.569690   0.210222  -2.710 0.006729 ** 
female                 0.055393   0.044576   1.243 0.213991    
racewhiteYes           0.229790   0.067438   3.407 0.000656 ***
racewhiteMissing      -1.436394   0.277025  -5.185 2.16e-07 ***
gichronYes             0.734063   0.102402   7.168 7.58e-13 ***
gichronMissing        -9.856934 115.074241  -0.086 0.931739    
anim_anyYes            0.172520   0.052866   3.263 0.001101 ** 
gicontactbaseYes       0.634551   0.081895   7.748 9.31e-15 ***
gicontactbaseMissing   0.495711   0.254114   1.951 0.051087 .  
rawfood                0.194751   0.055459   3.512 0.000445 ***
beachBoqueron         -0.450398   0.113029  -3.985 6.75e-05 ***
beachDoheny           -0.141624   0.108416  -1.306 0.191449    
beachEdgewater         0.078992   0.172390   0.458 0.646798    
beachFairhope          0.063847   0.159352   0.401 0.688668    
beachGoddard          -0.328938   0.175676  -1.872 0.061150 .  
beachHuntington        0.174711   0.147621   1.184 0.236605    
beachMalibu            0.001679   0.120825   0.014 0.988910    
beachMission Bay      -0.168863   0.123940  -1.362 0.173054    
beachSilver           -0.685743   0.112490  -6.096 1.09e-09 ***
beachSurfside         -0.336602   0.100262  -3.357 0.000787 ***
beachWashington Park  -0.432855   0.127385  -3.398 0.000679 ***
beachWest                    NA         NA      NA       NA    
entero35:marineYes    -0.032584   0.133802  -0.244 0.807600    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12825  on 47240  degrees of freedom
Residual deviance: 12317  on 47208  degrees of freedom
AIC: 16465

Number of Fisher Scoring iterations: 11

> 	lrtest(mf.ref,mf.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8199.6                     
2  33 -8199.6  1 0.0594     0.8075
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	mf.reri <- reri(b1=mf.body[2,1],b2=mf.body[3,1],b3=mf.body[nrow(mf.body),1],vcv=mf.VC[c(2,3,nrow(mf.VC)),c(2,3,nrow(mf.VC))])

RERI (95% CI) = -0.088 (-0.380,0.205); Pr > |z|= 0.556
> 	
> 
> # Interaction model with point v. non-point source beaches
> ps.ref <- glm(diarrheaci10~entero35+pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> ps.fit <- glm(diarrheaci10~entero35*pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	ps.VC <- cl(ad,fm=ps.fit,cluster=ad$hhid)
> 	ps.body <- coeftest(ps.fit, ps.VC) 
> 	summary(ps.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 * pointsource + agecat + 
    female + racewhite + gichron + anim_any + gicontactbase + 
    rawfood + beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0000  -0.3149  -0.2720  -0.2335   2.8613  

Coefficients: (1 not defined because of singularities)
                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)              -3.14328    0.10884 -28.881  < 2e-16 ***
entero35                 -0.06751    0.18429  -0.366 0.714116    
pointsourceYes            0.30622    0.09797   3.126 0.001774 ** 
agecat5-14               -0.70850    0.07683  -9.222  < 2e-16 ***
agecat15-24              -0.71965    0.08771  -8.205 2.30e-16 ***
agecat25-34              -0.31283    0.08358  -3.743 0.000182 ***
agecat35-44              -0.33840    0.08229  -4.112 3.92e-05 ***
agecat45-54              -0.51505    0.09399  -5.480 4.26e-08 ***
agecat55-64              -0.55035    0.12656  -4.349 1.37e-05 ***
agecat65-74              -1.07593    0.28507  -3.774 0.000161 ***
agecat75+                -1.99917    1.00219  -1.995 0.046066 *  
agecatMissing            -0.56897    0.21022  -2.707 0.006798 ** 
female                    0.05527    0.04457   1.240 0.215015    
racewhiteYes              0.22870    0.06741   3.393 0.000692 ***
racewhiteMissing         -1.42712    0.27704  -5.151 2.59e-07 ***
gichronYes                0.73444    0.10239   7.173 7.35e-13 ***
gichronMissing           -9.84946  115.13814  -0.086 0.931828    
anim_anyYes               0.17262    0.05286   3.266 0.001092 ** 
gicontactbaseYes          0.63501    0.08189   7.755 8.87e-15 ***
gicontactbaseMissing      0.49178    0.25414   1.935 0.052981 .  
rawfood                   0.19455    0.05546   3.508 0.000452 ***
beachBoqueron            -0.42678    0.10958  -3.895 9.84e-05 ***
beachDoheny               0.19934    0.09858   2.022 0.043158 *  
beachEdgewater            0.09709    0.17122   0.567 0.570688    
beachFairhope             0.06647    0.15932   0.417 0.676531    
beachGoddard             -0.30467    0.17371  -1.754 0.079445 .  
beachHuntington           0.50489    0.13991   3.609 0.000308 ***
beachMalibu               0.33483    0.11064   3.026 0.002476 ** 
beachMission Bay          0.19366    0.12151   1.594 0.111003    
beachSilver              -0.35969    0.09977  -3.605 0.000312 ***
beachSurfside                  NA         NA      NA       NA    
beachWashington Park     -0.10404    0.11743  -0.886 0.375624    
beachWest                 0.33189    0.11829   2.806 0.005020 ** 
entero35:pointsourceYes   0.29488    0.19791   1.490 0.136220    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12825  on 47240  degrees of freedom
Residual deviance: 12315  on 47208  degrees of freedom
AIC: 16463

Number of Fisher Scoring iterations: 11

> 	lrtest(ps.ref,ps.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8199.6                     
2  33 -8198.5  1 2.3607     0.1244
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	ps.reri <- reri(b1=ps.body[2,1],b2=ps.body[3,1],b3=ps.body[nrow(ps.body),1],vcv=ps.VC[c(2,3,nrow(ps.VC)),c(2,3,nrow(ps.VC))])

RERI (95% CI) = 0.412 (-0.034,0.858); Pr > |z|= 0.070
> 
> # --------------------------------------
> # Age-stratified estimates and LR tests of
> # interaction
> 
> # reduced models for LR tests of indicator x age interactions
> agestrat.ref <- glm(diarrheaci10~entero35 +agestrat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 
> # Pooled estimate (Age 0-4, 5-10, >10), Body Immersion
> agestrat.fit <- glm(diarrheaci10~ entero35*agestrat +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	# commented out robust SE calcs b/c not used
> 	# agestrat.VC <- cl(ad,fm=agestrat.fit,cluster=ad$hhid)
> 	# agestrat.body <- coeftest(agestrat.fit, agestrat.VC) 
> 	lrtest(agestrat.ref,agestrat.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)  
1  26 -8228.6                       
2  29 -8224.3  3 8.4337    0.03785 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> 
> # --------------------------------------
> # Stratified Models 
> # based on tests of interaction (above)
> # stratify the results by non-point and
> # point source conditions
> # --------------------------------------
> 
> # Pooled Non-point source and point-source
> nps <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8310  -0.3115  -0.2735  -0.2470   3.1358  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.98244    0.14471 -20.609  < 2e-16 ***
entero35             -0.05632    0.18427  -0.306 0.759860    
agecat5-14           -0.70616    0.12413  -5.689 1.28e-08 ***
agecat15-24          -0.67903    0.14742  -4.606 4.10e-06 ***
agecat25-34          -0.27784    0.13839  -2.008 0.044678 *  
agecat35-44          -0.34151    0.13529  -2.524 0.011596 *  
agecat45-54          -0.44892    0.14754  -3.043 0.002344 ** 
agecat55-64          -0.53816    0.19666  -2.736 0.006210 ** 
agecat65-74          -2.63052    1.00622  -2.614 0.008942 ** 
agecat75+            -0.95400    1.00602  -0.948 0.342979    
agecatMissing        -0.31643    0.36848  -0.859 0.390479    
female                0.01412    0.07249   0.195 0.845538    
racewhiteYes          0.34878    0.10480   3.328 0.000875 ***
racewhiteMissing     -2.37285    0.45476  -5.218 1.81e-07 ***
gichronYes            1.02470    0.16156   6.342 2.26e-10 ***
anim_anyYes           0.03564    0.08896   0.401 0.688701    
gicontactbaseYes      0.50430    0.14574   3.460 0.000540 ***
gicontactbaseMissing  0.47917    0.30844   1.554 0.120296    
rawfood               0.12204    0.08347   1.462 0.143735    
beachMalibu           0.14740    0.11834   1.246 0.212922    
beachMission Bay      0.11916    0.13158   0.906 0.365147    
beachSurfside        -0.15027    0.10870  -1.383 0.166816    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4949.8  on 18781  degrees of freedom
Residual deviance: 4745.4  on 18760  degrees of freedom
AIC: 6343.4

Number of Fisher Scoring iterations: 7



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -2.982440   0.161472 -18.4703 < 2.2e-16 ***
entero35             -0.056324   0.201190  -0.2800  0.779514    
agecat5-14           -0.706158   0.132181  -5.3424 9.175e-08 ***
agecat15-24          -0.679035   0.148651  -4.5680 4.924e-06 ***
agecat25-34          -0.277837   0.132981  -2.0893  0.036681 *  
agecat35-44          -0.341509   0.133826  -2.5519  0.010714 *  
agecat45-54          -0.448920   0.147730  -3.0388  0.002375 ** 
agecat55-64          -0.538164   0.195227  -2.7566  0.005841 ** 
agecat65-74          -2.630516   1.007727  -2.6103  0.009045 ** 
agecat75+            -0.954004   0.998612  -0.9553  0.339411    
agecatMissing        -0.316431   0.567610  -0.5575  0.577199    
female                0.014122   0.069560   0.2030  0.839118    
racewhiteYes          0.348780   0.123465   2.8249  0.004729 ** 
racewhiteMissing     -2.372854   0.467033  -5.0807 3.761e-07 ***
gichronYes            1.024701   0.151656   6.7567 1.411e-11 ***
anim_anyYes           0.035641   0.097797   0.3644  0.715533    
gicontactbaseYes      0.504301   0.158068   3.1904  0.001421 ** 
gicontactbaseMissing  0.479168   0.284528   1.6841  0.092166 .  
rawfood               0.122035   0.088867   1.3732  0.169680    
beachMalibu           0.147399   0.130234   1.1318  0.257719    
beachMission Bay      0.119160   0.170242   0.6999  0.483961    
beachSurfside        -0.150274   0.120579  -1.2463  0.212665    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> ps <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9944  -0.3199  -0.2695  -0.2278   2.4772  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.84261    0.12934 -21.978  < 2e-16 ***
entero35               0.23268    0.07223   3.221 0.001276 ** 
agecat5-14            -0.71695    0.09789  -7.324 2.40e-13 ***
agecat15-24           -0.74318    0.10919  -6.806 1.00e-11 ***
agecat25-34           -0.34121    0.10494  -3.251 0.001149 ** 
agecat35-44           -0.34421    0.10372  -3.319 0.000904 ***
agecat45-54           -0.58112    0.12269  -4.737 2.17e-06 ***
agecat55-64           -0.56507    0.16582  -3.408 0.000655 ***
agecat65-74           -0.72471    0.30010  -2.415 0.015739 *  
agecat75+            -12.53179  145.24276  -0.086 0.931243    
agecatMissing         -0.72270    0.25651  -2.817 0.004841 ** 
female                 0.08567    0.05663   1.513 0.130303    
racewhiteYes           0.16381    0.08793   1.863 0.062459 .  
racewhiteMissing       0.39076    0.34375   1.137 0.255641    
gichronYes             0.56899    0.13236   4.299 1.72e-05 ***
gichronMissing       -12.20088  329.06068  -0.037 0.970423    
anim_anyYes            0.24730    0.06634   3.728 0.000193 ***
gicontactbaseYes       0.70996    0.09922   7.156 8.33e-13 ***
gicontactbaseMissing   0.45463    0.45003   1.010 0.312381    
rawfood                0.24632    0.07393   3.332 0.000863 ***
beachBoqueron         -0.46497    0.11983  -3.880 0.000104 ***
beachEdgewater         0.08791    0.17264   0.509 0.610621    
beachFairhope          0.04415    0.16114   0.274 0.784095    
beachGoddard          -0.32428    0.17504  -1.853 0.063936 .  
beachHuntington        0.49926    0.14247   3.504 0.000458 ***
beachSilver           -0.37037    0.10256  -3.611 0.000305 ***
beachWashington Park  -0.11642    0.11986  -0.971 0.331417    
beachWest              0.31306    0.12051   2.598 0.009383 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 7872.7  on 28458  degrees of freedom
Residual deviance: 7523.3  on 28431  degrees of freedom
AIC: 10107

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.842608   0.142779 -19.9092 < 2.2e-16 ***
entero35               0.232680   0.080787   2.8802 0.0039746 ** 
agecat5-14            -0.716946   0.098729  -7.2618 3.821e-13 ***
agecat15-24           -0.743178   0.110052  -6.7530 1.448e-11 ***
agecat25-34           -0.341208   0.102357  -3.3335 0.0008576 ***
agecat35-44           -0.344205   0.102387  -3.3618 0.0007744 ***
agecat45-54           -0.581122   0.123643  -4.7000 2.602e-06 ***
agecat55-64           -0.565069   0.163504  -3.4560 0.0005483 ***
agecat65-74           -0.724712   0.295755  -2.4504 0.0142706 *  
agecat75+            -12.531788   0.157897 -79.3668 < 2.2e-16 ***
agecatMissing         -0.722696   0.293873  -2.4592 0.0139240 *  
female                 0.085674   0.053700   1.5954 0.1106226    
racewhiteYes           0.163812   0.099499   1.6464 0.0996869 .  
racewhiteMissing       0.390759   0.363789   1.0741 0.2827614    
gichronYes             0.568988   0.131477   4.3277 1.507e-05 ***
gichronMissing       -12.200876   0.368262 -33.1310 < 2.2e-16 ***
anim_anyYes            0.247302   0.073099   3.3831 0.0007167 ***
gicontactbaseYes       0.709959   0.106020   6.6965 2.135e-11 ***
gicontactbaseMissing   0.454635   0.405191   1.1220 0.2618507    
rawfood                0.246319   0.077748   3.1681 0.0015341 ** 
beachBoqueron         -0.464975   0.138932  -3.3468 0.0008175 ***
beachEdgewater         0.087907   0.187457   0.4689 0.6391095    
beachFairhope          0.044150   0.181580   0.2431 0.8078936    
beachGoddard          -0.324282   0.208322  -1.5566 0.1195560    
beachHuntington        0.499260   0.160022   3.1200 0.0018088 ** 
beachSilver           -0.370370   0.112142  -3.3027 0.0009576 ***
beachWashington Park  -0.116417   0.136536  -0.8526 0.3938538    
beachWest              0.313056   0.135950   2.3027 0.0212938 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Age-stratified results
> age0to4   <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7488  -0.3931  -0.3436  -0.3011   2.6672  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.56648    0.25494 -10.067  < 2e-16 ***
entero35              0.38971    0.17179   2.269  0.02329 *  
female               -0.11360    0.12339  -0.921  0.35725    
racewhiteYes          0.22183    0.16929   1.310  0.19007    
racewhiteMissing     -1.79451    0.72773  -2.466  0.01367 *  
gichronYes            0.31628    0.71460   0.443  0.65805    
anim_anyYes           0.28567    0.14356   1.990  0.04660 *  
gicontactbaseYes      0.47129    0.25935   1.817  0.06919 .  
gicontactbaseMissing  0.97263    0.51828   1.877  0.06056 .  
rawfood              -0.63926    0.28008  -2.282  0.02247 *  
beachBoqueron        -0.43639    0.29760  -1.466  0.14254    
beachDoheny          -0.18546    0.27841  -0.666  0.50533    
beachEdgewater       -0.15514    0.49449  -0.314  0.75372    
beachFairhope        -0.18404    0.34321  -0.536  0.59180    
beachGoddard         -0.27999    0.39807  -0.703  0.48183    
beachHuntington      -0.16180    0.39413  -0.411  0.68142    
beachMalibu          -0.27400    0.33294  -0.823  0.41052    
beachMission Bay     -0.16660    0.29908  -0.557  0.57750    
beachSilver          -0.72133    0.26823  -2.689  0.00716 ** 
beachSurfside        -0.65688    0.28956  -2.269  0.02329 *  
beachWashington Park -0.53180    0.33021  -1.611  0.10729    
beachWest            -0.01714    0.33895  -0.051  0.95967    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1430.6  on 3914  degrees of freedom
Residual deviance: 1377.5  on 3893  degrees of freedom
AIC: 1953.5

Number of Fisher Scoring iterations: 6



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value Pr(>|z|)    
(Intercept)          -2.566478   0.254213 -10.0958  < 2e-16 ***
entero35              0.389710   0.171632   2.2706  0.02317 *  
female               -0.113595   0.118655  -0.9574  0.33839    
racewhiteYes          0.221830   0.174258   1.2730  0.20302    
racewhiteMissing     -1.794508   0.766691  -2.3406  0.01925 *  
gichronYes            0.316284   0.644156   0.4910  0.62342    
anim_anyYes           0.285671   0.151009   1.8918  0.05852 .  
gicontactbaseYes      0.471286   0.255046   1.8479  0.06462 .  
gicontactbaseMissing  0.972627   0.494559   1.9667  0.04922 *  
rawfood              -0.639260   0.273032  -2.3413  0.01921 *  
beachBoqueron        -0.436392   0.312071  -1.3984  0.16200    
beachDoheny          -0.185456   0.272068  -0.6817  0.49546    
beachEdgewater       -0.155138   0.484851  -0.3200  0.74899    
beachFairhope        -0.184038   0.337745  -0.5449  0.58582    
beachGoddard         -0.279993   0.425644  -0.6578  0.51066    
beachHuntington      -0.161801   0.413650  -0.3912  0.69568    
beachMalibu          -0.274002   0.341681  -0.8019  0.42260    
beachMission Bay     -0.166598   0.329232  -0.5060  0.61284    
beachSilver          -0.721326   0.288806  -2.4976  0.01250 *  
beachSurfside        -0.656881   0.304751  -2.1555  0.03113 *  
beachWashington Park -0.531799   0.327924  -1.6217  0.10486    
beachWest            -0.017139   0.350168  -0.0489  0.96096    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age5to10  <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7190  -0.3002  -0.2645  -0.2135   3.0010  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.41125    0.21743 -15.689  < 2e-16 ***
entero35               0.23155    0.14629   1.583  0.11345    
female                -0.10282    0.10994  -0.935  0.34969    
racewhiteYes           0.37923    0.14908   2.544  0.01097 *  
racewhiteMissing      -1.65570    0.59487  -2.783  0.00538 ** 
gichronYes             0.91160    0.45294   2.013  0.04416 *  
gichronMissing        -9.73247  253.50555  -0.038  0.96938    
anim_anyYes            0.07498    0.13465   0.557  0.57766    
gicontactbaseYes       0.41626    0.22234   1.872  0.06118 .  
gicontactbaseMissing  -0.04999    0.71357  -0.070  0.94415    
rawfood               -0.22718    0.18522  -1.227  0.22001    
beachBoqueron         -0.53510    0.29042  -1.843  0.06540 .  
beachDoheny           -0.19215    0.23330  -0.824  0.41014    
beachEdgewater         0.05494    0.48354   0.114  0.90953    
beachFairhope         -0.19113    0.37713  -0.507  0.61230    
beachGoddard          -0.14279    0.40037  -0.357  0.72136    
beachHuntington        0.76748    0.28513   2.692  0.00711 ** 
beachMalibu            0.36370    0.26147   1.391  0.16423    
beachMission Bay       0.16092    0.25191   0.639  0.52294    
beachSilver           -0.17679    0.22651  -0.780  0.43510    
beachSurfside         -0.61070    0.27040  -2.259  0.02391 *  
beachWashington Park  -0.02568    0.26831  -0.096  0.92375    
beachWest              0.33169    0.30729   1.079  0.28040    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2195.5  on 8874  degrees of freedom
Residual deviance: 2111.7  on 8852  degrees of freedom
AIC: 2827.7

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.411251   0.234788 -14.5291 < 2.2e-16 ***
entero35              0.231555   0.149226   1.5517  0.120732    
female               -0.102816   0.107879  -0.9531  0.340557    
racewhiteYes          0.379234   0.170138   2.2290  0.025815 *  
racewhiteMissing     -1.655697   0.620031  -2.6703  0.007577 ** 
gichronYes            0.911599   0.419738   2.1718  0.029869 *  
gichronMissing       -9.732471   0.708935 -13.7283 < 2.2e-16 ***
anim_anyYes           0.074976   0.137252   0.5463  0.584882    
gicontactbaseYes      0.416257   0.225788   1.8436  0.065245 .  
gicontactbaseMissing -0.049993   0.696770  -0.0717  0.942801    
rawfood              -0.227177   0.197062  -1.1528  0.248985    
beachBoqueron        -0.535103   0.307583  -1.7397  0.081911 .  
beachDoheny          -0.192155   0.243408  -0.7894  0.429858    
beachEdgewater        0.054943   0.473168   0.1161  0.907559    
beachFairhope        -0.191127   0.404611  -0.4724  0.636661    
beachGoddard         -0.142791   0.429412  -0.3325  0.739491    
beachHuntington       0.767484   0.303162   2.5316  0.011355 *  
beachMalibu           0.363700   0.262194   1.3871  0.165399    
beachMission Bay      0.160923   0.296127   0.5434  0.586835    
beachSilver          -0.176794   0.227964  -0.7755  0.438025    
beachSurfside        -0.610702   0.284406  -2.1473  0.031770 *  
beachWashington Park -0.025680   0.278610  -0.0922  0.926563    
beachWest             0.331691   0.305644   1.0852  0.277823    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8073  -0.3100  -0.2694  -0.2372   2.9548  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.438750   0.118406 -29.042  < 2e-16 ***
entero35               0.129357   0.083891   1.542 0.123081    
female                 0.150431   0.053859   2.793 0.005221 ** 
racewhiteYes           0.174972   0.084525   2.070 0.038447 *  
racewhiteMissing      -1.825883   0.458084  -3.986 6.72e-05 ***
gichronYes             0.784040   0.106282   7.377 1.62e-13 ***
gichronMissing       -10.038444 148.483181  -0.068 0.946099    
anim_anyYes            0.163831   0.063361   2.586 0.009719 ** 
gicontactbaseYes       0.691834   0.095124   7.273 3.52e-13 ***
gicontactbaseMissing   0.527007   0.321297   1.640 0.100953    
rawfood                0.359557   0.060597   5.934 2.96e-09 ***
beachBoqueron         -0.439116   0.130843  -3.356 0.000791 ***
beachDoheny           -0.096194   0.130859  -0.735 0.462280    
beachEdgewater         0.189083   0.197185   0.959 0.337604    
beachFairhope          0.219108   0.207178   1.058 0.290245    
beachGoddard          -0.359434   0.221313  -1.624 0.104355    
beachHuntington        0.542520   0.180711   3.002 0.002681 ** 
beachMalibu           -0.007198   0.143414  -0.050 0.959972    
beachMission Bay      -0.237127   0.162997  -1.455 0.145727    
beachSilver           -0.307087   0.122999  -2.497 0.012537 *  
beachSurfside         -0.257435   0.113481  -2.269 0.023298 *  
beachWashington Park   0.010614   0.142806   0.074 0.940755    
beachWest              0.392031   0.138659   2.827 0.004694 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 8975.0  on 33733  degrees of freedom
Residual deviance: 8648.4  on 33711  degrees of freedom
AIC: 11524

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.4387500   0.1281032 -26.8436 < 2.2e-16 ***
entero35               0.1293569   0.0882699   1.4655 0.1427926    
female                 0.1504312   0.0506824   2.9681 0.0029963 ** 
racewhiteYes           0.1749715   0.0884609   1.9780 0.0479339 *  
racewhiteMissing      -1.8258832   0.4743476  -3.8493 0.0001185 ***
gichronYes             0.7840403   0.1026394   7.6388 2.193e-14 ***
gichronMissing       -10.0384443   0.4024560 -24.9430 < 2.2e-16 ***
anim_anyYes            0.1638308   0.0657527   2.4916 0.0127162 *  
gicontactbaseYes       0.6918339   0.0956560   7.2325 4.741e-13 ***
gicontactbaseMissing   0.5270065   0.2936876   1.7944 0.0727420 .  
rawfood                0.3595566   0.0625638   5.7470 9.082e-09 ***
beachBoqueron         -0.4391165   0.1429976  -3.0708 0.0021349 ** 
beachDoheny           -0.0961944   0.1389412  -0.6923 0.4887248    
beachEdgewater         0.1890829   0.2087111   0.9060 0.3649595    
beachFairhope          0.2191079   0.2058672   1.0643 0.2871852    
beachGoddard          -0.3594340   0.2366699  -1.5187 0.1288344    
beachHuntington        0.5425199   0.1792678   3.0263 0.0024756 ** 
beachMalibu           -0.0071978   0.1504236  -0.0479 0.9618354    
beachMission Bay      -0.2371269   0.1833059  -1.2936 0.1957991    
beachSilver           -0.3070868   0.1277438  -2.4039 0.0162200 *  
beachSurfside         -0.2574346   0.1212135  -2.1238 0.0336859 *  
beachWashington Park   0.0106135   0.1525254   0.0696 0.9445238    
beachWest              0.3920311   0.1477196   2.6539 0.0079570 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source estimates by age group
> nps0to4 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7439  -0.3747  -0.3543  -0.2872   2.6475  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.71155    0.28289  -9.585   <2e-16 ***
entero35               0.27420    0.40300   0.680   0.4963    
female                -0.03720    0.20110  -0.185   0.8532    
racewhiteYes           0.23083    0.26103   0.884   0.3765    
racewhiteMissing      -1.78191    0.73069  -2.439   0.0147 *  
gichronYes           -12.63471  636.22061  -0.020   0.9842    
anim_anyYes            0.07701    0.24657   0.312   0.7548    
gicontactbaseYes       0.05458    0.51118   0.107   0.9150    
gicontactbaseMissing   1.11892    0.52749   2.121   0.0339 *  
rawfood               -0.67075    0.40358  -1.662   0.0965 .  
beachMalibu           -0.09010    0.32277  -0.279   0.7801    
beachMission Bay       0.01593    0.31104   0.051   0.9591    
beachSurfside         -0.36455    0.30258  -1.205   0.2283    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 560.31  on 1646  degrees of freedom
Residual deviance: 539.36  on 1634  degrees of freedom
AIC: 765.36

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -2.711547   0.300811  -9.0141  < 2e-16 ***
entero35               0.274197   0.398891   0.6874  0.49183    
female                -0.037205   0.199979  -0.1860  0.85241    
racewhiteYes           0.230828   0.291774   0.7911  0.42888    
racewhiteMissing      -1.781908   0.770108  -2.3138  0.02068 *  
gichronYes           -12.634710   0.529453 -23.8637  < 2e-16 ***
anim_anyYes            0.077009   0.245401   0.3138  0.75367    
gicontactbaseYes       0.054575   0.487357   0.1120  0.91084    
gicontactbaseMissing   1.118922   0.491026   2.2787  0.02268 *  
rawfood               -0.670749   0.387884  -1.7293  0.08376 .  
beachMalibu           -0.090101   0.326302  -0.2761  0.78245    
beachMission Bay       0.015933   0.359918   0.0443  0.96469    
beachSurfside         -0.364552   0.288193  -1.2650  0.20589    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps5to10 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6903  -0.2897  -0.2558  -0.2102   3.0310  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.42020    0.23724 -14.417  < 2e-16 ***
entero35             -1.02872    0.58886  -1.747  0.08064 .  
female               -0.39266    0.17845  -2.200  0.02778 *  
racewhiteYes          0.36892    0.21795   1.693  0.09052 .  
racewhiteMissing     -2.69411    1.01104  -2.665  0.00771 ** 
gichronYes            1.48490    0.71553   2.075  0.03797 *  
anim_anyYes           0.13326    0.20925   0.637  0.52425    
gicontactbaseYes     -0.01606    0.45817  -0.035  0.97203    
gicontactbaseMissing  0.18561    0.71778   0.259  0.79595    
rawfood              -0.47225    0.27328  -1.728  0.08397 .  
beachMalibu           0.52468    0.24999   2.099  0.03583 *  
beachMission Bay      0.50875    0.25883   1.966  0.04935 *  
beachSurfside        -0.45117    0.27754  -1.626  0.10404    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 909.38  on 3987  degrees of freedom
Residual deviance: 861.34  on 3975  degrees of freedom
AIC: 1155.3

Number of Fisher Scoring iterations: 7



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.420197   0.264947 -12.9090 < 2.2e-16 ***
entero35             -1.028721   0.607910  -1.6922  0.090603 .  
female               -0.392658   0.170284  -2.3059  0.021116 *  
racewhiteYes          0.368920   0.258819   1.4254  0.154042    
racewhiteMissing     -2.694114   1.025019  -2.6284  0.008580 ** 
gichronYes            1.484895   0.560925   2.6472  0.008115 ** 
anim_anyYes           0.133255   0.219533   0.6070  0.543855    
gicontactbaseYes     -0.016062   0.455847  -0.0352  0.971892    
gicontactbaseMissing  0.185610   0.697817   0.2660  0.790250    
rawfood              -0.472253   0.289907  -1.6290  0.103317    
beachMalibu           0.524683   0.254935   2.0581  0.039580 *  
beachMission Bay      0.508755   0.321539   1.5822  0.113593    
beachSurfside        -0.451166   0.300940  -1.4992  0.133825    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8593  -0.3044  -0.2794  -0.2588   3.2374  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.66872    0.15061 -24.360  < 2e-16 ***
entero35              0.09445    0.22240   0.425 0.671083    
female                0.13924    0.08765   1.589 0.112126    
racewhiteYes          0.41319    0.13583   3.042 0.002350 ** 
racewhiteMissing     -2.56968    0.71627  -3.588 0.000334 ***
gichronYes            1.04132    0.16557   6.289 3.19e-10 ***
anim_anyYes           0.01283    0.10749   0.119 0.904980    
gicontactbaseYes      0.65239    0.16179   4.032 5.52e-05 ***
gicontactbaseMissing  0.27611    0.45552   0.606 0.544420    
rawfood               0.31215    0.09180   3.400 0.000673 ***
beachMalibu           0.10109    0.14714   0.687 0.492072    
beachMission Bay      0.03821    0.17748   0.215 0.829514    
beachSurfside        -0.12736    0.13080  -0.974 0.330217    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3408.5  on 12935  degrees of freedom
Residual deviance: 3281.1  on 12923  degrees of freedom
AIC: 4377.1

Number of Fisher Scoring iterations: 7



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.668721   0.161224 -22.7554 < 2.2e-16 ***
entero35              0.094447   0.238716   0.3956 0.6923664    
female                0.139244   0.083076   1.6761 0.0937181 .  
racewhiteYes          0.413192   0.142397   2.9017 0.0037117 ** 
racewhiteMissing     -2.569683   0.730149  -3.5194 0.0004325 ***
gichronYes            1.041316   0.154066   6.7589 1.390e-11 ***
anim_anyYes           0.012831   0.111447   0.1151 0.9083392    
gicontactbaseYes      0.652389   0.167038   3.9056 9.398e-05 ***
gicontactbaseMissing  0.276108   0.435539   0.6339 0.5261161    
rawfood               0.312146   0.095735   3.2605 0.0011120 ** 
beachMalibu           0.101090   0.151279   0.6682 0.5039827    
beachMission Bay      0.038215   0.197999   0.1930 0.8469543    
beachSurfside        -0.127355   0.132379  -0.9621 0.3360236    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point-source estimates by age group
> ps0to4 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8337  -0.4063  -0.3514  -0.3058   2.2035  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.56062    0.28313  -9.044  < 2e-16 ***
entero35               0.40951    0.19154   2.138  0.03252 *  
female                -0.16675    0.15645  -1.066  0.28648    
racewhiteYes           0.20456    0.22349   0.915  0.36004    
racewhiteMissing     -12.49874  503.56650  -0.025  0.98020    
gichronYes             0.48413    0.72203   0.671  0.50253    
anim_anyYes            0.40152    0.18135   2.214  0.02683 *  
gicontactbaseYes       0.65488    0.30337   2.159  0.03087 *  
gicontactbaseMissing -12.89203  735.84219  -0.018  0.98602    
rawfood               -0.63136    0.39017  -1.618  0.10563    
beachBoqueron         -0.49084    0.32384  -1.516  0.12960    
beachEdgewater        -0.21489    0.49817  -0.431  0.66620    
beachFairhope         -0.26805    0.34689  -0.773  0.43969    
beachGoddard          -0.33539    0.40330  -0.832  0.40563    
beachHuntington       -0.23986    0.39916  -0.601  0.54790    
beachSilver           -0.80572    0.27347  -2.946  0.00322 ** 
beachWashington Park  -0.62541    0.33523  -1.866  0.06209 .  
beachWest             -0.08523    0.34457  -0.247  0.80464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 868.07  on 2267  degrees of freedom
Residual deviance: 832.89  on 2250  degrees of freedom
AIC: 1200.9

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -2.560619   0.269929  -9.4863  < 2e-16 ***
entero35               0.409509   0.192782   2.1242  0.03365 *  
female                -0.166755   0.148680  -1.1216  0.26205    
racewhiteYes           0.204558   0.215179   0.9506  0.34179    
racewhiteMissing     -12.498737   0.565186 -22.1144  < 2e-16 ***
gichronYes             0.484128   0.651694   0.7429  0.45756    
anim_anyYes            0.401518   0.199258   2.0151  0.04390 *  
gicontactbaseYes       0.654880   0.301217   2.1741  0.02970 *  
gicontactbaseMissing -12.892028   0.774719 -16.6409  < 2e-16 ***
rawfood               -0.631360   0.389268  -1.6219  0.10482    
beachBoqueron         -0.490838   0.337517  -1.4543  0.14587    
beachEdgewater        -0.214893   0.494403  -0.4347  0.66382    
beachFairhope         -0.268051   0.338903  -0.7909  0.42898    
beachGoddard          -0.335389   0.435999  -0.7692  0.44175    
beachHuntington       -0.239860   0.423996  -0.5657  0.57159    
beachSilver           -0.805718   0.300629  -2.6801  0.00736 ** 
beachWashington Park  -0.625411   0.335982  -1.8614  0.06268 .  
beachWest             -0.085226   0.355651  -0.2396  0.81061    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps5to10 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6058  -0.3248  -0.2730  -0.2006   2.4730  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.676040   0.254601 -14.438  < 2e-16 ***
entero35               0.419544   0.160366   2.616  0.00889 ** 
female                 0.087734   0.141591   0.620  0.53550    
racewhiteYes           0.423010   0.207139   2.042  0.04114 *  
racewhiteMissing       0.791468   0.736579   1.075  0.28259    
gichronYes             0.646014   0.583880   1.106  0.26855    
gichronMissing       -12.343684 731.473831  -0.017  0.98654    
anim_anyYes            0.046452   0.176383   0.263  0.79228    
gicontactbaseYes       0.569897   0.256159   2.225  0.02610 *  
gicontactbaseMissing -12.256311 365.901502  -0.033  0.97328    
rawfood               -0.001914   0.248660  -0.008  0.99386    
beachBoqueron         -0.364245   0.319223  -1.141  0.25386    
beachEdgewater         0.182530   0.488715   0.373  0.70878    
beachFairhope         -0.121103   0.382299  -0.317  0.75141    
beachGoddard          -0.024200   0.407940  -0.059  0.95269    
beachHuntington        0.866912   0.295016   2.939  0.00330 ** 
beachSilver           -0.153083   0.235975  -0.649  0.51652    
beachWashington Park   0.036114   0.277191   0.130  0.89634    
beachWest              0.387886   0.314342   1.234  0.21722    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1282.8  on 4886  degrees of freedom
Residual deviance: 1225.4  on 4868  degrees of freedom
AIC: 1665.4

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.6760404   0.2863302 -12.8385 < 2.2e-16 ***
entero35               0.4195445   0.1687923   2.4856  0.012935 *  
female                 0.0877338   0.1395980   0.6285  0.529693    
racewhiteYes           0.4230102   0.2256792   1.8744  0.060877 .  
racewhiteMissing       0.7914679   0.6568612   1.2049  0.228233    
gichronYes             0.6460144   0.5573035   1.1592  0.246383    
gichronMissing       -12.3436838   0.6585287 -18.7443 < 2.2e-16 ***
anim_anyYes            0.0464517   0.1725472   0.2692  0.787767    
gicontactbaseYes       0.5698971   0.2596090   2.1952  0.028148 *  
gicontactbaseMissing -12.2563113   0.4144666 -29.5713 < 2.2e-16 ***
rawfood               -0.0019136   0.2548222  -0.0075  0.994008    
beachBoqueron         -0.3642445   0.3435219  -1.0603  0.288997    
beachEdgewater         0.1825300   0.4758124   0.3836  0.701262    
beachFairhope         -0.1211035   0.4095659  -0.2957  0.767469    
beachGoddard          -0.0242004   0.4332073  -0.0559  0.955451    
beachHuntington        0.8669122   0.3122147   2.7767  0.005492 ** 
beachSilver           -0.1530832   0.2337719  -0.6548  0.512571    
beachWashington Park   0.0361140   0.2835298   0.1274  0.898645    
beachWest              0.3878864   0.3113986   1.2456  0.212901    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7697  -0.3141  -0.2629  -0.2245   2.4270  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.37344    0.13206 -25.544  < 2e-16 ***
entero35               0.14035    0.09083   1.545 0.122322    
female                 0.16229    0.06833   2.375 0.017546 *  
racewhiteYes           0.02590    0.10696   0.242 0.808644    
racewhiteMissing      -0.32833    0.58662  -0.560 0.575692    
gichronYes             0.62685    0.13852   4.525 6.03e-06 ***
gichronMissing       -11.12104  248.91461  -0.045 0.964364    
anim_anyYes            0.24420    0.07869   3.103 0.001914 ** 
gicontactbaseYes       0.72576    0.11775   6.164 7.12e-10 ***
gicontactbaseMissing   0.84579    0.45094   1.876 0.060706 .  
rawfood                0.39379    0.08034   4.902 9.51e-07 ***
beachBoqueron         -0.55206    0.14214  -3.884 0.000103 ***
beachEdgewater         0.15997    0.19869   0.805 0.420745    
beachFairhope          0.17694    0.20876   0.848 0.396684    
beachGoddard          -0.39265    0.22288  -1.762 0.078124 .  
beachHuntington        0.53458    0.18332   2.916 0.003544 ** 
beachSilver           -0.32043    0.12601  -2.543 0.010994 *  
beachWashington Park  -0.01317    0.14541  -0.091 0.927809    
beachWest              0.36404    0.14134   2.576 0.010004 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5566.3  on 20797  degrees of freedom
Residual deviance: 5348.6  on 20779  degrees of freedom
AIC: 7146.6

Number of Fisher Scoring iterations: 12



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.373438   0.141149 -23.8999 < 2.2e-16 ***
entero35               0.140345   0.095386   1.4713 0.1412006    
female                 0.162292   0.064030   2.5346 0.0112566 *  
racewhiteYes           0.025904   0.110274   0.2349 0.8142848    
racewhiteMissing      -0.328325   0.589584  -0.5569 0.5776122    
gichronYes             0.626846   0.136357   4.5971 4.284e-06 ***
gichronMissing       -11.121044   0.392971 -28.2999 < 2.2e-16 ***
anim_anyYes            0.244203   0.081525   2.9954 0.0027405 ** 
gicontactbaseYes       0.725761   0.116412   6.2344 4.534e-10 ***
gicontactbaseMissing   0.845793   0.371875   2.2744 0.0229417 *  
rawfood                0.393791   0.082015   4.8015 1.575e-06 ***
beachBoqueron         -0.552056   0.152980  -3.6087 0.0003078 ***
beachEdgewater         0.159968   0.211083   0.7578 0.4485434    
beachFairhope          0.176940   0.207372   0.8532 0.3935210    
beachGoddard          -0.392648   0.239274  -1.6410 0.1007984    
beachHuntington        0.534585   0.181345   2.9479 0.0031996 ** 
beachSilver           -0.320426   0.130049  -2.4639 0.0137442 *  
beachWashington Park  -0.013175   0.154751  -0.0851 0.9321538    
beachWest              0.364043   0.150304   2.4220 0.0154335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Estimate adjusted CIRs
> # From the overall pooled model and
> # From stratified models
> # --------------------------------------
> 
> # function to get CIR Estimates and CIs from simple stratified models
> getCIR <- function(x) {
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# NOTE: assumes exposure of interest is the first covariate and there are no interactions
+ 	est <- exp(x[2,1])
+ 	se  <- x[2,2]	
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> 
> 
> # bind all of the CIRs together, organized by
> # non-point source vs. point source and then age, then overall
> 
> cir.all <- rbind(getCIR(nps$fit),getCIR(ps$fit),getCIR(overall.fit) )
> 
> cir.age0to4 <- rbind(getCIR(nps0to4$fit),getCIR(ps0to4$fit),getCIR(age0to4$fit) )
> 
> cir.age5to10 <- rbind(getCIR(nps5to10$fit),getCIR(ps5to10$fit),getCIR(age5to10$fit) )
> 
> cir.age11plus <- rbind(getCIR(nps11plus$fit),getCIR(ps11plus$fit),getCIR(age11plus$fit) )
> 
> 	
> colnames(cir.all) <- colnames(cir.age11plus) <- colnames(cir.age5to10) <- colnames(cir.age0to4) <- c("CIR","CIRlb","CIRub")
> rownames(cir.all) <- rownames(cir.age11plus) <- rownames(cir.age5to10) <- rownames(cir.age0to4) <-  c("Non-point source","Point source","Overall")
> 
> # --------------------------------------
> # Number of persons at risk and cases
> # by strata
> # Print results to the log
> # --------------------------------------
> N.all
     n     N
0 1697 41147
1  344  6094
> N.age0to4
    n    N
0 209 3332
1  57  583
> N.age5to10
    n    N
0 259 7440
1  76 1435
> N.age11plus
     n     N
0 1206 29820
1  209  3914
> N.nps
    n     N
0 745 17779
1  32  1003
> N.ps
    n     N
0 952 23368
1 312  5091
> N.nps0to4
   n    N
0 93 1542
1  7  105
> N.nps5to10
    n    N
0 131 3721
1   3  267
> N.nps11plus
    n     N
0 513 12328
1  22   608
> N.ps0to4
    n    N
0 116 1790
1  50  478
> N.ps5to10
    n    N
0 128 3719
1  73 1168
> N.ps11plus
    n     N
0 693 17492
1 187  3306
> 
> # --------------------------------------
> # Cumulative Incidence Estimates
> # Print results to the log
> # --------------------------------------
> ci.all
                      CI       CIlb       CIub
Entero<=35cfu 0.04124237 0.03904599 0.04356231
Entero>35cfu  0.05644897 0.05013586 0.06355702
> ci.0to4
                      CI       CIlb       CIub
Entero<=35cfu 0.06272509 0.05450097 0.07219022
Entero>35cfu  0.09777015 0.07526337 0.12700737
> ci.5to10
                      CI       CIlb       CIub
Entero<=35cfu 0.03481183 0.03050432 0.03972760
Entero>35cfu  0.05296167 0.04187209 0.06698827
> ci.11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.04044266 0.03807963 0.04295232
Entero>35cfu  0.05339806 0.04627846 0.06161296
> 
> ci.nps
                      CI       CIlb       CIub
Entero<=35cfu 0.04190337 0.03854884 0.04554981
Entero>35cfu  0.03190429 0.02185760 0.04656886
> ci.nps0to4
                      CI       CIlb      CIub
Entero<=35cfu 0.06031128 0.04878542 0.0745602
Entero>35cfu  0.06666667 0.03241715 0.1371016
> ci.nps5to10
                      CI        CIlb       CIub
Entero<=35cfu 0.03520559 0.029112151 0.04257444
Entero>35cfu  0.01123596 0.003661155 0.03448275
> ci.nps11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.04161259 0.03797618 0.04559721
Entero>35cfu  0.03618421 0.02281523 0.05738697
> 
> ci.ps
                      CI       CIlb       CIub
Entero<=35cfu 0.04073947 0.03789121 0.04380184
Entero>35cfu  0.06128462 0.05411370 0.06940580
> ci.ps0to4
                      CI     CIlb       CIub
Entero<=35cfu 0.06480447 0.053714 0.07818482
Entero>35cfu  0.10460251 0.079047 0.13842000
> ci.ps5to10
                      CI       CIlb       CIub
Entero<=35cfu 0.03441785 0.02865174 0.04134439
Entero>35cfu  0.06250000 0.04922826 0.07934975
> ci.ps11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.03961811 0.03615599 0.04341175
Entero>35cfu  0.05656382 0.03566519 0.08970837
> 
> 
> # --------------------------------------
> # Cumulative Incidence Ratios
> # Print results to the log
> # --------------------------------------
> cir.all
                       CIR     CIRlb    CIRub
Non-point source 0.9452332 0.6372104 1.402152
Point source     1.2619775 1.0771704 1.478492
Overall          1.2022676 1.0409242 1.388619
> cir.age0to4
                      CIR     CIRlb    CIRub
Non-point source 1.315473 0.6019208 2.874914
Point source     1.506078 1.0321621 2.197592
Overall          1.476553 1.0547575 2.067023
> cir.age5to10
                       CIR     CIRlb    CIRub
Non-point source 0.3574639 0.1085848 1.176781
Point source     1.5212684 1.0927655 2.117799
Overall          1.2605584 0.9408912 1.688832
> cir.age11plus
                      CIR     CIRlb    CIRub
Non-point source 1.099051 0.6883652 1.754755
Point source     1.150671 0.9544577 1.387220
Overall          1.138096 0.9572870 1.353056
> 
> 
> 
> # --------------------------------------
> # save the objects
> # --------------------------------------
> 
> save(
+ 	overall.fit,all.VC,age0to4,age5to10,age11plus,
+ 	nps,nps0to4,nps5to10,nps11plus,
+ 	ps,ps0to4,ps5to10,ps11plus,
+ 	
+ 	hufit,sifit,wpfit,wefit,avfit,bofit,dhfit,edfit,fafit,gdfit,mafit,mbfit,sufit,
+ 	
+ 	N.all,N.age0to4,N.age5to10,N.age11plus,
+ 	N.nps,N.nps0to4,N.nps5to10,N.nps11plus,
+ 	N.ps,N.ps0to4,N.ps5to10,N.ps11plus,
+ 	
+ 	ci.all,ci.0to4,ci.5to10,ci.11plus,
+ 	ci.nps,ci.nps0to4,ci.nps5to10,ci.nps11plus,
+ 	ci.ps,ci.ps0to4,ci.ps5to10,ci.ps11plus,
+ 	
+ 	cir.all,cir.age0to4,cir.age5to10,cir.age11plus,
+ 	
+ 	ps.reri, mf.reri,
+ 
+ 	file="~/dropbox/13beaches/aim1-results/rawoutput/aim1-entero1600-35cfu-regs-body.Rdata"
+ 	)
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> proc.time()
   user  system elapsed 
136.548  10.886 151.161 
