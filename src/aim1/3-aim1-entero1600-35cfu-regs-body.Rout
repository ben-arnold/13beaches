
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> 
> 
> 
> # --------------------------------------
> # 5-aim1-entero1600-35cfu-regs-body.R
> # ben arnold (benarnold@berkeley.edu)
> #
> # description:
> # estimate the association between water
> # quality indicator concentrations and
> # the risk of Diarrhea among swimmers
> # for the 13 beaches study
> #
> # Analyses are conducted for EPA 1600
> # Among Swimmers with Body Immmersion
> #
> # The exposure categories are <=35 and >35 CFU/100ml
> #
> # --------------------------------------
> 
> # --------------------------------------
> # preamble
> # --------------------------------------
> 
> rm(list=ls())
> library(sandwich)
> library(lmtest)
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

> 
> # source the base functions
> source("~/dropbox/13beaches/src/aim1/0-aim1-base-functions.R")
> 
> # --------------------------------------
> # load the and pre-preprocess the 
> # analysis dataset
> # (refer to the base functions script
> # for details on the pre-processing)
> # --------------------------------------
> 
> ad <- preprocess.13beaches("~/dropbox/13beaches/data/final/13beaches-analysis.csv")

Successfully loaded the data
 Total sample size = 84411 

Dropping individuals with GI illness at enrollment
 N = 1948 

Final sample size = 82463 

Subsetting the data to relevant variables and completing final variable pre-processing> 
> # drop individuals with no water quality information
> table(ad$nowq)

    0     1 
81531   932 
> ad <- subset(ad,nowq==0)
> dim(ad)
[1] 81531    50
> 
> # subset to non-missing exposure categories
> # to make the robust CI calcs work
> table(ad$bodycontact)

   No   Yes 
35462 46069 
> ad <- subset(ad,ad$bodycontact=="Yes")
> 	dim(ad)
[1] 46069    50
> ad <- subset(ad,is.na(ad$entero35)==FALSE)
> 	dim(ad)
[1] 46069    50
> 
> 
> # --------------------------------------
> # Calculate the actual Ns for each cell
> # and store them for plotting and tables
> # --------------------------------------
> 
> # --------------------------------------
> # Summarize 
> # the number of swimmers and number
> # of cumulative incident episodes by
> # Entero 1600 category
> # --------------------------------------
> calcNs <- function(outcome,exposurecat) {
+   n <- tapply(outcome,exposurecat,sum)
+   N <- tapply(outcome,exposurecat,function(x) length(x))
+   cbind(n,N)
+ }
> 
> # overall
> N.all <- calcNs(ad$diarrheaci10,ad$entero35)
> # age stratified
> N.age0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]"],ad$entero35[ad$agestrat=="(0, 4]"] )
> N.age5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]"],ad$entero35[ad$agestrat=="(4, 10]"] )
> N.age11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10"],ad$entero35[ad$agestrat==">10"] )
> # point source vs. non-point source stratified
> N.nps <- calcNs(ad$diarrheaci10[ad$pointsource=="No"], ad$entero35[ad$pointsource=="No"])
> N.ps  <- calcNs(ad$diarrheaci10[ad$pointsource=="Yes"],ad$entero35[ad$pointsource=="Yes"])
> # age and point source stratified
> N.nps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="No"],ad$entero35[ad$agestrat=="(0, 4]" & ad$pointsource=="No"] )
> N.nps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="No"],ad$entero35[ad$agestrat=="(4, 10]" & ad$pointsource=="No"] )
> N.nps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="No"],ad$entero35[ad$agestrat==">10" & ad$pointsource=="No"] )
> 
> N.ps0to4   <- calcNs(ad$diarrheaci10[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat=="(0, 4]" & ad$pointsource=="Yes"] )
> N.ps5to10  <- calcNs(ad$diarrheaci10[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat=="(4, 10]" & ad$pointsource=="Yes"] )
> N.ps11plus <- calcNs(ad$diarrheaci10[ad$agestrat==">10" & ad$pointsource=="Yes"],ad$entero35[ad$agestrat==">10" & ad$pointsource=="Yes"] )
> 
> 
> 
> # --------------------------------------
> # Calculate unadjusted 
> # Cumulative Incidence Rates
> # and robust 95% CIs using a saturated, 
> # unadjusted model
> # (just using the models to get the robust
> # SEs that account for HH clustering)
> # --------------------------------------
> 
> 
> #### Overall Estimates (pooled over beach type)
> 
> # All Ages
> all.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad)
> 	allci.VC <- cl(ad,fm=all.cifit,cluster=ad$hhid)
> 	allci <- coeftest(all.cifit, allci.VC)
> 	allci

z test of coefficients:

             Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.164980   0.027891 -113.4770 < 2.2e-16 ***
entero35     0.328012   0.066487    4.9335 8.079e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 0 - 4
> age0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat=="(0, 4]",])
> 	age0to4ci.VC <- cl(ad[ad$agestrat=="(0, 4]",],fm=age0to4.cifit,cluster=ad$hhid[ad$agestrat=="(0, 4]"])
> 	age0to4ci <- coeftest(age0to4.cifit, age0to4ci.VC)
> 	age0to4ci

z test of coefficients:

            Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -2.73013    0.07159 -38.1356 < 2.2e-16 ***
entero35     0.45242    0.15115   2.9932  0.002761 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages 5 - 10
> age5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat=="(4, 10]",])
> 	age5to10ci.VC <- cl(ad[ad$agestrat=="(4, 10]",],fm=age5to10.cifit,cluster=ad$hhid[ad$agestrat=="(4, 10]"])
> 	age5to10ci <- coeftest(age5to10.cifit, age5to10ci.VC)
> 	age5to10ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.319018   0.067317 -49.3042 < 2.2e-16 ***
entero35     0.424998   0.137255   3.0964  0.001959 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Ages >10
> age11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$agestrat==">10",])
> 	age11plusci.VC <- cl(ad[ad$agestrat==">10",],fm=age11plus.cifit,cluster=ad$hhid[ad$agestrat==">10"])
> 	age11plusci <- coeftest(age11plus.cifit, age11plusci.VC)
> 	age11plusci

z test of coefficients:

             Estimate Std. Error   z value  Pr(>|z|)    
(Intercept) -3.190278   0.030699 -103.9219 < 2.2e-16 ***
entero35     0.293019   0.079095    3.7046 0.0002117 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> #### Stratified Estimates by non-point source and point source beach conditions
> 
> # Non-point source - All Ages
> nps.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No",])
> 	npsci.VC <- cl(ad[ad$pointsource=="No",],fm=nps.cifit,cluster=ad$hhid[ad$pointsource=="No"])
> 	npsci <- coeftest(nps.cifit, npsci.VC)
> 	npsci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.117593   0.042458 -73.4277   <2e-16 ***
entero35    -0.074682   0.195923  -0.3812   0.7031    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 0 - 4
> nps0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",])
> 	nps0to4ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],fm=nps0to4.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(0, 4]"])
> 	nps0to4ci <- coeftest(nps0to4.cifit, nps0to4ci.VC)
> 	nps0to4ci

z test of coefficients:

            Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -2.72229    0.10785 -25.2412   <2e-16 ***
entero35     0.31149    0.37966   0.8204    0.412    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages 5 - 10
> nps5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",])
> 	nps5to10ci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],fm=nps5to10.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat=="(4, 10]"])
> 	nps5to10ci <- coeftest(nps5to10.cifit, nps5to10ci.VC)
> 	nps5to10ci

z test of coefficients:

             Estimate Std. Error  z value Pr(>|z|)    
(Intercept) -3.267448   0.096741 -33.7754  < 2e-16 ***
entero35    -0.956950   0.578375  -1.6545  0.09802 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source - Ages >10
> nps11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="No" & ad$agestrat==">10",])
> 	nps11plusci.VC <- cl(ad[ad$pointsource=="No" & ad$agestrat==">10",],fm=nps11plus.cifit,cluster=ad$hhid[ad$pointsource=="No" & ad$agestrat==">10"])
> 	nps11plusci <- coeftest(nps11plus.cifit, nps11plusci.VC)
> 	nps11plusci

z test of coefficients:

             Estimate Std. Error z value Pr(>|z|)    
(Intercept) -3.136257   0.046576 -67.336   <2e-16 ***
entero35     0.049355   0.238402   0.207    0.836    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # Point source	- All Ages
> ps.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes",])
> 	psci.VC <- cl(ad[ad$pointsource=="Yes",],fm=ps.cifit,cluster=ad$hhid[ad$pointsource=="Yes"])
> 	psci <- coeftest(ps.cifit, psci.VC)
> 	psci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.200558   0.036979 -86.5513 < 2.2e-16 ***
entero35     0.408331   0.073474   5.5575 2.737e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 0 - 4
> ps0to4.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",])
> 	ps0to4ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],fm=ps0to4.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]"])
> 	ps0to4ci <- coeftest(ps0to4.cifit, ps0to4ci.VC)
> 	ps0to4ci

z test of coefficients:

             Estimate Std. Error z value  Pr(>|z|)    
(Intercept) -2.736381   0.095766 -28.574 < 2.2e-16 ***
entero35     0.478793   0.172039   2.783  0.005385 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages 5 - 10
> ps5to10.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",])
> 	ps5to10ci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],fm=ps5to10.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]"])
> 	ps5to10ci <- coeftest(ps5to10.cifit, ps5to10ci.VC)
> 	ps5to10ci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.369180   0.093552 -36.0141 < 2.2e-16 ***
entero35     0.596591   0.153569   3.8848 0.0001024 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point source - Ages >10
> ps11plus.cifit <- glm(diarrheaci10~entero35,family=poisson(link="log"),data=ad[ad$pointsource=="Yes" & ad$agestrat==">10",])
> 	ps11plusci.VC <- cl(ad[ad$pointsource=="Yes" & ad$agestrat==">10",],fm=ps11plus.cifit,cluster=ad$hhid[ad$pointsource=="Yes" & ad$agestrat==">10"])
> 	ps11plusci <- coeftest(ps11plus.cifit, ps11plusci.VC)
> 	ps11plusci

z test of coefficients:

             Estimate Std. Error  z value  Pr(>|z|)    
(Intercept) -3.228469   0.040799 -79.1319 < 2.2e-16 ***
entero35     0.356083   0.086838   4.1005 4.122e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # function to get Estimates and CIs from a linear combination of regression coefficients
> lccalc <- function(lc,x,vcv) {
+ 	# lc : linear combination of coefficients
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# vcv : variance-covariance matrix of coefficients for robust SEs
+ 	est <- exp(t(lc)%*%x[,1])
+ 	se  <- sqrt( t(lc)%*%vcv%*%lc )
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> getCI <- function(fit,vcv) {
+ 	# fit : an object returned from coeftest w/ 2 parameters corresponding to <=35/>35 CFU cumulative incidence
+ 	# vcv : variance-covariance matrix for coefficients in the fit object
+ 	lc1 <- lc2 <- rep(0,nrow(fit))
+ 	lc1[c(1)  ] <- 1
+ 	lc2[c(1,2)] <- 1
+ 	lcs <- list(lc1,lc2)
+ 	res <- t(sapply(lcs,lccalc,x=fit,vcv=vcv))
+ 	colnames(res) <- c("CI","CIlb","CIub")
+ 	rownames(res) <- c("Entero<=35cfu","Entero>35cfu")
+ 	return(res)
+ }
> 
> 
> ci.all    <- getCI(allci,allci.VC)
> ci.0to4   <- getCI(age0to4ci,age0to4ci.VC)
> ci.5to10  <- getCI(age5to10ci,age5to10ci.VC)
> ci.11plus <- getCI(age11plusci,age11plusci.VC)
> 
> ci.nps       <- getCI(npsci,npsci.VC)
> ci.nps0to4   <- getCI(nps0to4ci,nps0to4ci.VC)
> ci.nps5to10  <- getCI(nps5to10ci,nps5to10ci.VC)
> ci.nps11plus <- getCI(nps11plusci,nps11plusci.VC)
> 
> ci.ps       <- getCI(psci,psci.VC)
> ci.ps0to4   <- getCI(ps0to4ci,ps0to4ci.VC)
> ci.ps5to10  <- getCI(ps5to10ci,ps5to10ci.VC)
> ci.ps11plus <- getCI(ps11plusci,nps11plusci.VC)
> 
> 
> 
> # --------------------------------------
> # esimate risk of Diarrhea associated
> # with exposure to EPA 1600 above/below 35 CFU/100ml
> # Body Immersion
> # All ages
> # --------------------------------------
> 
> 
> 
> # tests of interaction by environmental conditions for Avalon and Doheny
> av.h.noint <-glm(diarrheaci10~ entero35+groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> av.h <-glm(diarrheaci10~ entero35*groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Avalon",])
> 	lrtest(av.h.noint,av.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero35 * groundwater + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df Chisq Pr(>Chisq)  
1  20 -777.01                      
2  21 -774.54  1 4.944    0.02618 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> dh.h.noint <-glm(diarrheaci10~ entero35+berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> dh.h <-glm(diarrheaci10~ entero35*berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,family=poisson(link="log"),data=ad[ad$beach=="Doheny",])
> 	lrtest(dh.h.noint,dh.h)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
Model 2: diarrheaci10 ~ entero35 * berm + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood
  #Df  LogLik Df  Chisq Pr(>Chisq)  
1  19 -723.27                       
2  20 -721.87  1 2.7967    0.09446 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> # --------------------------------------
> # Freshwater beaches
> 
> # Huntington
> hufit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Huntington",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8225  -0.4824  -0.4424  -0.3165   2.2641  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)      -2.995e+00  6.010e-01  -4.984 6.24e-07 ***
entero35          1.915e-01  2.544e-01   0.753   0.4516    
agecat5-14        6.269e-03  3.827e-01   0.016   0.9869    
agecat15-24      -1.124e+00  6.677e-01  -1.684   0.0922 .  
agecat25-34      -1.670e-01  4.726e-01  -0.353   0.7238    
agecat35-44       3.721e-01  4.202e-01   0.885   0.3759    
agecat45-54      -2.840e-01  5.606e-01  -0.507   0.6124    
agecat55-64      -7.817e-01  1.057e+00  -0.739   0.4598    
agecat65-74      -1.535e+01  1.301e+03  -0.012   0.9906    
agecat75+        -1.515e+01  3.468e+03  -0.004   0.9965    
agecatMissing     8.816e-01  7.861e-01   1.121   0.2621    
female            1.684e-01  2.342e-01   0.719   0.4719    
racewhiteYes      4.174e-01  4.705e-01   0.887   0.3751    
racewhiteMissing -1.439e+01  3.468e+03  -0.004   0.9967    
gichronYes       -1.517e+01  9.299e+02  -0.016   0.9870    
anim_anyYes       2.523e-01  3.458e-01   0.730   0.4656    
gicontactbaseYes  1.446e-01  7.220e-01   0.200   0.8413    
rawfood           4.091e-01  3.615e-01   1.132   0.2577    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 340.98  on 740  degrees of freedom
Residual deviance: 322.22  on 723  degrees of freedom
AIC: 506.22

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                    Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.9952760   0.6385812  -4.6905 2.725e-06 ***
entero35           0.1915343   0.2883168   0.6643   0.50649    
agecat5-14         0.0062686   0.3722546   0.0168   0.98656    
agecat15-24       -1.1243661   0.6723721  -1.6722   0.09448 .  
agecat25-34       -0.1670200   0.4889526  -0.3416   0.73266    
agecat35-44        0.3720959   0.4069550   0.9143   0.36054    
agecat45-54       -0.2840287   0.5704661  -0.4979   0.61856    
agecat55-64       -0.7816672   1.0685549  -0.7315   0.46446    
agecat65-74      -15.3508075   0.6177833 -24.8482 < 2.2e-16 ***
agecat75+        -15.1454048   1.0771118 -14.0611 < 2.2e-16 ***
agecatMissing      0.8815881   0.8785539   1.0035   0.31564    
female             0.1684414   0.2177656   0.7735   0.43923    
racewhiteYes       0.4173534   0.5704819   0.7316   0.46442    
racewhiteMissing -14.3925900   1.2180921 -11.8157 < 2.2e-16 ***
gichronYes       -15.1695709   0.5209419 -29.1195 < 2.2e-16 ***
anim_anyYes        0.2523009   0.4455815   0.5662   0.57124    
gicontactbaseYes   0.1445831   0.6709879   0.2155   0.82939    
rawfood            0.4091165   0.4621125   0.8853   0.37599    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Silver
> sifit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Silver",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7081  -0.3184  -0.2778  -0.2558   2.5046  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.32250    0.28741 -11.560  < 2e-16 ***
entero35                0.13667    0.13036   1.048  0.29443    
agecat5-14             -0.57427    0.21546  -2.665  0.00769 ** 
agecat15-24            -0.71103    0.24567  -2.894  0.00380 ** 
agecat25-34            -0.34823    0.25930  -1.343  0.17927    
agecat35-44            -0.04906    0.22494  -0.218  0.82735    
agecat45-54            -0.35907    0.28604  -1.255  0.20936    
agecat55-64            -0.39101    0.41890  -0.933  0.35060    
agecat65-74           -14.45946  542.51235  -0.027  0.97874    
agecat75+             -14.85577 1955.27567  -0.008  0.99394    
agecatMissing          -0.79765    0.44510  -1.792  0.07312 .  
female                  0.16511    0.12990   1.271  0.20372    
racewhiteYes            0.09714    0.20875   0.465  0.64170    
racewhiteMissing        0.26864    1.02334   0.263  0.79292    
gichronYes              0.56442    0.32905   1.715  0.08629 .  
gichronMissing        -14.06593 1082.89691  -0.013  0.98964    
anim_anyYes             0.37954    0.18426   2.060  0.03942 *  
gicontactbaseYes        0.20327    0.26872   0.756  0.44939    
gicontactbaseMissing    1.09203    1.01284   1.078  0.28095    
rawfood                 0.13630    0.17254   0.790  0.42954    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1520.8  on 5553  degrees of freedom
Residual deviance: 1485.9  on 5534  degrees of freedom
AIC: 2011.9

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.322504   0.306647 -10.8349 < 2.2e-16 ***
entero35               0.136673   0.141668   0.9647  0.334675    
agecat5-14            -0.574269   0.222018  -2.5866  0.009693 ** 
agecat15-24           -0.711027   0.250449  -2.8390  0.004525 ** 
agecat25-34           -0.348234   0.273514  -1.2732  0.202952    
agecat35-44           -0.049060   0.227411  -0.2157  0.829195    
agecat45-54           -0.359073   0.286902  -1.2516  0.210733    
agecat55-64           -0.391014   0.418872  -0.9335  0.350565    
agecat65-74          -14.459460   0.269264 -53.7000 < 2.2e-16 ***
agecat75+            -14.855770   0.693097 -21.4339 < 2.2e-16 ***
agecatMissing         -0.797647   0.560511  -1.4231  0.154716    
female                 0.165107   0.129983   1.2702  0.204009    
racewhiteYes           0.097137   0.247162   0.3930  0.694312    
racewhiteMissing       0.268644   0.857343   0.3133  0.754019    
gichronYes             0.564420   0.325356   1.7348  0.082781 .  
gichronMissing       -14.065934   0.578740 -24.3044 < 2.2e-16 ***
anim_anyYes            0.379537   0.210732   1.8010  0.071697 .  
gicontactbaseYes       0.203267   0.267093   0.7610  0.446636    
gicontactbaseMissing   1.092031   0.723250   1.5099  0.131071    
rawfood                0.136304   0.176495   0.7723  0.439949    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Washington Park
> wpfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Washington Park",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8909  -0.3528  -0.3026  -0.2517   2.6015  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.1299     0.3679  -8.507  < 2e-16 ***
entero35                0.2434     0.1882   1.293  0.19599    
agecat5-14             -0.5285     0.3110  -1.699  0.08929 .  
agecat15-24            -1.2913     0.4849  -2.663  0.00775 ** 
agecat25-34             0.2224     0.3289   0.676  0.49886    
agecat35-44            -0.2040     0.3405  -0.599  0.54911    
agecat45-54            -0.2808     0.3906  -0.719  0.47227    
agecat55-64             0.5578     0.4018   1.388  0.16505    
agecat65-74            -0.2970     1.0349  -0.287  0.77415    
agecat75+             -14.5569  1408.6727  -0.010  0.99176    
agecatMissing          -1.7724     1.0338  -1.714  0.08645 .  
female                  0.1042     0.1805   0.577  0.56377    
racewhiteYes            0.1094     0.2484   0.441  0.65952    
racewhiteMissing      -11.8345  1350.9720  -0.009  0.99301    
gichronYes              0.4908     0.4629   1.060  0.28904    
gichronMissing        -12.9908  3467.8586  -0.004  0.99701    
anim_anyYes             0.3175     0.2576   1.232  0.21780    
gicontactbaseYes        0.7181     0.2904   2.473  0.01340 *  
gicontactbaseMissing  -13.6801  1058.3628  -0.013  0.98969    
rawfood                -0.2022     0.2816  -0.718  0.47266    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 733.22  on 2311  degrees of freedom
Residual deviance: 691.42  on 2292  degrees of freedom
AIC: 983.42

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.12993    0.36424  -8.5930 < 2.2e-16 ***
entero35               0.24337    0.21631   1.1251  0.260549    
agecat5-14            -0.52848    0.30726  -1.7200  0.085434 .  
agecat15-24           -1.29126    0.47330  -2.7282  0.006368 ** 
agecat25-34            0.22240    0.30590   0.7270  0.467211    
agecat35-44           -0.20397    0.33069  -0.6168  0.537380    
agecat45-54           -0.28076    0.36799  -0.7630  0.445487    
agecat55-64            0.55779    0.36915   1.5110  0.130788    
agecat65-74           -0.29696    1.01416  -0.2928  0.769662    
agecat75+            -14.55688    0.58389 -24.9310 < 2.2e-16 ***
agecatMissing         -1.77240    1.00736  -1.7594  0.078502 .  
female                 0.10421    0.16718   0.6233  0.533061    
racewhiteYes           0.10943    0.26114   0.4191  0.675169    
racewhiteMissing     -11.83447    0.88275 -13.4064 < 2.2e-16 ***
gichronYes             0.49076    0.52290   0.9385  0.347970    
gichronMissing       -12.99083    1.10387 -11.7684 < 2.2e-16 ***
anim_anyYes            0.31746    0.26624   1.1924  0.233103    
gicontactbaseYes       0.71807    0.29791   2.4104  0.015935 *  
gicontactbaseMissing -13.68006    0.70425 -19.4251 < 2.2e-16 ***
rawfood               -0.20223    0.26763  -0.7556  0.449869    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # West
> wefit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="West",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9902  -0.4235  -0.3336  -0.2615   2.4568  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.31108    0.38855  -8.522  < 2e-16 ***
entero35                0.36414    0.21493   1.694  0.09022 .  
agecat5-14             -0.62114    0.33247  -1.868  0.06173 .  
agecat15-24            -0.79684    0.33165  -2.403  0.01628 *  
agecat25-34            -0.06450    0.33021  -0.195  0.84514    
agecat35-44            -0.21125    0.34719  -0.608  0.54289    
agecat45-54            -1.38325    0.53376  -2.591  0.00956 ** 
agecat55-64           -14.92987  597.85892  -0.025  0.98008    
agecat65-74            -0.03303    1.04129  -0.032  0.97470    
agecat75+             -15.33975 2443.85429  -0.006  0.99499    
agecatMissing         -14.58372 1652.85582  -0.009  0.99296    
female                  0.10837    0.18255   0.594  0.55276    
racewhiteYes            0.31858    0.24412   1.305  0.19189    
racewhiteMissing        0.69371    0.74750   0.928  0.35339    
gichronYes              1.06589    0.47082   2.264  0.02358 *  
gichronMissing        -15.26546 3467.85855  -0.004  0.99649    
anim_anyYes             0.79204    0.26180   3.025  0.00248 ** 
gicontactbaseYes        1.37926    0.33978   4.059 4.92e-05 ***
gicontactbaseMissing    1.52014    0.59989   2.534  0.01128 *  
rawfood                 0.67612    0.23889   2.830  0.00465 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 645.05  on 1649  degrees of freedom
Residual deviance: 582.78  on 1630  degrees of freedom
AIC: 872.78

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.311082   0.404170  -8.1923 2.563e-16 ***
entero35               0.364137   0.247008   1.4742  0.140430    
agecat5-14            -0.621142   0.339358  -1.8303  0.067198 .  
agecat15-24           -0.796837   0.334095  -2.3851  0.017076 *  
agecat25-34           -0.064499   0.315637  -0.2043  0.838083    
agecat35-44           -0.211251   0.331767  -0.6367  0.524291    
agecat45-54           -1.383246   0.516392  -2.6787  0.007391 ** 
agecat55-64          -14.929871   0.392973 -37.9921 < 2.2e-16 ***
agecat65-74           -0.033029   0.880278  -0.0375  0.970069    
agecat75+            -15.339752   0.778837 -19.6957 < 2.2e-16 ***
agecatMissing        -14.583716   0.642858 -22.6858 < 2.2e-16 ***
female                 0.108368   0.166176   0.6521  0.514318    
racewhiteYes           0.318581   0.244954   1.3006  0.193404    
racewhiteMissing       0.693710   0.817739   0.8483  0.396256    
gichronYes             1.065891   0.339468   3.1399  0.001690 ** 
gichronMissing       -15.265464   1.072438 -14.2344 < 2.2e-16 ***
anim_anyYes            0.792036   0.265938   2.9783  0.002899 ** 
gicontactbaseYes       1.379256   0.342807   4.0234 5.736e-05 ***
gicontactbaseMissing   1.520137   0.409834   3.7092  0.000208 ***
rawfood                0.676119   0.266094   2.5409  0.011057 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # --------------------------------------
> # Marine beaches
> 
> # Avalon
> avfit <- mpreg(diarrheaci10~entero35 +groundwater +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Avalon",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0590  -0.3563  -0.2945  -0.2582   2.3222  

Coefficients:
                              Estimate Std. Error z value Pr(>|z|)    
(Intercept)                   -2.26815    0.26324  -8.616  < 2e-16 ***
entero35                       0.21647    0.14451   1.498  0.13416    
groundwaterAbove median flow  -0.17979    0.14326  -1.255  0.20947    
agecat5-14                    -1.07237    0.23605  -4.543 5.55e-06 ***
agecat15-24                   -1.19096    0.30515  -3.903 9.51e-05 ***
agecat25-34                   -0.75533    0.28531  -2.647  0.00811 ** 
agecat35-44                   -0.43016    0.24530  -1.754  0.07950 .  
agecat45-54                   -0.76809    0.27227  -2.821  0.00479 ** 
agecat55-64                   -1.21180    0.38942  -3.112  0.00186 ** 
agecat65-74                   -1.07771    0.73512  -1.466  0.14264    
agecat75+                    -14.10753  576.14169  -0.024  0.98046    
agecatMissing                -14.04117  769.03638  -0.018  0.98543    
female                        -0.06032    0.14007  -0.431  0.66675    
racewhiteYes                   0.02842    0.16699   0.170  0.86484    
racewhiteMissing              -0.67721    0.72290  -0.937  0.34887    
gichronYes                     0.81844    0.33100   2.473  0.01341 *  
anim_anyYes                    0.11681    0.16102   0.725  0.46818    
gicontactbaseYes               0.62592    0.22283   2.809  0.00497 ** 
gicontactbaseMissing          -0.36207    1.00478  -0.360  0.71859    
rawfood                        0.31376    0.16572   1.893  0.05832 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1194.7  on 3742  degrees of freedom
Residual deviance: 1142.0  on 3723  degrees of freedom
AIC: 1594

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                               Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)                   -2.268146   0.289530  -7.8339 4.730e-15 ***
entero35                       0.216470   0.160252   1.3508  0.176756    
groundwaterAbove median flow  -0.179792   0.162016  -1.1097  0.267121    
agecat5-14                    -1.072372   0.239329  -4.4807 7.438e-06 ***
agecat15-24                   -1.190956   0.303798  -3.9202 8.847e-05 ***
agecat25-34                   -0.755332   0.267692  -2.8216  0.004778 ** 
agecat35-44                   -0.430159   0.241655  -1.7801  0.075068 .  
agecat45-54                   -0.768091   0.276600  -2.7769  0.005488 ** 
agecat55-64                   -1.211802   0.374508  -3.2357  0.001213 ** 
agecat65-74                   -1.077707   0.719023  -1.4988  0.133913    
agecat75+                    -14.107530   0.345001 -40.8913 < 2.2e-16 ***
agecatMissing                -14.041168   0.462122 -30.3841 < 2.2e-16 ***
female                        -0.060316   0.133516  -0.4517  0.651450    
racewhiteYes                   0.028424   0.184286   0.1542  0.877421    
racewhiteMissing              -0.677208   0.675166  -1.0030  0.315849    
gichronYes                     0.818443   0.321493   2.5458  0.010904 *  
anim_anyYes                    0.116807   0.177666   0.6575  0.510890    
gicontactbaseYes               0.625924   0.240630   2.6012  0.009290 ** 
gicontactbaseMissing          -0.362067   0.987732  -0.3666  0.713944    
rawfood                        0.313756   0.163818   1.9153  0.055458 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Boqueron
> bofit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Boqueron",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1644  -0.2482  -0.2235  -0.2059   2.5027  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -3.16344    0.17692 -17.880  < 2e-16 ***
entero35                     NA         NA      NA       NA    
agecat5-14             -0.95211    0.21102  -4.512 6.43e-06 ***
agecat15-24            -0.66627    0.20006  -3.330 0.000868 ***
agecat25-34            -0.52678    0.19673  -2.678 0.007414 ** 
agecat35-44            -0.77023    0.21237  -3.627 0.000287 ***
agecat45-54            -0.75823    0.23181  -3.271 0.001072 ** 
agecat55-64            -0.61457    0.28480  -2.158 0.030938 *  
agecat65-74            -0.95120    0.47525  -2.001 0.045343 *  
agecat75+             -13.37797  321.23614  -0.042 0.966781    
agecatMissing          -0.72156    0.52458  -1.375 0.168978    
female                  0.06756    0.10792   0.626 0.531275    
racewhiteYes            0.82688    0.58167   1.422 0.155151    
racewhiteMissing        2.33860    0.71994   3.248 0.001161 ** 
gichronYes              0.53441    0.20330   2.629 0.008574 ** 
gichronMissing        -12.44848 2103.36254  -0.006 0.995278    
anim_anyYes             0.21016    0.10955   1.918 0.055064 .  
gicontactbaseYes        0.94758    0.17537   5.403 6.54e-08 ***
gicontactbaseMissing  -12.66941 1204.77312  -0.011 0.991610    
rawfood                 0.31851    0.13914   2.289 0.022072 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2487.4  on 11878  degrees of freedom
Residual deviance: 2402.4  on 11860  degrees of freedom
AIC: 3148.4

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.163437   0.185180 -17.0831 < 2.2e-16 ***
agecat5-14            -0.952113   0.207684  -4.5844 4.552e-06 ***
agecat15-24           -0.666267   0.206727  -3.2229 0.0012689 ** 
agecat25-34           -0.526778   0.188029  -2.8016 0.0050854 ** 
agecat35-44           -0.770235   0.210440  -3.6601 0.0002521 ***
agecat45-54           -0.758231   0.235697  -3.2170 0.0012955 ** 
agecat55-64           -0.614566   0.282748  -2.1736 0.0297389 *  
agecat65-74           -0.951199   0.470422  -2.0220 0.0431749 *  
agecat75+            -13.377974   0.232820 -57.4605 < 2.2e-16 ***
agecatMissing         -0.721560   0.518054  -1.3928 0.1636718    
female                 0.067562   0.101737   0.6641 0.5066367    
racewhiteYes           0.826884   0.707753   1.1683 0.2426769    
racewhiteMissing       2.338603   0.604465   3.8689 0.0001093 ***
gichronYes             0.534407   0.203199   2.6300 0.0085393 ** 
gichronMissing       -12.448480   1.020161 -12.2025 < 2.2e-16 ***
anim_anyYes            0.210158   0.122222   1.7195 0.0855285 .  
gicontactbaseYes       0.947576   0.185077   5.1199 3.057e-07 ***
gicontactbaseMissing -12.669408   0.612171 -20.6959 < 2.2e-16 ***
rawfood                0.318506   0.142677   2.2324 0.0255915 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Doheny
> dhfit <- mpreg(diarrheaci10~entero35 +berm +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Doheny",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7461  -0.3221  -0.2641  -0.2383   2.6214  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.70577    0.24124 -11.216  < 2e-16 ***
entero35               0.29432    0.35744   0.823 0.410266    
bermOpen              -0.14328    0.20496  -0.699 0.484518    
agecat5-14            -0.89510    0.23061  -3.881 0.000104 ***
agecat15-24           -0.82918    0.31482  -2.634 0.008442 ** 
agecat25-34           -0.43411    0.29429  -1.475 0.140187    
agecat35-44           -0.43193    0.26446  -1.633 0.102414    
agecat45-54           -0.49820    0.29914  -1.665 0.095827 .  
agecat55-64           -1.90999    0.73552  -2.597 0.009410 ** 
agecat65-74           -0.28268    1.02060  -0.277 0.781802    
agecatMissing        -13.87502  557.72002  -0.025 0.980152    
female                -0.02391    0.15418  -0.155 0.876748    
racewhiteYes           0.20301    0.17124   1.186 0.235803    
racewhiteMissing       0.06295    0.59644   0.106 0.915947    
gichronYes             0.95391    0.39297   2.427 0.015205 *  
anim_anyYes           -0.14297    0.19512  -0.733 0.463716    
gicontactbaseYes       0.50991    0.30205   1.688 0.091375 .  
gicontactbaseMissing   0.78292    0.45682   1.714 0.086552 .  
rawfood                0.21583    0.18883   1.143 0.253066    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1125.4  on 4149  degrees of freedom
Residual deviance: 1088.5  on 4131  degrees of freedom
AIC: 1484.5

Number of Fisher Scoring iterations: 14



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.705771   0.236662 -11.4331 < 2.2e-16 ***
entero35               0.294325   0.379795   0.7750  0.438365    
bermOpen              -0.143279   0.240631  -0.5954  0.551557    
agecat5-14            -0.895100   0.224214  -3.9922 6.547e-05 ***
agecat15-24           -0.829180   0.306361  -2.7065  0.006799 ** 
agecat25-34           -0.434107   0.277614  -1.5637  0.117886    
agecat35-44           -0.431929   0.251858  -1.7150  0.086350 .  
agecat45-54           -0.498203   0.284215  -1.7529  0.079617 .  
agecat55-64           -1.909985   0.723924  -2.6384  0.008330 ** 
agecat65-74           -0.282677   0.978720  -0.2888  0.772717    
agecatMissing        -13.875016   0.379152 -36.5949 < 2.2e-16 ***
female                -0.023913   0.158693  -0.1507  0.880224    
racewhiteYes           0.203015   0.186719   1.0873  0.276917    
racewhiteMissing       0.062948   0.572975   0.1099  0.912519    
gichronYes             0.953914   0.370765   2.5728  0.010087 *  
anim_anyYes           -0.142974   0.208752  -0.6849  0.493406    
gicontactbaseYes       0.509912   0.304214   1.6762  0.093707 .  
gicontactbaseMissing   0.782925   0.387015   2.0230  0.043075 *  
rawfood                0.215825   0.199109   1.0840  0.278385    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Edgewater
> edfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Edgewater",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7752  -0.3736  -0.3094  -0.2571   2.3384  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.78287    0.52182  -5.333 9.66e-08 ***
entero35            0.72624    0.42794   1.697   0.0897 .  
agecat5-14         -0.92666    0.60859  -1.523   0.1278    
agecat15-24        -0.25656    0.54800  -0.468   0.6397    
agecat25-34        -0.34871    0.56270  -0.620   0.5354    
agecat35-44        -0.71417    0.64046  -1.115   0.2648    
agecat45-54         0.24995    0.61920   0.404   0.6865    
agecat55-64       -15.72771 1576.95495  -0.010   0.9920    
agecat65-74         1.39080    1.12972   1.231   0.2183    
agecat75+         -15.98573 5717.53216  -0.003   0.9978    
agecatMissing     -15.81014 1295.50547  -0.012   0.9903    
female             -0.08897    0.31199  -0.285   0.7755    
racewhiteYes        0.29991    0.37689   0.796   0.4262    
gichronYes          0.97558    0.74849   1.303   0.1924    
gichronMissing    -16.37072 5717.53217  -0.003   0.9977    
anim_anyYes         0.16610    0.37238   0.446   0.6556    
gicontactbaseYes    0.73370    0.54002   1.359   0.1743    
rawfood            -0.25047    0.43313  -0.578   0.5631    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 242.47  on 720  degrees of freedom
Residual deviance: 224.34  on 703  degrees of freedom
AIC: 346.34

Number of Fisher Scoring iterations: 16



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                  Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.78287    0.51717  -5.3809  7.41e-08 ***
entero35           0.72623    0.41598   1.7458   0.08084 .  
agecat5-14        -0.92666    0.59985  -1.5448   0.12239    
agecat15-24       -0.25656    0.53853  -0.4764   0.63378    
agecat25-34       -0.34871    0.56488  -0.6173   0.53702    
agecat35-44       -0.71417    0.63142  -1.1311   0.25803    
agecat45-54        0.24995    0.59146   0.4226   0.67259    
agecat55-64      -15.72771    0.53270 -29.5244 < 2.2e-16 ***
agecat65-74        1.39080    0.92540   1.5029   0.13286    
agecat75+        -15.98573    1.08305 -14.7599 < 2.2e-16 ***
agecatMissing    -15.81014    0.60220 -26.2538 < 2.2e-16 ***
female            -0.08897    0.30824  -0.2886   0.77286    
racewhiteYes       0.29991    0.38852   0.7719   0.44015    
gichronYes         0.97558    0.61360   1.5899   0.11185    
gichronMissing   -16.37072    1.19924 -13.6509 < 2.2e-16 ***
anim_anyYes        0.16610    0.38260   0.4341   0.66418    
gicontactbaseYes   0.73370    0.52042   1.4098   0.15859    
rawfood           -0.25047    0.42447  -0.5901   0.55514    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Fairhope
> fafit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Fairhope",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9813  -0.3575  -0.3215  -0.2936   2.1376  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.6708     0.4185  -6.383 1.74e-10 ***
entero35                0.2195     0.2949   0.744  0.45676    
agecat5-14             -0.5749     0.3733  -1.540  0.12348    
agecat15-24            -0.6238     0.5310  -1.175  0.24009    
agecat25-34            -0.4529     0.4747  -0.954  0.34000    
agecat35-44            -0.4867     0.5849  -0.832  0.40539    
agecat45-54            -0.5134     0.6484  -0.792  0.42852    
agecat55-64            -0.2167     1.0522  -0.206  0.83685    
agecat65-74             0.3218     1.0439   0.308  0.75791    
agecat75+             -12.8354   902.0943  -0.014  0.98865    
female                  0.2832     0.2876   0.984  0.32487    
racewhiteYes           -0.2435     0.3417  -0.712  0.47622    
gichronYes              0.6374     1.0273   0.620  0.53496    
anim_anyYes             0.1639     0.3483   0.471  0.63798    
gicontactbaseYes        1.3357     0.4583   2.914  0.00356 ** 
gicontactbaseMissing  -12.1716  1275.7543  -0.010  0.99239    
rawfood                 0.1811     0.3847   0.471  0.63775    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 281.8  on 807  degrees of freedom
Residual deviance: 269.2  on 791  degrees of freedom
AIC: 405.2

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.67081    0.47279  -5.6491 1.613e-08 ***
entero35               0.21949    0.34626   0.6339   0.52616    
agecat5-14            -0.57494    0.37554  -1.5310   0.12577    
agecat15-24           -0.62382    0.52373  -1.1911   0.23361    
agecat25-34           -0.45290    0.45514  -0.9951   0.31969    
agecat35-44           -0.48667    0.52993  -0.9184   0.35843    
agecat45-54           -0.51336    0.64221  -0.7994   0.42407    
agecat55-64           -0.21667    1.11808  -0.1938   0.84634    
agecat65-74            0.32176    0.95911   0.3355   0.73726    
agecat75+            -12.83538    0.79699 -16.1049 < 2.2e-16 ***
female                 0.28317    0.28699   0.9867   0.32380    
racewhiteYes          -0.24346    0.33431  -0.7282   0.46647    
gichronYes             0.63737    0.97356   0.6547   0.51267    
anim_anyYes            0.16390    0.36142   0.4535   0.65019    
gicontactbaseYes       1.33574    0.59145   2.2584   0.02392 *  
gicontactbaseMissing -12.17164    1.56203  -7.7922 6.586e-15 ***
rawfood                0.18114    0.45261   0.4002   0.68900    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Goddard
> gdfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Goddard",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6316  -0.3231  -0.2572  -0.2178   2.6918  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.80169    0.42465  -6.598 4.18e-11 ***
entero35          -15.57235 4287.71940  -0.004   0.9971    
agecat5-14         -0.85574    0.47324  -1.808   0.0706 .  
agecat15-24        -0.90211    0.60714  -1.486   0.1373    
agecat25-34        -0.35031    0.48560  -0.721   0.4707    
agecat35-44        -0.42100    0.49259  -0.855   0.3927    
agecat45-54        -2.10613    1.06163  -1.984   0.0473 *  
agecat55-64        -1.59474    1.06344  -1.500   0.1337    
agecat65-74        -0.29443    1.07299  -0.274   0.7838    
agecat75+         -16.75499 5435.23253  -0.003   0.9975    
agecatMissing     -16.70007 2844.73571  -0.006   0.9953    
female              0.19936    0.31837   0.626   0.5312    
racewhiteYes        0.17961    0.35283   0.509   0.6107    
racewhiteMissing    0.18154 7238.21886   0.000   1.0000    
gichronYes          0.91415    0.75170   1.216   0.2239    
anim_anyYes        -0.08405    0.35140  -0.239   0.8110    
gicontactbaseYes  -16.09509 1257.48999  -0.013   0.9898    
rawfood             0.40149    0.36016   1.115   0.2650    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 270.47  on 1050  degrees of freedom
Residual deviance: 251.95  on 1033  degrees of freedom
AIC: 371.95

Number of Fisher Scoring iterations: 17



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.801689   0.480163  -5.8349 5.383e-09 ***
entero35         -15.572351   1.086129 -14.3375 < 2.2e-16 ***
agecat5-14        -0.855744   0.457982  -1.8685   0.06169 .  
agecat15-24       -0.902106   0.587525  -1.5354   0.12468    
agecat25-34       -0.350308   0.416662  -0.8407   0.40049    
agecat35-44       -0.421001   0.466179  -0.9031   0.36648    
agecat45-54       -2.106131   1.076628  -1.9562   0.05044 .  
agecat55-64       -1.594738   1.075975  -1.4821   0.13831    
agecat65-74       -0.294432   1.067783  -0.2757   0.78275    
agecat75+        -16.754987   0.745061 -22.4881 < 2.2e-16 ***
agecatMissing    -16.700068   0.625930 -26.6804 < 2.2e-16 ***
female             0.199357   0.289056   0.6897   0.49039    
racewhiteYes       0.179615   0.396129   0.4534   0.65024    
racewhiteMissing   0.181544   1.176307   0.1543   0.87735    
gichronYes         0.914154   0.695975   1.3135   0.18902    
anim_anyYes       -0.084052   0.409199  -0.2054   0.83726    
gicontactbaseYes -16.095094   0.298497 -53.9205 < 2.2e-16 ***
rawfood            0.401488   0.397709   1.0095   0.31273    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Warning message:
glm.fit: fitted rates numerically 0 occurred 
> 
> # Malibu
> mafit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Malibu",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6956  -0.3410  -0.2986  -0.2818   2.5685  

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
(Intercept)        -2.77975    0.29394  -9.457  < 2e-16 ***
entero35          -14.31121  688.80419  -0.021  0.98342    
agecat5-14         -0.47024    0.31529  -1.491  0.13584    
agecat15-24        -0.42590    0.35777  -1.190  0.23388    
agecat25-34        -0.37091    0.34970  -1.061  0.28884    
agecat35-44        -0.06453    0.33115  -0.195  0.84550    
agecat45-54        -0.53674    0.40409  -1.328  0.18409    
agecat55-64        -0.55038    0.56960  -0.966  0.33392    
agecat65-74       -14.70227  735.70107  -0.020  0.98406    
agecat75+         -14.86920 1642.22326  -0.009  0.99278    
female              0.03592    0.18290   0.196  0.84428    
racewhiteYes        0.10362    0.19386   0.534  0.59300    
racewhiteMissing   -1.03485    0.72437  -1.429  0.15311    
gichronYes          1.15622    0.42731   2.706  0.00681 ** 
anim_anyYes        -0.14576    0.23548  -0.619  0.53591    
gicontactbaseYes    0.10014    0.42125   0.238  0.81210    
rawfood             0.26905    0.21468   1.253  0.21011    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 741.11  on 2501  degrees of freedom
Residual deviance: 720.37  on 2485  degrees of freedom
AIC: 1000.4

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -2.779751   0.303990  -9.1442 < 2.2e-16 ***
entero35         -14.311210   0.289019 -49.5166 < 2.2e-16 ***
agecat5-14        -0.470245   0.319529  -1.4717  0.141107    
agecat15-24       -0.425899   0.355853  -1.1968  0.231369    
agecat25-34       -0.370914   0.345806  -1.0726  0.283448    
agecat35-44       -0.064527   0.311320  -0.2073  0.835799    
agecat45-54       -0.536744   0.399192  -1.3446  0.178762    
agecat55-64       -0.550378   0.551483  -0.9980  0.318282    
agecat65-74      -14.702272   0.400090 -36.7475 < 2.2e-16 ***
agecat75+        -14.869199   0.673788 -22.0681 < 2.2e-16 ***
female             0.035924   0.179394   0.2002  0.841285    
racewhiteYes       0.103618   0.209514   0.4946  0.620909    
racewhiteMissing  -1.034852   0.721892  -1.4335  0.151707    
gichronYes         1.156217   0.418322   2.7639  0.005711 ** 
anim_anyYes       -0.145762   0.233621  -0.6239  0.532677    
gicontactbaseYes   0.100138   0.430173   0.2328  0.815927    
rawfood            0.269052   0.223235   1.2052  0.228110    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Mission Bay
> mbfit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Mission Bay",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7562  -0.3199  -0.2679  -0.2082   2.5207  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)            -2.65933    0.21876 -12.156  < 2e-16 ***
entero35               -0.33712    0.29371  -1.148  0.25104    
agecat5-14             -0.63391    0.23336  -2.716  0.00660 ** 
agecat15-24            -0.61961    0.35605  -1.740  0.08182 .  
agecat25-34            -0.29670    0.29876  -0.993  0.32066    
agecat35-44            -0.58144    0.34094  -1.705  0.08812 .  
agecat45-54            -0.06302    0.39197  -0.161  0.87227    
agecat55-64           -14.79136  706.33644  -0.021  0.98329    
agecat65-74           -14.75205 1177.25860  -0.013  0.99000    
agecat75+             -14.32732 1702.18679  -0.008  0.99328    
agecatMissing          -1.50206    1.01769  -1.476  0.13996    
female                 -0.08666    0.17463  -0.496  0.61973    
racewhiteYes            0.71143    0.20502   3.470  0.00052 ***
racewhiteMissing      -13.80606  905.94521  -0.015  0.98784    
gichronYes              0.67207    0.52120   1.289  0.19723    
anim_anyYes             0.32052    0.20488   1.564  0.11771    
gicontactbaseYes        0.26290    0.51215   0.513  0.60772    
gicontactbaseMissing    0.36545    0.42327   0.863  0.38792    
rawfood                -0.59076    0.20662  -2.859  0.00425 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 830.80  on 3021  degrees of freedom
Residual deviance: 781.98  on 3003  degrees of freedom
AIC: 1086

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.659330   0.250645 -10.6099 < 2.2e-16 ***
entero35              -0.337122   0.330481  -1.0201  0.307684    
agecat5-14            -0.633914   0.270140  -2.3466  0.018945 *  
agecat15-24           -0.619607   0.381689  -1.6233  0.104520    
agecat25-34           -0.296696   0.292492  -1.0144  0.310405    
agecat35-44           -0.581438   0.345184  -1.6844  0.092099 .  
agecat45-54           -0.063020   0.441015  -0.1429  0.886372    
agecat55-64          -14.791360   0.328535 -45.0221 < 2.2e-16 ***
agecat65-74          -14.752045   0.457647 -32.2346 < 2.2e-16 ***
agecat75+            -14.327317   0.573981 -24.9613 < 2.2e-16 ***
agecatMissing         -1.502061   0.981575  -1.5303  0.125953    
female                -0.086656   0.158307  -0.5474  0.584110    
racewhiteYes           0.711431   0.246822   2.8824  0.003947 ** 
racewhiteMissing     -13.806058   0.447108 -30.8786 < 2.2e-16 ***
gichronYes             0.672070   0.546869   1.2289  0.219094    
anim_anyYes            0.320519   0.243801   1.3147  0.188621    
gicontactbaseYes       0.262903   0.425450   0.6179  0.536615    
gicontactbaseMissing   0.365448   0.401813   0.9095  0.363088    
rawfood               -0.590762   0.207137  -2.8520  0.004344 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Surfside
> sufit <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood,dat=ad[ad$beach=="Surfside",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7651  -0.3140  -0.2756  -0.2371   2.5377  

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
(Intercept)       -3.46743    0.35898  -9.659  < 2e-16 ***
entero35           0.21406    0.32180   0.665  0.50593    
agecat5-14        -0.76135    0.23835  -3.194  0.00140 ** 
agecat15-24       -0.71368    0.24225  -2.946  0.00322 ** 
agecat25-34       -0.17599    0.23371  -0.753  0.45144    
agecat35-44       -0.34926    0.23092  -1.512  0.13042    
agecat45-54       -0.47307    0.23570  -2.007  0.04474 *  
agecat55-64       -0.27667    0.26422  -1.047  0.29504    
agecat65-74      -14.59582  284.97296  -0.051  0.95915    
agecat75+         -0.58020    1.01929  -0.569  0.56921    
agecatMissing      0.32819    0.42312   0.776  0.43795    
female             0.08813    0.10977   0.803  0.42204    
racewhiteYes       0.54559    0.30883   1.767  0.07728 .  
racewhiteMissing -14.21623  839.12948  -0.017  0.98648    
gichronYes         1.03841    0.21225   4.892 9.96e-07 ***
anim_anyYes        0.02382    0.13586   0.175  0.86084    
gicontactbaseYes   0.62549    0.19549   3.200  0.00138 ** 
rawfood            0.35474    0.12051   2.944  0.00324 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2150.7  on 7935  degrees of freedom
Residual deviance: 2066.6  on 7918  degrees of freedom
AIC: 2786.6

Number of Fisher Scoring iterations: 15



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                   Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)       -3.467430   0.430959  -8.0458 8.565e-16 ***
entero35           0.214060   0.311524   0.6871  0.491997    
agecat5-14        -0.761349   0.257371  -2.9582  0.003095 ** 
agecat15-24       -0.713684   0.243318  -2.9331  0.003356 ** 
agecat25-34       -0.175987   0.223828  -0.7863  0.431717    
agecat35-44       -0.349256   0.234320  -1.4905  0.136091    
agecat45-54       -0.473073   0.233585  -2.0253  0.042840 *  
agecat55-64       -0.276667   0.262395  -1.0544  0.291703    
agecat65-74      -14.595819   0.222426 -65.6210 < 2.2e-16 ***
agecat75+         -0.580204   1.006007  -0.5767  0.564115    
agecatMissing      0.328194   0.641574   0.5115  0.608970    
female             0.088134   0.104268   0.8453  0.397963    
racewhiteYes       0.545593   0.374060   1.4586  0.144683    
racewhiteMissing -14.216226   0.843836 -16.8471 < 2.2e-16 ***
gichronYes         1.038407   0.193130   5.3767 7.586e-08 ***
anim_anyYes        0.023817   0.156279   0.1524  0.878872    
gicontactbaseYes   0.625493   0.222981   2.8051  0.005029 ** 
rawfood            0.354740   0.123971   2.8615  0.004217 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Pooled estimates
> # (can't use the mpreg fn because we 
> # need the actual glm returned object 
> # for the LR tests)
> 
> # all beaches
> all.fit <- glm(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	all.VC <- cl(ad,fm=all.fit,cluster=ad$hhid)
> 	overall.fit <- coeftest(all.fit, all.VC)
> 	summary(all.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach, family = poisson(link = "log"), 
    data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9896  -0.3160  -0.2735  -0.2383   2.7833  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.852488   0.111097 -25.676  < 2e-16 ***
entero35               0.189830   0.066528   2.853 0.004325 ** 
agecat5-14            -0.709894   0.076830  -9.240  < 2e-16 ***
agecat15-24           -0.721094   0.087701  -8.222  < 2e-16 ***
agecat25-34           -0.314554   0.083572  -3.764 0.000167 ***
agecat35-44           -0.341214   0.082288  -4.147 3.37e-05 ***
agecat45-54           -0.517516   0.093994  -5.506 3.67e-08 ***
agecat55-64           -0.550444   0.126562  -4.349 1.37e-05 ***
agecat65-74           -1.077235   0.285073  -3.779 0.000158 ***
agecat75+             -2.005987   1.002186  -2.002 0.045326 *  
agecatMissing         -0.598791   0.210466  -2.845 0.004440 ** 
female                 0.056577   0.044576   1.269 0.204359    
racewhiteYes           0.254776   0.067882   3.753 0.000175 ***
racewhiteMissing      -0.001396   0.274524  -0.005 0.995941    
gichronYes             0.732956   0.102387   7.159 8.15e-13 ***
gichronMissing       -10.100741 120.393713  -0.084 0.933138    
anim_anyYes            0.169649   0.052851   3.210 0.001328 ** 
gicontactbaseYes       0.637221   0.081900   7.780 7.23e-15 ***
gicontactbaseMissing   0.501595   0.254015   1.975 0.048305 *  
rawfood                0.191711   0.055478   3.456 0.000549 ***
beachBoqueron         -0.408728   0.109344  -3.738 0.000185 ***
beachDoheny           -0.130544   0.105297  -1.240 0.215061    
beachEdgewater         0.102740   0.171051   0.601 0.548080    
beachFairhope          0.080098   0.159393   0.503 0.615301    
beachGoddard          -0.303210   0.173328  -1.749 0.080233 .  
beachHuntington        0.510646   0.139930   3.649 0.000263 ***
beachMalibu           -0.002131   0.117531  -0.018 0.985532    
beachMission Bay      -0.055621   0.121067  -0.459 0.645931    
beachSilver           -0.348453   0.099823  -3.491 0.000482 ***
beachSurfside         -0.318621   0.096622  -3.298 0.000975 ***
beachWashington Park  -0.094389   0.117495  -0.803 0.421774    
beachWest              0.330946   0.118170   2.801 0.005101 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12722  on 46068  degrees of freedom
Residual deviance: 12277  on 46037  degrees of freedom
AIC: 16423

Number of Fisher Scoring iterations: 11

> 	overall.fit

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.8524878   0.1235580 -23.0862 < 2.2e-16 ***
entero35               0.1898298   0.0735965   2.5793 0.0098991 ** 
agecat5-14            -0.7098939   0.0793134  -8.9505 < 2.2e-16 ***
agecat15-24           -0.7210940   0.0885144  -8.1466 3.742e-16 ***
agecat25-34           -0.3145540   0.0811489  -3.8763 0.0001061 ***
agecat35-44           -0.3412139   0.0813757  -4.1931 2.752e-05 ***
agecat45-54           -0.5175159   0.0945264  -5.4748 4.379e-08 ***
agecat55-64           -0.5504439   0.1254423  -4.3880 1.144e-05 ***
agecat65-74           -1.0772349   0.2823719  -3.8150 0.0001362 ***
agecat75+             -2.0059874   1.0001343  -2.0057 0.0448863 *  
agecatMissing         -0.5987912   0.2733847  -2.1903 0.0285034 *  
female                 0.0565766   0.0424607   1.3324 0.1827142    
racewhiteYes           0.2547765   0.0789418   3.2274 0.0012492 ** 
racewhiteMissing      -0.0013964   0.2873137  -0.0049 0.9961221    
gichronYes             0.7329559   0.0997233   7.3499 1.984e-13 ***
gichronMissing       -10.1007411   0.3492709 -28.9195 < 2.2e-16 ***
anim_anyYes            0.1696488   0.0581573   2.9171 0.0035334 ** 
gicontactbaseYes       0.6372208   0.0881041   7.2326 4.739e-13 ***
gicontactbaseMissing   0.5015952   0.2331863   2.1510 0.0314723 *  
rawfood                0.1917113   0.0589058   3.2545 0.0011358 ** 
beachBoqueron         -0.4087279   0.1266606  -3.2270 0.0012512 ** 
beachDoheny           -0.1305443   0.1176067  -1.1100 0.2669956    
beachEdgewater         0.1027402   0.1846129   0.5565 0.5778575    
beachFairhope          0.0800982   0.1790625   0.4473 0.6546440    
beachGoddard          -0.3032097   0.2059148  -1.4725 0.1408858    
beachHuntington        0.5106463   0.1570904   3.2507 0.0011514 ** 
beachMalibu           -0.0021313   0.1289523  -0.0165 0.9868134    
beachMission Bay      -0.0556210   0.1479067  -0.3761 0.7068764    
beachSilver           -0.3484528   0.1091907  -3.1912 0.0014167 ** 
beachSurfside         -0.3186207   0.1086794  -2.9317 0.0033706 ** 
beachWashington Park  -0.0943894   0.1342578  -0.7030 0.4820272    
beachWest              0.3309456   0.1333216   2.4823 0.0130533 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Interaction model with fresh v. marine beaches
> mf.ref <- glm(diarrheaci10~entero35 +marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> mf.fit <- glm(diarrheaci10~entero35*marine +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	mf.VC <- cl(ad,fm=mf.fit,cluster=ad$hhid)
> 	mf.body <- coeftest(mf.fit, mf.VC) 
> 	summary(mf.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 * marine + agecat + female + 
    racewhite + gichron + anim_any + gicontactbase + rawfood + 
    beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9931  -0.3161  -0.2732  -0.2386   2.7834  

Coefficients: (1 not defined because of singularities)
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.523831   0.125972 -20.035  < 2e-16 ***
entero35               0.200893   0.089334   2.249 0.024526 *  
marineYes             -0.322926   0.125808  -2.567 0.010264 *  
agecat5-14            -0.709890   0.076829  -9.240  < 2e-16 ***
agecat15-24           -0.721007   0.087702  -8.221  < 2e-16 ***
agecat25-34           -0.314637   0.083573  -3.765 0.000167 ***
agecat35-44           -0.341159   0.082289  -4.146 3.39e-05 ***
agecat45-54           -0.517544   0.093994  -5.506 3.67e-08 ***
agecat55-64           -0.550332   0.126563  -4.348 1.37e-05 ***
agecat65-74           -1.077087   0.285073  -3.778 0.000158 ***
agecat75+             -2.006533   1.002190  -2.002 0.045269 *  
agecatMissing         -0.599168   0.210476  -2.847 0.004417 ** 
female                 0.056507   0.044577   1.268 0.204939    
racewhiteYes           0.254509   0.067895   3.749 0.000178 ***
racewhiteMissing      -0.001628   0.274526  -0.006 0.995267    
gichronYes             0.732751   0.102393   7.156 8.29e-13 ***
gichronMissing       -10.096981 120.345907  -0.084 0.933136    
anim_anyYes            0.169704   0.052852   3.211 0.001323 ** 
gicontactbaseYes       0.637349   0.081904   7.782 7.16e-15 ***
gicontactbaseMissing   0.502067   0.254033   1.976 0.048111 *  
rawfood                0.191639   0.055479   3.454 0.000552 ***
beachBoqueron         -0.414436   0.113533  -3.650 0.000262 ***
beachDoheny           -0.135413   0.108483  -1.248 0.211942    
beachEdgewater         0.098580   0.172500   0.571 0.567675    
beachFairhope          0.079495   0.159427   0.499 0.618041    
beachGoddard          -0.308696   0.175801  -1.756 0.079099 .  
beachHuntington        0.178932   0.147634   1.212 0.225514    
beachMalibu           -0.007493   0.120987  -0.062 0.950620    
beachMission Bay      -0.059205   0.122586  -0.483 0.629120    
beachSilver           -0.681710   0.112512  -6.059 1.37e-09 ***
beachSurfside         -0.323718   0.100406  -3.224 0.001264 ** 
beachWashington Park  -0.426591   0.127413  -3.348 0.000814 ***
beachWest                    NA         NA      NA       NA    
entero35:marineYes    -0.024796   0.133883  -0.185 0.853066    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12722  on 46068  degrees of freedom
Residual deviance: 12277  on 46036  degrees of freedom
AIC: 16425

Number of Fisher Scoring iterations: 11

> 	lrtest(mf.ref,mf.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * marine + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8179.4                     
2  33 -8179.4  1 0.0343      0.853
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	mf.reri <- reri(b1=mf.body[2,1],b2=mf.body[3,1],b3=mf.body[nrow(mf.body),1],vcv=mf.VC[c(2,3,nrow(mf.VC)),c(2,3,nrow(mf.VC))])

RERI (95% CI) = -0.083 (-0.376,0.210); Pr > |z|= 0.578
> 	
> 
> # Interaction model with point v. non-point source beaches
> ps.ref <- glm(diarrheaci10~entero35+pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> ps.fit <- glm(diarrheaci10~entero35*pointsource +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	ps.VC <- cl(ad,fm=ps.fit,cluster=ad$hhid)
> 	ps.body <- coeftest(ps.fit, ps.VC) 
> 	summary(ps.fit)

Call:
glm(formula = diarrheaci10 ~ entero35 * pointsource + agecat + 
    female + racewhite + gichron + anim_any + gicontactbase + 
    rawfood + beach, family = poisson(link = "log"), data = ad)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0022  -0.3160  -0.2745  -0.2387   2.7813  

Coefficients: (1 not defined because of singularities)
                          Estimate Std. Error z value Pr(>|z|)    
(Intercept)              -3.164774   0.109043 -29.023  < 2e-16 ***
entero35                 -0.043126   0.184070  -0.234 0.814758    
pointsourceYes            0.296655   0.098048   3.026 0.002481 ** 
agecat5-14               -0.709743   0.076829  -9.238  < 2e-16 ***
agecat15-24              -0.719322   0.087711  -8.201 2.38e-16 ***
agecat25-34              -0.313040   0.083581  -3.745 0.000180 ***
agecat35-44              -0.339855   0.082296  -4.130 3.63e-05 ***
agecat45-54              -0.516830   0.093996  -5.498 3.83e-08 ***
agecat55-64              -0.549521   0.126559  -4.342 1.41e-05 ***
agecat65-74              -1.076715   0.285073  -3.777 0.000159 ***
agecat75+                -2.004807   1.002189  -2.000 0.045454 *  
agecatMissing            -0.598595   0.210469  -2.844 0.004454 ** 
female                    0.056331   0.044576   1.264 0.206332    
racewhiteYes              0.253243   0.067862   3.732 0.000190 ***
racewhiteMissing         -0.003952   0.274514  -0.014 0.988514    
gichronYes                0.733004   0.102385   7.159 8.11e-13 ***
gichronMissing          -10.087048 120.331375  -0.084 0.933194    
anim_anyYes               0.169764   0.052844   3.213 0.001316 ** 
gicontactbaseYes          0.637839   0.081899   7.788 6.80e-15 ***
gicontactbaseMissing      0.499440   0.254042   1.966 0.049302 *  
rawfood                   0.191413   0.055484   3.450 0.000561 ***
beachBoqueron            -0.394037   0.109983  -3.583 0.000340 ***
beachDoheny               0.192374   0.098610   1.951 0.051074 .  
beachEdgewater            0.114364   0.171299   0.668 0.504371    
beachFairhope             0.081737   0.159392   0.513 0.608090    
beachGoddard             -0.287515   0.173782  -1.654 0.098034 .  
beachHuntington           0.515004   0.139967   3.679 0.000234 ***
beachMalibu               0.312921   0.110972   2.820 0.004805 ** 
beachMission Bay          0.288508   0.119730   2.410 0.015968 *  
beachSilver              -0.349763   0.099824  -3.504 0.000459 ***
beachSurfside                   NA         NA      NA       NA    
beachWashington Park     -0.091894   0.117507  -0.782 0.434198    
beachWest                 0.337840   0.118281   2.856 0.004287 ** 
entero35:pointsourceYes   0.272686   0.197701   1.379 0.167807    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 12722  on 46068  degrees of freedom
Residual deviance: 12275  on 46036  degrees of freedom
AIC: 16423

Number of Fisher Scoring iterations: 11

> 	lrtest(ps.ref,ps.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * pointsource + agecat + female + racewhite + 
    gichron + anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)
1  32 -8179.4                     
2  33 -8178.4  1 2.0141     0.1558
> 	
> 	# Calculate the RERI for effect modification on the additive scale
> 	ps.reri <- reri(b1=ps.body[2,1],b2=ps.body[3,1],b3=ps.body[nrow(ps.body),1],vcv=ps.VC[c(2,3,nrow(ps.VC)),c(2,3,nrow(ps.VC))])

RERI (95% CI) = 0.389 (-0.063,0.841); Pr > |z|= 0.091
> 
> # --------------------------------------
> # Age-stratified estimates and LR tests of
> # interaction
> 
> # reduced models for LR tests of indicator x age interactions
> agestrat.ref <- glm(diarrheaci10~entero35 +agestrat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 
> # Pooled estimate (Age 0-4, 5-10, >10), Body Immersion
> agestrat.fit <- glm(diarrheaci10~ entero35*agestrat +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,family=poisson(link="log"),data=ad)
> 	# commented out robust SE calcs b/c not used
> 	# agestrat.VC <- cl(ad,fm=agestrat.fit,cluster=ad$hhid)
> 	# agestrat.body <- coeftest(agestrat.fit, agestrat.VC) 
> 	lrtest(agestrat.ref,agestrat.fit)
Likelihood ratio test

Model 1: diarrheaci10 ~ entero35 + agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
Model 2: diarrheaci10 ~ entero35 * agestrat + female + racewhite + gichron + 
    anim_any + gicontactbase + rawfood + beach
  #Df  LogLik Df  Chisq Pr(>Chisq)  
1  26 -8208.3                       
2  29 -8204.2  3 8.1573    0.04287 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
> 
> 
> 
> # --------------------------------------
> # Stratified Models 
> # based on tests of interaction (above)
> # stratify the results by non-point and
> # point source conditions
> # --------------------------------------
> 
> # Pooled Non-point source and point-source
> nps <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8271  -0.3139  -0.2832  -0.2523   2.8824  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.00666    0.14513 -20.718  < 2e-16 ***
entero35             -0.04464    0.18418  -0.242 0.808482    
agecat5-14           -0.70762    0.12413  -5.701 1.19e-08 ***
agecat15-24          -0.67967    0.14743  -4.610 4.02e-06 ***
agecat25-34          -0.27702    0.13839  -2.002 0.045309 *  
agecat35-44          -0.34341    0.13530  -2.538 0.011147 *  
agecat45-54          -0.44907    0.14755  -3.043 0.002339 ** 
agecat55-64          -0.53650    0.19668  -2.728 0.006377 ** 
agecat65-74          -2.63366    1.00622  -2.617 0.008861 ** 
agecat75+            -0.95450    1.00601  -0.949 0.342726    
agecatMissing        -0.35013    0.36893  -0.949 0.342599    
female                0.01492    0.07249   0.206 0.836958    
racewhiteYes          0.37129    0.10524   3.528 0.000419 ***
racewhiteMissing     -0.44793    0.45721  -0.980 0.327233    
gichronYes            1.02377    0.16156   6.337 2.34e-10 ***
anim_anyYes           0.03399    0.08893   0.382 0.702336    
gicontactbaseYes      0.50902    0.14577   3.492 0.000480 ***
gicontactbaseMissing  0.48859    0.30844   1.584 0.113174    
rawfood               0.12086    0.08353   1.447 0.147917    
beachMalibu           0.13710    0.11847   1.157 0.247183    
beachMission Bay      0.16862    0.13103   1.287 0.198119    
beachSurfside        -0.14699    0.10868  -1.353 0.176205    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4849.7  on 17609  degrees of freedom
Residual deviance: 4726.2  on 17588  degrees of freedom
AIC: 6324.2

Number of Fisher Scoring iterations: 7



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.006658   0.161326 -18.6372 < 2.2e-16 ***
entero35             -0.044641   0.201025  -0.2221  0.824260    
agecat5-14           -0.707622   0.132140  -5.3551 8.551e-08 ***
agecat15-24          -0.679672   0.148652  -4.5722 4.825e-06 ***
agecat25-34          -0.277018   0.132905  -2.0843  0.037130 *  
agecat35-44          -0.343408   0.133861  -2.5654  0.010306 *  
agecat45-54          -0.449069   0.147709  -3.0402  0.002364 ** 
agecat55-64          -0.536500   0.195216  -2.7482  0.005992 ** 
agecat65-74          -2.633662   1.007789  -2.6133  0.008967 ** 
agecat75+            -0.954500   0.998478  -0.9560  0.339095    
agecatMissing        -0.350133   0.570157  -0.6141  0.539149    
female                0.014918   0.069532   0.2146  0.830117    
racewhiteYes          0.371295   0.124091   2.9921  0.002770 ** 
racewhiteMissing     -0.447928   0.457565  -0.9789  0.327610    
gichronYes            1.023775   0.151637   6.7515 1.463e-11 ***
anim_anyYes           0.033988   0.097768   0.3476  0.728114    
gicontactbaseYes      0.509023   0.158043   3.2208  0.001278 ** 
gicontactbaseMissing  0.488594   0.284311   1.7185  0.085702 .  
rawfood               0.120857   0.088983   1.3582  0.174399    
beachMalibu           0.137098   0.130642   1.0494  0.293987    
beachMission Bay      0.168622   0.166477   1.0129  0.311117    
beachSurfside        -0.146992   0.120449  -1.2204  0.222325    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> ps <- mpreg(diarrheaci10~entero35 +agecat+female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.9944  -0.3199  -0.2695  -0.2278   2.4772  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.84261    0.12934 -21.978  < 2e-16 ***
entero35               0.23268    0.07223   3.221 0.001276 ** 
agecat5-14            -0.71695    0.09789  -7.324 2.40e-13 ***
agecat15-24           -0.74318    0.10919  -6.806 1.00e-11 ***
agecat25-34           -0.34121    0.10494  -3.251 0.001149 ** 
agecat35-44           -0.34421    0.10372  -3.319 0.000904 ***
agecat45-54           -0.58112    0.12269  -4.737 2.17e-06 ***
agecat55-64           -0.56507    0.16582  -3.408 0.000655 ***
agecat65-74           -0.72471    0.30010  -2.415 0.015739 *  
agecat75+            -12.53179  145.24276  -0.086 0.931243    
agecatMissing         -0.72270    0.25651  -2.817 0.004841 ** 
female                 0.08567    0.05663   1.513 0.130303    
racewhiteYes           0.16381    0.08793   1.863 0.062459 .  
racewhiteMissing       0.39076    0.34375   1.137 0.255641    
gichronYes             0.56899    0.13236   4.299 1.72e-05 ***
gichronMissing       -12.20088  329.06068  -0.037 0.970423    
anim_anyYes            0.24730    0.06634   3.728 0.000193 ***
gicontactbaseYes       0.70996    0.09922   7.156 8.33e-13 ***
gicontactbaseMissing   0.45463    0.45003   1.010 0.312381    
rawfood                0.24632    0.07393   3.332 0.000863 ***
beachBoqueron         -0.46497    0.11983  -3.880 0.000104 ***
beachEdgewater         0.08791    0.17264   0.509 0.610621    
beachFairhope          0.04415    0.16114   0.274 0.784095    
beachGoddard          -0.32428    0.17504  -1.853 0.063936 .  
beachHuntington        0.49926    0.14247   3.504 0.000458 ***
beachSilver           -0.37037    0.10256  -3.611 0.000305 ***
beachWashington Park  -0.11642    0.11986  -0.971 0.331417    
beachWest              0.31306    0.12051   2.598 0.009383 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 7872.7  on 28458  degrees of freedom
Residual deviance: 7523.3  on 28431  degrees of freedom
AIC: 10107

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -2.842608   0.142779 -19.9092 < 2.2e-16 ***
entero35               0.232680   0.080787   2.8802 0.0039746 ** 
agecat5-14            -0.716946   0.098729  -7.2618 3.821e-13 ***
agecat15-24           -0.743178   0.110052  -6.7530 1.448e-11 ***
agecat25-34           -0.341208   0.102357  -3.3335 0.0008576 ***
agecat35-44           -0.344205   0.102387  -3.3618 0.0007744 ***
agecat45-54           -0.581122   0.123643  -4.7000 2.602e-06 ***
agecat55-64           -0.565069   0.163504  -3.4560 0.0005483 ***
agecat65-74           -0.724712   0.295755  -2.4504 0.0142706 *  
agecat75+            -12.531788   0.157897 -79.3668 < 2.2e-16 ***
agecatMissing         -0.722696   0.293873  -2.4592 0.0139240 *  
female                 0.085674   0.053700   1.5954 0.1106226    
racewhiteYes           0.163812   0.099499   1.6464 0.0996869 .  
racewhiteMissing       0.390759   0.363789   1.0741 0.2827614    
gichronYes             0.568988   0.131477   4.3277 1.507e-05 ***
gichronMissing       -12.200876   0.368262 -33.1310 < 2.2e-16 ***
anim_anyYes            0.247302   0.073099   3.3831 0.0007167 ***
gicontactbaseYes       0.709959   0.106020   6.6965 2.135e-11 ***
gicontactbaseMissing   0.454635   0.405191   1.1220 0.2618507    
rawfood                0.246319   0.077748   3.1681 0.0015341 ** 
beachBoqueron         -0.464975   0.138932  -3.3468 0.0008175 ***
beachEdgewater         0.087907   0.187457   0.4689 0.6391095    
beachFairhope          0.044150   0.181580   0.2431 0.8078936    
beachGoddard          -0.324282   0.208322  -1.5566 0.1195560    
beachHuntington        0.499260   0.160022   3.1200 0.0018088 ** 
beachSilver           -0.370370   0.112142  -3.3027 0.0009576 ***
beachWashington Park  -0.116417   0.136536  -0.8526 0.3938538    
beachWest              0.313056   0.135950   2.3027 0.0212938 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Age-stratified results
> age0to4   <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7502  -0.3967  -0.3517  -0.3149   2.2223  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -2.59873    0.25611 -10.147  < 2e-16 ***
entero35              0.39773    0.17212   2.311  0.02084 *  
female               -0.10927    0.12340  -0.886  0.37587    
racewhiteYes          0.24567    0.17042   1.442  0.14942    
racewhiteMissing      0.28882    0.72788   0.397  0.69152    
gichronYes            0.31317    0.71449   0.438  0.66116    
anim_anyYes           0.28473    0.14352   1.984  0.04727 *  
gicontactbaseYes      0.46790    0.25939   1.804  0.07125 .  
gicontactbaseMissing  0.98944    0.51817   1.909  0.05620 .  
rawfood              -0.64948    0.28023  -2.318  0.02047 *  
beachBoqueron        -0.40515    0.29863  -1.357  0.17488    
beachDoheny          -0.18908    0.27869  -0.678  0.49746    
beachEdgewater       -0.13814    0.49469  -0.279  0.78005    
beachFairhope        -0.17208    0.34335  -0.501  0.61625    
beachGoddard         -0.26330    0.39835  -0.661  0.50862    
beachHuntington      -0.15475    0.39425  -0.393  0.69467    
beachMalibu          -0.30901    0.33478  -0.923  0.35599    
beachMission Bay     -0.07975    0.29670  -0.269  0.78810    
beachSilver          -0.71497    0.26836  -2.664  0.00772 ** 
beachSurfside        -0.64778    0.28987  -2.235  0.02543 *  
beachWashington Park -0.52172    0.33034  -1.579  0.11425    
beachWest            -0.01956    0.33887  -0.058  0.95398    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1409.2  on 3760  degrees of freedom
Residual deviance: 1369.2  on 3739  degrees of freedom
AIC: 1945.2

Number of Fisher Scoring iterations: 6



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value Pr(>|z|)    
(Intercept)          -2.598729   0.255897 -10.1554  < 2e-16 ***
entero35              0.397732   0.172313   2.3082  0.02099 *  
female               -0.109273   0.118489  -0.9222  0.35641    
racewhiteYes          0.245671   0.175751   1.3978  0.16216    
racewhiteMissing      0.288817   0.718922   0.4017  0.68788    
gichronYes            0.313171   0.643322   0.4868  0.62640    
anim_anyYes           0.284725   0.151193   1.8832  0.05968 .  
gicontactbaseYes      0.467900   0.255145   1.8339  0.06667 .  
gicontactbaseMissing  0.989439   0.495045   1.9987  0.04564 *  
rawfood              -0.649482   0.273395  -2.3756  0.01752 *  
beachBoqueron        -0.405145   0.314059  -1.2900  0.19704    
beachDoheny          -0.189085   0.272007  -0.6951  0.48696    
beachEdgewater       -0.138143   0.485384  -0.2846  0.77595    
beachFairhope        -0.172079   0.338251  -0.5087  0.61094    
beachGoddard         -0.263304   0.426476  -0.6174  0.53697    
beachHuntington      -0.154752   0.414097  -0.3737  0.70862    
beachMalibu          -0.309012   0.347601  -0.8890  0.37401    
beachMission Bay     -0.079745   0.318339  -0.2505  0.80220    
beachSilver          -0.714966   0.289332  -2.4711  0.01347 *  
beachSurfside        -0.647782   0.305663  -2.1193  0.03407 *  
beachWashington Park -0.521724   0.328487  -1.5883  0.11223    
beachWest            -0.019556   0.350863  -0.0557  0.95555    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age5to10  <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7219  -0.3025  -0.2702  -0.2258   2.4973  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.44882    0.21851 -15.783  < 2e-16 ***
entero35               0.23952    0.14640   1.636  0.10183    
female                -0.10113    0.10995  -0.920  0.35770    
racewhiteYes           0.40748    0.15025   2.712  0.00669 ** 
racewhiteMissing       0.09227    0.59565   0.155  0.87689    
gichronYes             0.91574    0.45297   2.022  0.04321 *  
gichronMissing       -10.06243  269.02485  -0.037  0.97016    
anim_anyYes            0.06948    0.13472   0.516  0.60604    
gicontactbaseYes       0.41719    0.22243   1.876  0.06071 .  
gicontactbaseMissing  -0.02837    0.71351  -0.040  0.96828    
rawfood               -0.22709    0.18528  -1.226  0.22034    
beachBoqueron         -0.49537    0.29138  -1.700  0.08912 .  
beachDoheny           -0.18718    0.23323  -0.803  0.42225    
beachEdgewater         0.07768    0.48368   0.161  0.87241    
beachFairhope         -0.17380    0.37734  -0.461  0.64510    
beachGoddard          -0.11837    0.40057  -0.295  0.76762    
beachHuntington        0.78084    0.28534   2.737  0.00621 ** 
beachMalibu            0.34206    0.26202   1.305  0.19174    
beachMission Bay       0.25602    0.25010   1.024  0.30598    
beachSilver           -0.16654    0.22674  -0.734  0.46266    
beachSurfside         -0.59664    0.27056  -2.205  0.02744 *  
beachWashington Park  -0.01159    0.26855  -0.043  0.96556    
beachWest              0.33198    0.30752   1.080  0.28035    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2168.9  on 8529  degrees of freedom
Residual deviance: 2101.3  on 8507  degrees of freedom
AIC: 2817.3

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -3.448818   0.235759 -14.6286  < 2e-16 ***
entero35               0.239519   0.149176   1.6056  0.10836    
female                -0.101127   0.107924  -0.9370  0.34875    
racewhiteYes           0.407481   0.171944   2.3699  0.01780 *  
racewhiteMissing       0.092274   0.569372   0.1621  0.87126    
gichronYes             0.915744   0.420819   2.1761  0.02955 *  
gichronMissing       -10.062431   0.635183 -15.8418  < 2e-16 ***
anim_anyYes            0.069481   0.137313   0.5060  0.61285    
gicontactbaseYes       0.417195   0.224855   1.8554  0.06354 .  
gicontactbaseMissing  -0.028373   0.696284  -0.0407  0.96750    
rawfood               -0.227089   0.197011  -1.1527  0.24905    
beachBoqueron         -0.495366   0.308327  -1.6066  0.10814    
beachDoheny           -0.187175   0.242796  -0.7709  0.44076    
beachEdgewater         0.077676   0.473038   0.1642  0.86957    
beachFairhope         -0.173795   0.404774  -0.4294  0.66766    
beachGoddard          -0.118366   0.429110  -0.2758  0.78267    
beachHuntington        0.780844   0.303189   2.5754  0.01001 *  
beachMalibu            0.342058   0.263018   1.3005  0.19342    
beachMission Bay       0.256024   0.283625   0.9027  0.36669    
beachSilver           -0.166535   0.228100  -0.7301  0.46533    
beachSurfside         -0.596636   0.284188  -2.0994  0.03578 *  
beachWashington Park  -0.011594   0.278663  -0.0416  0.96681    
beachWest              0.331981   0.306213   1.0841  0.27830    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> age11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8027  -0.3129  -0.2710  -0.2380   2.5049  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.45646    0.11878 -29.101  < 2e-16 ***
entero35               0.13181    0.08392   1.571  0.11627    
female                 0.15032    0.05386   2.791  0.00525 ** 
racewhiteYes           0.18801    0.08486   2.215  0.02673 *  
racewhiteMissing      -0.57071    0.45414  -1.257  0.20887    
gichronYes             0.78300    0.10627   7.368 1.73e-13 ***
gichronMissing       -10.09749  150.41251  -0.067  0.94648    
anim_anyYes            0.16272    0.06335   2.568  0.01021 *  
gicontactbaseYes       0.69495    0.09514   7.305 2.78e-13 ***
gicontactbaseMissing   0.53674    0.32126   1.671  0.09477 .  
rawfood                0.35769    0.06061   5.901 3.61e-09 ***
beachBoqueron         -0.42054    0.13120  -3.205  0.00135 ** 
beachDoheny           -0.09384    0.13088  -0.717  0.47335    
beachEdgewater         0.19838    0.19725   1.006  0.31454    
beachFairhope          0.22796    0.20723   1.100  0.27131    
beachGoddard          -0.34924    0.22138  -1.578  0.11466    
beachHuntington        0.54803    0.18074   3.032  0.00243 ** 
beachMalibu           -0.01288    0.14349  -0.090  0.92849    
beachMission Bay      -0.16796    0.16143  -1.040  0.29815    
beachSilver           -0.30229    0.12303  -2.457  0.01401 *  
beachSurfside         -0.25087    0.11356  -2.209  0.02717 *  
beachWashington Park   0.01740    0.14286   0.122  0.90307    
beachWest              0.39633    0.13866   2.858  0.00426 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 8920.3  on 33087  degrees of freedom
Residual deviance: 8635.8  on 33065  degrees of freedom
AIC: 11512

Number of Fisher Scoring iterations: 11



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.456461   0.128624 -26.8726 < 2.2e-16 ***
entero35               0.131805   0.088315   1.4924  0.135582    
female                 0.150322   0.050682   2.9660  0.003017 ** 
racewhiteYes           0.188010   0.088958   2.1135  0.034562 *  
racewhiteMissing      -0.570711   0.453354  -1.2589  0.208079    
gichronYes             0.783000   0.102554   7.6350 2.258e-14 ***
gichronMissing       -10.097495   0.393331 -25.6718 < 2.2e-16 ***
anim_anyYes            0.162721   0.065735   2.4754  0.013308 *  
gicontactbaseYes       0.694952   0.095672   7.2639 3.761e-13 ***
gicontactbaseMissing   0.536739   0.293499   1.8288  0.067436 .  
rawfood                0.357692   0.062606   5.7134 1.107e-08 ***
beachBoqueron         -0.420537   0.143518  -2.9302  0.003387 ** 
beachDoheny           -0.093842   0.138978  -0.6752  0.499529    
beachEdgewater         0.198382   0.208826   0.9500  0.342120    
beachFairhope          0.227957   0.205978   1.1067  0.268422    
beachGoddard          -0.349241   0.236779  -1.4750  0.140222    
beachHuntington        0.548029   0.179346   3.0557  0.002245 ** 
beachMalibu           -0.012877   0.150606  -0.0855  0.931861    
beachMission Bay      -0.167959   0.177181  -0.9480  0.343154    
beachSilver           -0.302290   0.127815  -2.3651  0.018027 *  
beachSurfside         -0.250866   0.121375  -2.0669  0.038747 *  
beachWashington Park   0.017399   0.152645   0.1140  0.909250    
beachWest              0.396334   0.147817   2.6812  0.007335 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Non-point source estimates by age group
> nps0to4 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7463  -0.3805  -0.3539  -0.3296   2.1873  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.77869    0.28646  -9.700   <2e-16 ***
entero35               0.30970    0.40285   0.769   0.4420    
female                -0.02762    0.20107  -0.137   0.8907    
racewhiteYes           0.28727    0.26389   1.089   0.2763    
racewhiteMissing       0.63158    0.74627   0.846   0.3974    
gichronYes           -12.65999  636.56642  -0.020   0.9841    
anim_anyYes            0.07006    0.24660   0.284   0.7763    
gicontactbaseYes       0.04471    0.51161   0.087   0.9304    
gicontactbaseMissing   1.14290    0.52742   2.167   0.0302 *  
rawfood               -0.67919    0.40413  -1.681   0.0928 .  
beachMalibu           -0.13452    0.32514  -0.414   0.6791    
beachMission Bay       0.12814    0.30985   0.414   0.6792    
beachSurfside         -0.34927    0.30306  -1.152   0.2491    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 540.67  on 1492  degrees of freedom
Residual deviance: 529.79  on 1480  degrees of freedom
AIC: 755.79

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -2.778692   0.295248  -9.4114  < 2e-16 ***
entero35               0.309704   0.397919   0.7783  0.43639    
female                -0.027618   0.198862  -0.1389  0.88954    
racewhiteYes           0.287273   0.293986   0.9772  0.32849    
racewhiteMissing       0.631583   0.732516   0.8622  0.38857    
gichronYes           -12.659992   0.528228 -23.9669  < 2e-16 ***
anim_anyYes            0.070058   0.245870   0.2849  0.77569    
gicontactbaseYes       0.044709   0.488975   0.0914  0.92715    
gicontactbaseMissing   1.142901   0.491958   2.3232  0.02017 *  
rawfood               -0.679186   0.389012  -1.7459  0.08082 .  
beachMalibu           -0.134522   0.336560  -0.3997  0.68938    
beachMission Bay       0.128141   0.337530   0.3796  0.70421    
beachSurfside         -0.349267   0.287553  -1.2146  0.22451    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps5to10 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6882  -0.3074  -0.2623  -0.2156   2.8981  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.44074    0.23823 -14.443   <2e-16 ***
entero35             -1.02067    0.58876  -1.734   0.0830 .  
female               -0.39212    0.17845  -2.197   0.0280 *  
racewhiteYes          0.38832    0.21872   1.775   0.0758 .  
racewhiteMissing     -0.63162    1.02036  -0.619   0.5359    
gichronYes            1.49390    0.71556   2.088   0.0368 *  
anim_anyYes           0.12975    0.20929   0.620   0.5353    
gicontactbaseYes     -0.01046    0.45831  -0.023   0.9818    
gicontactbaseMissing  0.20074    0.71772   0.280   0.7797    
rawfood              -0.47014    0.27340  -1.720   0.0855 .  
beachMalibu           0.51014    0.25068   2.035   0.0418 *  
beachMission Bay      0.54669    0.25834   2.116   0.0343 *  
beachSurfside        -0.44699    0.27756  -1.610   0.1073    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 885.13  on 3642  degrees of freedom
Residual deviance: 857.23  on 3630  degrees of freedom
AIC: 1151.2

Number of Fisher Scoring iterations: 6



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.440742   0.266727 -12.8999 < 2.2e-16 ***
entero35             -1.020668   0.608323  -1.6778  0.093379 .  
female               -0.392125   0.170282  -2.3028  0.021290 *  
racewhiteYes          0.388324   0.259981   1.4937  0.135263    
racewhiteMissing     -0.631624   0.993239  -0.6359  0.524826    
gichronYes            1.493896   0.564236   2.6476  0.008105 ** 
anim_anyYes           0.129749   0.219665   0.5907  0.554743    
gicontactbaseYes     -0.010464   0.455774  -0.0230  0.981682    
gicontactbaseMissing  0.200737   0.697553   0.2878  0.773520    
rawfood              -0.470141   0.290222  -1.6199  0.105246    
beachMalibu           0.510137   0.254706   2.0028  0.045194 *  
beachMission Bay      0.546685   0.318610   1.7158  0.086190 .  
beachSurfside        -0.446995   0.301084  -1.4846  0.137645    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> nps11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="No" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8561  -0.3064  -0.2811  -0.2622   2.6429  

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
(Intercept)          -3.68429    0.15108 -24.386  < 2e-16 ***
entero35              0.10208    0.22231   0.459 0.646123    
female                0.13878    0.08765   1.583 0.113327    
racewhiteYes          0.42707    0.13621   3.135 0.001716 ** 
racewhiteMissing     -0.79682    0.71733  -1.111 0.266649    
gichronYes            1.04086    0.16556   6.287 3.24e-10 ***
anim_anyYes           0.01160    0.10748   0.108 0.914033    
gicontactbaseYes      0.65614    0.16182   4.055 5.02e-05 ***
gicontactbaseMissing  0.28321    0.45553   0.622 0.534130    
rawfood               0.31109    0.09184   3.388 0.000705 ***
beachMalibu           0.09487    0.14726   0.644 0.519424    
beachMission Bay      0.07331    0.17667   0.415 0.678184    
beachSurfside        -0.12408    0.13083  -0.948 0.342898    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3353.7  on 12289  degrees of freedom
Residual deviance: 3274.0  on 12277  degrees of freedom
AIC: 4370

Number of Fisher Scoring iterations: 6



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                      Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)          -3.684293   0.161568 -22.8034 < 2.2e-16 ***
entero35              0.102075   0.238508   0.4280  0.668670    
female                0.138780   0.083099   1.6701  0.094908 .  
racewhiteYes          0.427069   0.142823   2.9902  0.002788 ** 
racewhiteMissing     -0.796822   0.715739  -1.1133  0.265586    
gichronYes            1.040864   0.154023   6.7579 1.400e-11 ***
anim_anyYes           0.011603   0.111430   0.1041  0.917069    
gicontactbaseYes      0.656138   0.167042   3.9280 8.566e-05 ***
gicontactbaseMissing  0.283210   0.435269   0.6507  0.515269    
rawfood               0.311094   0.095788   3.2477  0.001163 ** 
beachMalibu           0.094872   0.151564   0.6260  0.531346    
beachMission Bay      0.073309   0.194025   0.3778  0.705556    
beachSurfside        -0.124082   0.132411  -0.9371  0.348709    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> # Point-source estimates by age group
> ps0to4 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(0, 4]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8337  -0.4063  -0.3514  -0.3058   2.2035  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -2.56062    0.28313  -9.044  < 2e-16 ***
entero35               0.40951    0.19154   2.138  0.03252 *  
female                -0.16675    0.15645  -1.066  0.28648    
racewhiteYes           0.20456    0.22349   0.915  0.36004    
racewhiteMissing     -12.49874  503.56650  -0.025  0.98020    
gichronYes             0.48413    0.72203   0.671  0.50253    
anim_anyYes            0.40152    0.18135   2.214  0.02683 *  
gicontactbaseYes       0.65488    0.30337   2.159  0.03087 *  
gicontactbaseMissing -12.89203  735.84219  -0.018  0.98602    
rawfood               -0.63136    0.39017  -1.618  0.10563    
beachBoqueron         -0.49084    0.32384  -1.516  0.12960    
beachEdgewater        -0.21489    0.49817  -0.431  0.66620    
beachFairhope         -0.26805    0.34689  -0.773  0.43969    
beachGoddard          -0.33539    0.40330  -0.832  0.40563    
beachHuntington       -0.23986    0.39916  -0.601  0.54790    
beachSilver           -0.80572    0.27347  -2.946  0.00322 ** 
beachWashington Park  -0.62541    0.33523  -1.866  0.06209 .  
beachWest             -0.08523    0.34457  -0.247  0.80464    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 868.07  on 2267  degrees of freedom
Residual deviance: 832.89  on 2250  degrees of freedom
AIC: 1200.9

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value Pr(>|z|)    
(Intercept)           -2.560619   0.269929  -9.4863  < 2e-16 ***
entero35               0.409509   0.192782   2.1242  0.03365 *  
female                -0.166755   0.148680  -1.1216  0.26205    
racewhiteYes           0.204558   0.215179   0.9506  0.34179    
racewhiteMissing     -12.498737   0.565186 -22.1144  < 2e-16 ***
gichronYes             0.484128   0.651694   0.7429  0.45756    
anim_anyYes            0.401518   0.199258   2.0151  0.04390 *  
gicontactbaseYes       0.654880   0.301217   2.1741  0.02970 *  
gicontactbaseMissing -12.892028   0.774719 -16.6409  < 2e-16 ***
rawfood               -0.631360   0.389268  -1.6219  0.10482    
beachBoqueron         -0.490838   0.337517  -1.4543  0.14587    
beachEdgewater        -0.214893   0.494403  -0.4347  0.66382    
beachFairhope         -0.268051   0.338903  -0.7909  0.42898    
beachGoddard          -0.335389   0.435999  -0.7692  0.44175    
beachHuntington       -0.239860   0.423996  -0.5657  0.57159    
beachSilver           -0.805718   0.300629  -2.6801  0.00736 ** 
beachWashington Park  -0.625411   0.335982  -1.8614  0.06268 .  
beachWest             -0.085226   0.355651  -0.2396  0.81061    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps5to10 <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat=="(4, 10]",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.6058  -0.3248  -0.2730  -0.2006   2.4730  

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.676040   0.254601 -14.438  < 2e-16 ***
entero35               0.419544   0.160366   2.616  0.00889 ** 
female                 0.087734   0.141591   0.620  0.53550    
racewhiteYes           0.423010   0.207139   2.042  0.04114 *  
racewhiteMissing       0.791468   0.736579   1.075  0.28259    
gichronYes             0.646014   0.583880   1.106  0.26855    
gichronMissing       -12.343684 731.473831  -0.017  0.98654    
anim_anyYes            0.046452   0.176383   0.263  0.79228    
gicontactbaseYes       0.569897   0.256159   2.225  0.02610 *  
gicontactbaseMissing -12.256311 365.901502  -0.033  0.97328    
rawfood               -0.001914   0.248660  -0.008  0.99386    
beachBoqueron         -0.364245   0.319223  -1.141  0.25386    
beachEdgewater         0.182530   0.488715   0.373  0.70878    
beachFairhope         -0.121103   0.382299  -0.317  0.75141    
beachGoddard          -0.024200   0.407940  -0.059  0.95269    
beachHuntington        0.866912   0.295016   2.939  0.00330 ** 
beachSilver           -0.153083   0.235975  -0.649  0.51652    
beachWashington Park   0.036114   0.277191   0.130  0.89634    
beachWest              0.387886   0.314342   1.234  0.21722    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1282.8  on 4886  degrees of freedom
Residual deviance: 1225.4  on 4868  degrees of freedom
AIC: 1665.4

Number of Fisher Scoring iterations: 13



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                        Estimate  Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.6760404   0.2863302 -12.8385 < 2.2e-16 ***
entero35               0.4195445   0.1687923   2.4856  0.012935 *  
female                 0.0877338   0.1395980   0.6285  0.529693    
racewhiteYes           0.4230102   0.2256792   1.8744  0.060877 .  
racewhiteMissing       0.7914679   0.6568612   1.2049  0.228233    
gichronYes             0.6460144   0.5573035   1.1592  0.246383    
gichronMissing       -12.3436838   0.6585287 -18.7443 < 2.2e-16 ***
anim_anyYes            0.0464517   0.1725472   0.2692  0.787767    
gicontactbaseYes       0.5698971   0.2596090   2.1952  0.028148 *  
gicontactbaseMissing -12.2563113   0.4144666 -29.5713 < 2.2e-16 ***
rawfood               -0.0019136   0.2548222  -0.0075  0.994008    
beachBoqueron         -0.3642445   0.3435219  -1.0603  0.288997    
beachEdgewater         0.1825300   0.4758124   0.3836  0.701262    
beachFairhope         -0.1211035   0.4095659  -0.2957  0.767469    
beachGoddard          -0.0242004   0.4332073  -0.0559  0.955451    
beachHuntington        0.8669122   0.3122147   2.7767  0.005492 ** 
beachSilver           -0.1530832   0.2337719  -0.6548  0.512571    
beachWashington Park   0.0361140   0.2835298   0.1274  0.898645    
beachWest              0.3878864   0.3113986   1.2456  0.212901    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> ps11plus <- mpreg(diarrheaci10~entero35 +female+racewhite+gichron+anim_any+gicontactbase+rawfood+beach,dat=ad[ad$pointsource=="Yes" & ad$agestrat==">10",],vcv=T)

Call:
glm(formula = formula, family = poisson(link = "log"), data = dat)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.7697  -0.3141  -0.2629  -0.2245   2.4270  

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
(Intercept)           -3.37344    0.13206 -25.544  < 2e-16 ***
entero35               0.14035    0.09083   1.545 0.122322    
female                 0.16229    0.06833   2.375 0.017546 *  
racewhiteYes           0.02590    0.10696   0.242 0.808644    
racewhiteMissing      -0.32833    0.58662  -0.560 0.575692    
gichronYes             0.62685    0.13852   4.525 6.03e-06 ***
gichronMissing       -11.12104  248.91461  -0.045 0.964364    
anim_anyYes            0.24420    0.07869   3.103 0.001914 ** 
gicontactbaseYes       0.72576    0.11775   6.164 7.12e-10 ***
gicontactbaseMissing   0.84579    0.45094   1.876 0.060706 .  
rawfood                0.39379    0.08034   4.902 9.51e-07 ***
beachBoqueron         -0.55206    0.14214  -3.884 0.000103 ***
beachEdgewater         0.15997    0.19869   0.805 0.420745    
beachFairhope          0.17694    0.20876   0.848 0.396684    
beachGoddard          -0.39265    0.22288  -1.762 0.078124 .  
beachHuntington        0.53458    0.18332   2.916 0.003544 ** 
beachSilver           -0.32043    0.12601  -2.543 0.010994 *  
beachWashington Park  -0.01317    0.14541  -0.091 0.927809    
beachWest              0.36404    0.14134   2.576 0.010004 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 5566.3  on 20797  degrees of freedom
Residual deviance: 5348.6  on 20779  degrees of freedom
AIC: 7146.6

Number of Fisher Scoring iterations: 12



Robust, Sandwich Standard Errors Account for Clustering:

z test of coefficients:

                       Estimate Std. Error  z value  Pr(>|z|)    
(Intercept)           -3.373438   0.141149 -23.8999 < 2.2e-16 ***
entero35               0.140345   0.095386   1.4713 0.1412006    
female                 0.162292   0.064030   2.5346 0.0112566 *  
racewhiteYes           0.025904   0.110274   0.2349 0.8142848    
racewhiteMissing      -0.328325   0.589584  -0.5569 0.5776122    
gichronYes             0.626846   0.136357   4.5971 4.284e-06 ***
gichronMissing       -11.121044   0.392971 -28.2999 < 2.2e-16 ***
anim_anyYes            0.244203   0.081525   2.9954 0.0027405 ** 
gicontactbaseYes       0.725761   0.116412   6.2344 4.534e-10 ***
gicontactbaseMissing   0.845793   0.371875   2.2744 0.0229417 *  
rawfood                0.393791   0.082015   4.8015 1.575e-06 ***
beachBoqueron         -0.552056   0.152980  -3.6087 0.0003078 ***
beachEdgewater         0.159968   0.211083   0.7578 0.4485434    
beachFairhope          0.176940   0.207372   0.8532 0.3935210    
beachGoddard          -0.392648   0.239274  -1.6410 0.1007984    
beachHuntington        0.534585   0.181345   2.9479 0.0031996 ** 
beachSilver           -0.320426   0.130049  -2.4639 0.0137442 *  
beachWashington Park  -0.013175   0.154751  -0.0851 0.9321538    
beachWest              0.364043   0.150304   2.4220 0.0154335 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

> 
> 
> # --------------------------------------
> # Estimate adjusted CIRs
> # From the overall pooled model and
> # From stratified models
> # --------------------------------------
> 
> # function to get CIR Estimates and CIs from simple stratified models
> getCIR <- function(x) {
+ 	# x : log-linear model object returned from coeftest (class=coeftest)
+ 	# NOTE: assumes exposure of interest is the first covariate and there are no interactions
+ 	est <- exp(x[2,1])
+ 	se  <- x[2,2]	
+ 	lb <- exp(log(est)-1.96*se)
+ 	ub <- exp(log(est)+1.96*se)
+ 	res <- c(est,lb,ub)
+ 	return(res)
+ }
> 
> 
> # bind all of the CIRs together, organized by
> # non-point source vs. point source and then age, then overall
> 
> cir.all <- rbind(getCIR(nps$fit),getCIR(ps$fit),getCIR(overall.fit) )
> 
> cir.age0to4 <- rbind(getCIR(nps0to4$fit),getCIR(ps0to4$fit),getCIR(age0to4$fit) )
> 
> cir.age5to10 <- rbind(getCIR(nps5to10$fit),getCIR(ps5to10$fit),getCIR(age5to10$fit) )
> 
> cir.age11plus <- rbind(getCIR(nps11plus$fit),getCIR(ps11plus$fit),getCIR(age11plus$fit) )
> 
> 	
> colnames(cir.all) <- colnames(cir.age11plus) <- colnames(cir.age5to10) <- colnames(cir.age0to4) <- c("CIR","CIRlb","CIRub")
> rownames(cir.all) <- rownames(cir.age11plus) <- rownames(cir.age5to10) <- rownames(cir.age0to4) <-  c("Non-point source","Point source","Overall")
> 
> # --------------------------------------
> # Number of persons at risk and cases
> # by strata
> # Print results to the log
> # --------------------------------------
> N.all
     n     N
0 1697 40199
1  344  5870
> N.age0to4
    n    N
0 209 3205
1  57  556
> N.age5to10
    n    N
0 259 7157
1  76 1373
> N.age11plus
     n     N
0 1206 29300
1  209  3788
> N.nps
    n     N
0 745 16831
1  32   779
> N.ps
    n     N
0 952 23368
1 312  5091
> N.nps0to4
   n    N
0 93 1415
1  7   78
> N.nps5to10
    n    N
0 131 3438
1   3  205
> N.nps11plus
    n     N
0 513 11808
1  22   482
> N.ps0to4
    n    N
0 116 1790
1  50  478
> N.ps5to10
    n    N
0 128 3719
1  73 1168
> N.ps11plus
    n     N
0 693 17492
1 187  3306
> 
> # --------------------------------------
> # Cumulative Incidence Estimates
> # Print results to the log
> # --------------------------------------
> ci.all
                      CI       CIlb       CIub
Entero<=35cfu 0.04221498 0.03996919 0.04458696
Entero>35cfu  0.05860307 0.05206523 0.06596185
> ci.0to4
                      CI       CIlb      CIub
Entero<=35cfu 0.06521061 0.05667344 0.0750338
Entero>35cfu  0.10251799 0.07897353 0.1330818
> ci.5to10
                      CI       CIlb       CIub
Entero<=35cfu 0.03618835 0.03171518 0.04129241
Entero>35cfu  0.05535324 0.04378513 0.06997767
> ci.11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.04116041 0.03875684 0.04371304
Entero>35cfu  0.05517423 0.04782842 0.06364827
> 
> ci.nps
                      CI       CIlb       CIub
Entero<=35cfu 0.04426356 0.04072915 0.04810468
Entero>35cfu  0.04107831 0.02823681 0.05975983
> ci.nps0to4
                      CI       CIlb       CIub
Entero<=35cfu 0.06572438 0.05320128 0.08119531
Entero>35cfu  0.08974359 0.04396636 0.18318352
> ci.nps5to10
                      CI        CIlb       CIub
Entero<=35cfu 0.03810355 0.031522319 0.04605881
Entero>35cfu  0.01463415 0.004786086 0.04474600
> ci.nps11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.04344512 0.03965470 0.04759785
Entero>35cfu  0.04564315 0.02886381 0.07217681
> 
> ci.ps
                      CI       CIlb       CIub
Entero<=35cfu 0.04073947 0.03789121 0.04380184
Entero>35cfu  0.06128462 0.05411370 0.06940580
> ci.ps0to4
                      CI     CIlb       CIub
Entero<=35cfu 0.06480447 0.053714 0.07818482
Entero>35cfu  0.10460251 0.079047 0.13842000
> ci.ps5to10
                      CI       CIlb       CIub
Entero<=35cfu 0.03441785 0.02865174 0.04134439
Entero>35cfu  0.06250000 0.04922826 0.07934975
> ci.ps11plus
                      CI       CIlb       CIub
Entero<=35cfu 0.03961811 0.03616158 0.04340503
Entero>35cfu  0.05656382 0.03576982 0.08944597
> 
> 
> # --------------------------------------
> # Cumulative Incidence Ratios
> # Print results to the log
> # --------------------------------------
> cir.all
                       CIR     CIRlb    CIRub
Non-point source 0.9563403 0.6449067 1.418169
Point source     1.2619775 1.0771704 1.478492
Overall          1.2090438 1.0466354 1.396653
> cir.age0to4
                      CIR     CIRlb    CIRub
Non-point source 1.363021 0.6248666 2.973158
Point source     1.506078 1.0321621 2.197592
Overall          1.488445 1.0618344 2.086453
> cir.age5to10
                       CIR     CIRlb    CIRub
Non-point source 0.3603542 0.1093741 1.187256
Point source     1.5212684 1.0927655 2.117799
Overall          1.2706376 0.9485070 1.702170
> cir.age11plus
                      CIR     CIRlb    CIRub
Non-point source 1.107467 0.6939184 1.767474
Point source     1.150671 0.9544577 1.387220
Overall          1.140886 0.9595489 1.356493
> 
> 
> 
> # --------------------------------------
> # save the objects
> # --------------------------------------
> 
> save(
+ 	overall.fit,all.VC,age0to4,age5to10,age11plus,
+ 	nps,nps0to4,nps5to10,nps11plus,
+ 	ps,ps0to4,ps5to10,ps11plus,
+ 	
+ 	hufit,sifit,wpfit,wefit,avfit,bofit,dhfit,edfit,fafit,gdfit,mafit,mbfit,sufit,
+ 	
+ 	N.all,N.age0to4,N.age5to10,N.age11plus,
+ 	N.nps,N.nps0to4,N.nps5to10,N.nps11plus,
+ 	N.ps,N.ps0to4,N.ps5to10,N.ps11plus,
+ 	
+ 	ci.all,ci.0to4,ci.5to10,ci.11plus,
+ 	ci.nps,ci.nps0to4,ci.nps5to10,ci.nps11plus,
+ 	ci.ps,ci.ps0to4,ci.ps5to10,ci.ps11plus,
+ 	
+ 	cir.all,cir.age0to4,cir.age5to10,cir.age11plus,
+ 	
+ 	ps.reri, mf.reri,
+ 
+ 	file="~/dropbox/13beaches/aim1-results/rawoutput/aim1-entero1600-35cfu-regs-body.Rdata"
+ 	)
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> proc.time()
   user  system elapsed 
143.027  13.917 161.261 
