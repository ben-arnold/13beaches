--------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/benarnold/dropbox/13beaches/src/dm/8-append-wq-data.log
  log type:  text
 opened on:  17 Dec 2015, 13:58:33

. 
. *----------------------------------------
. * 8-append-wq-data.do
. * ben arnold
. *
. * impute non-detect values in datasets
. * calculate daily average log10 values
. * 
. * append the water quality samples datasets 
. * into a single file 
. *
. *
. *----------------------------------------
. 
. *----------------------------------------
. * input files:
. *       neear-wq-samples.dta
. *   adm-wq-samples.dta
. *   mb-wq-samples.dta
. *
. * output files:
. *       13beaches-wq-samples.dta / .csv
. *
. *----------------------------------------
. 
. 
. 
. *----------------------------------------
. * read in the beaches sample indicator data
. * standardize
. * append 
. *----------------------------------------
. 
. use "~/dropbox/13beaches/data/final/neear-wq-samples.dta", clear
(NEEAR water sample data, formatted by 5-format-neear-wq.do)

. 
. append using "~/dropbox/13beaches/data/final/adm-wq-samples.dta"
(note: variable stationid was str1, now str3 to accommodate using data's
       values)
(note: variable coltime was byte, now float to accommodate using data's
       values)
(note: variable depth was byte, now float to accommodate using data's values)
(note: variable entero1600cfu was long, now double to accommodate using data's
       values)
(label ND already defined)
(label depth already defined)

. 
. append using  "~/dropbox/13beaches/data/final/mb-wq-samples.dta"
(note: variable beachcode was str11, now str13 to accommodate using data's
       values)
(note: variable stationid was str3, now str6 to accommodate using data's
       values)
(label depth already defined)
(label ND already defined)

. 
. 
. * restrict the data to sample labels and common WQ indicators
. * Entero 1600
. * Entero Enterolert (Mission Bay only)
. * Entero qPCR 1611
. * Coliphage (F+/- 1601/1602)
. 
. keep beach beachcode coldate coltime sampleid* stationid swimloc depth frozen 
> sampletype entero1600cfu* enteroELTmpn* enteroQPCRcce enteroQPCRcce_nd enteroQ
> PCRcce_qc fpc1601mpn* fpc1602mpn* fmc1601mpn* fmc1602mpn*

. order beach beachcode coldate coltime sampleid* stationid swimloc depth frozen
>  sampletype entero1600cfu* enteroELTmpn* enteroQPCRcce enteroQPCRcce_nd entero
> QPCRcce_qc fpc1601mpn* fpc1602mpn* fmc1601mpn* fmc1602mpn*

. 
. notes drop *
  (5 notes dropped)

. notes drop _dta *
  (4 notes dropped)

. notes : 13-Beaches Individual Sample Water Quality Data, created by 8-append-w
> q-data.do

. notes : Values below the detection limit for all indictors are set to 0

. notes : Values are missing if a sample was not tested for a particular indicat
> or

. notes : All non-detect values are set to 0 and flagged with _nd indicators

. notes : sampleid numbers are separate by type of indicator in the NEEAR studie
> s and that is why there are multiple sampleid variables in this dataset

. notes coltime: Mission Bay has different sample collection times than other be
> aches

. notes sampletype: Only relevant for Mission Bay Samples

. notes frozen: Only recorded for NEEAR coliphage samples

. notes entero1600cfu: At Mission Bay, only analyzed in daily composite samples

. notes enteroQPCRcce: At Mission Bay, only analyzed in 2 samples per day

. notes enteroQPCRcce_qc: Only recorded for NEEAR Entero qPCR samples.  For NEEA
> R Entero qPCR samples that failed QC criteron, the value was imputed based on 
> the average of the other two samples at the same depth and time

. 
. 
. compress
  variable coltime was float now int
  variable depth was float now byte
  (37,975 bytes saved)

. label data "13 beaches water quality data, created by 8-append-wq-data.do"

. saveold "~/dropbox/13beaches/data/final/13beaches-wq-samples.dta", replace ver
> sion(12)
(saving in Stata 12 format, which can be read by Stata 11 or 12)
file ~/dropbox/13beaches/data/final/13beaches-wq-samples.dta saved

. outsheet using "~/dropbox/13beaches/data/final/13beaches-wq-samples.csv", comm
> a replace

. 
. desc

Contains data from ~/dropbox/13beaches/data/final/13beaches-wq-samples.dta
  obs:         7,595                          13 beaches water quality data,
                                                created by 8-append-wq-data.do
 vars:            28                          17 Dec 2015 13:58
 size:     1,101,275                          (_dta has notes)
--------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
--------------------------------------------------------------------------------
beach           str15   %15s                  Beach
beachcode       str13   %13s                  Water quality sampling location
                                                beach code
coldate         int     %d                    Sample Collection Date
coltime         int     %9.0g               * Sample Collection Time
sampleid_n~1600 str10   %10s                  Water Sample ID, NEEAR Entero 1600
                                                data
sampleid_neea~r str9    %9s                   Water Sample ID
sampleid_neea~e str9    %9s                   Water Sample ID, NEEAR Coliphage
                                                Data
sampleid        str8    %9s                   SampleID
stationid       str6    %9s                   Water sample station/location ID
swimloc         byte    %8.0g                 Swim area location
depth           byte    %11.0g     depth      Sample depth
frozen          byte    %8.0g               * Sample frozen (coliphage assays
                                                only)
sampletype      str22   %22s                * Water sample type
entero1600cfu   double  %8.0g               * Enterococcus 1600 CFU/100ml
entero1600cfu~d byte    %15.0g     ND         Enterococcus 1600 CFU/100ml, below
                                                detection
enteroELTmpn    long    %12.0g                Enterococcus, Enterolert MPN/100ml
enteroELTmpn_nd byte    %15.0g     ND         Enterococcus, Enterolert below
                                                detection
enteroQPCRcce   float   %9.0g               * Entero 1611 qPCR ddct CCE/100ml
enteroQPCRcce~d byte    %15.0g     dl         Below detection limit
enteroQPCRcce~c str3    %9s                 * Passes Salmon QC criterion
fpc1601mpn      double  %10.0g                F-plus Coliphage EPA 1601
fpc1601mpn_nd   byte    %15.0g     ND         F-plus Coliphage EPA 1601, below
                                                detection
fpc1602mpn      float   %9.0g                 F+ Coliphage EPA 1602 MPN/100ml
fpc1602mpn_nd   byte    %15.0g     ND         F+ Coliphage EPA 1602 MPN/100ml,
                                                below detection
fmc1601mpn      float   %9.0g                 F- Coliphage EPA 1601 MPN/100ml
fmc1601mpn_nd   byte    %15.0g     ND         F- Coliphage EPA 1601 MPN/100ml,
                                                below detection
fmc1602mpn      float   %9.0g                 F- Coliphage EPA 1602 MPN/100ml
fmc1602mpn_nd   byte    %15.0g     ND         F- Coliphage EPA 1602 MPN/100ml,
                                                below detection
                                            * indicated variables have notes
--------------------------------------------------------------------------------
Sorted by: 

. 
. * write a codebook to separate file
. log close
      name:  <unnamed>
       log:  /Users/benarnold/dropbox/13beaches/src/dm/8-append-wq-data.log
  log type:  text
 closed on:  17 Dec 2015, 13:58:33
--------------------------------------------------------------------------------
